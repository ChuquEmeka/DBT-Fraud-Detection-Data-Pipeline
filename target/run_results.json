{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-10-25T12:13:29.573571Z", "invocation_id": "cbd8810c-50e2-40b1-8e17-231b8ea9b4fa", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:20.452440Z", "completed_at": "2024-10-25T12:13:20.466522Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:20.467474Z", "completed_at": "2024-10-25T12:13:21.887215Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.60056471824646, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fd-0000-98f10005a7fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical", "compiled": true, "compiled_code": "\n\nWITH raw_data AS (\n    SELECT\n        TransactionID::string AS TransactionID,\n        UserID::string AS UserID,\n        TransactionDate::timestamp AS TransactionDate,\n        TransactionAmount::float AS TransactionAmount,\n        TransactionType::string AS TransactionType,\n        MerchantID::string AS MerchantID,\n        Currency::string AS Currency,\n        TransactionStatus::string AS TransactionStatus,\n        DeviceType::string AS DeviceType,\n        IP_Address::string AS IP_Address,\n        PaymentMethod::string AS PaymentMethod,\n        LocationCoordinates::string AS LocationCoordinates,\n        CAST(SuspiciousFlag AS int) AS SuspiciousFlag,  -- Convert boolean to int\n        CAST(IsFraud AS int) AS IsFraud,\n        ReviewStatus::string AS ReviewStatus,\n        AnomalyScore::float AS AnomalyScore,\n        TransactionTime::string AS TransactionTime,\n        Age::int AS Age,\n        Gender::string AS Gender,\n        AccountCreationDate::timestamp AS AccountCreationDate,\n        Location::string AS Location,\n        AccountStatus::string AS AccountStatus,\n        DeviceID::string AS DeviceID,\n        UserProfileCompleteness::float AS UserProfileCompleteness,\n        PreviousFraudAttempts::int AS PreviousFraudAttempts\n    FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.transactions_staging\n    \n)\n\n-- Deduplicate by TransactionID\nSELECT DISTINCT * FROM raw_data", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.br_fraud_detection_raw_data_historical"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:22.064031Z", "completed_at": "2024-10-25T12:13:22.078465Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:22.080473Z", "completed_at": "2024-10-25T12:13:23.469448Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5287563800811768, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fd-0000-98f10005a806"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.si_devices_dimension", "compiled": true, "compiled_code": "\n\nWITH devices_dimension AS (\n    SELECT\n        DeviceID,\n        FIRST_VALUE(DeviceType) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS DeviceType,\n        FIRST_VALUE(IP_Address) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS IP_Address\n    FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.br_fraud_detection_raw_data_historical\n    \n)\n\nSELECT DISTINCT * FROM devices_dimension", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.si_devices_dimension"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:22.072128Z", "completed_at": "2024-10-25T12:13:22.086636Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:22.088744Z", "completed_at": "2024-10-25T12:13:23.860170Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.931638240814209, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fc-0000-98f10005b13e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.si_transactions_fact", "compiled": true, "compiled_code": "\n\nWITH transactions_fact AS (\n    SELECT *\n    FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.br_fraud_detection_raw_data_historical\n    \n)\n\nSELECT DISTINCT\n    TransactionID,\n    UserID,\n    TransactionDate,\n    TransactionAmount,\n    TransactionType,\n    MerchantID,\n    Currency,\n    TransactionStatus,\n    DeviceType,\n    IP_Address,\n    PaymentMethod,\n    SuspiciousFlag,\n    IsFraud,\n    AnomalyScore,\n    Age,\n    Gender,\n    AccountCreationDate,\n    Location,\n    LocationCoordinates,\n    AccountStatus,\n    DeviceID,\n    UserProfileCompleteness,\n    PreviousFraudAttempts\nFROM transactions_fact", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.si_transactions_fact"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:23.597790Z", "completed_at": "2024-10-25T12:13:23.603825Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:23.604796Z", "completed_at": "2024-10-25T12:13:24.762292Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3160223960876465, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fd-0000-98f10005a80e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.si_users_dimension", "compiled": true, "compiled_code": "\n\nWITH users_dimension AS (\n    SELECT\n        UserID,\n        FIRST_VALUE(Age) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Age,\n        FIRST_VALUE(Gender) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Gender,\n        FIRST_VALUE(AccountCreationDate) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountCreationDate,\n        FIRST_VALUE(AccountStatus) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountStatus,\n        FIRST_VALUE(UserProfileCompleteness) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserProfileCompleteness,\n        FIRST_VALUE(PreviousFraudAttempts) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS PreviousFraudAttempts,\n        FIRST_VALUE(Location) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserLocation\n    FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.br_fraud_detection_raw_data_historical\n    \n)\n\nSELECT DISTINCT * FROM users_dimension", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.si_users_dimension"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:24.014750Z", "completed_at": "2024-10-25T12:13:24.018881Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:24.019775Z", "completed_at": "2024-10-25T12:13:25.199803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3434979915618896, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fc-0000-98f10005b142"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics", "compiled": true, "compiled_code": "\n\nWITH fraud_detection_dashboard_metrics AS (\n    SELECT\n        COUNT(TransactionID) AS total_transactions,\n        SUM(CASE WHEN IsFraud = 1 THEN 1 ELSE 0 END) AS total_fraud_transactions,\n        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,\n        COUNT(DISTINCT UserID) AS unique_users,\n        COUNT(DISTINCT MerchantID) AS unique_merchants,\n        AVG(AnomalyScore) AS avg_anomaly_score,\n        MAX(TransactionDate) AS last_transaction_date\n    FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.si_transactions_fact  -- Correct reference to your transactions fact table\n)\n\nSELECT DISTINCT * FROM fraud_detection_dashboard_metrics", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_fraud_detection_dashboard_metrics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:24.919805Z", "completed_at": "2024-10-25T12:13:24.924813Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:24.925805Z", "completed_at": "2024-10-25T12:13:26.141580Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3475735187530518, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fd-0000-98f10005a816"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.go_merchant_risk_assessment", "compiled": true, "compiled_code": "\n\nWITH merchant_risk_assessment AS (\n    SELECT\n        MerchantID,\n        COUNT(TransactionID) AS total_transactions,\n        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,\n        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,\n        AVG(AnomalyScore) AS avg_anomaly_score,\n        COUNT(DISTINCT UserID) AS unique_users\n    FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.si_transactions_fact\n    GROUP BY MerchantID\n)\n\nSELECT DISTINCT * FROM merchant_risk_assessment", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_merchant_risk_assessment"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:25.362259Z", "completed_at": "2024-10-25T12:13:25.367164Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:25.368160Z", "completed_at": "2024-10-25T12:13:26.608091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.385239839553833, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fd-0000-98f10005a81a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.go_real_time_fraud_detection", "compiled": true, "compiled_code": "\n\nWITH real_time_fraud_detection AS (\n    SELECT\n        TransactionID,\n        TransactionDate,\n        TransactionAmount,\n        TransactionType,\n        UserID,\n        MerchantID,\n        DeviceID,\n        IP_Address,\n        AnomalyScore,\n        IsFraud,\n        CASE\n            WHEN AnomalyScore > 0.8 THEN 'High Risk'\n            WHEN AnomalyScore > 0.5 THEN 'Moderate Risk'\n            ELSE 'Low Risk'\n        END AS fraud_risk_level\n    FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.si_transactions_fact\n    WHERE AnomalyScore > 0.5 OR IsFraud = 1\n)\n\nSELECT DISTINCT * FROM real_time_fraud_detection", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_real_time_fraud_detection"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:26.276373Z", "completed_at": "2024-10-25T12:13:26.280376Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:26.281372Z", "completed_at": "2024-10-25T12:13:27.697787Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5408570766448975, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fb-0000-98f10005989e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.go_user_behavior_metrics", "compiled": true, "compiled_code": "\n\nWITH user_behavior_metrics AS (\n    SELECT\n        UserID,\n        COUNT(TransactionID) AS total_transactions,\n        AVG(TransactionAmount) AS avg_transaction_amount,\n        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,\n        COUNT(DISTINCT DeviceID) AS unique_devices,\n        MAX(TransactionDate) AS last_transaction_date,\n        MIN(TransactionDate) AS first_transaction_date\n    FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.si_transactions_fact\n    GROUP BY UserID\n)\n\nSELECT DISTINCT * FROM user_behavior_metrics", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_user_behavior_metrics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-25T12:13:27.822016Z", "completed_at": "2024-10-25T12:13:27.827029Z"}, {"name": "execute", "started_at": "2024-10-25T12:13:27.828030Z", "completed_at": "2024-10-25T12:13:29.446336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7419705390930176, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b7ecfd-0001-b2fb-0000-98f1000598a2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.my_fraud_detection_project.go_predictive_model_features", "compiled": true, "compiled_code": "\n\nWITH transactions_fact AS (\n    SELECT * FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.si_transactions_fact\n),\nuser_behavior_metrics AS (\n    SELECT * FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_user_behavior_metrics\n),\nmerchant_risk_assessment AS (\n    SELECT * FROM DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_merchant_risk_assessment\n)\n\nSELECT\n    tf.TransactionID,\n    tf.TransactionAmount,\n    tf.TransactionType,\n    tf.AnomalyScore,\n    ubm.total_transactions AS user_total_transactions,\n    ubm.avg_transaction_amount AS user_avg_transaction_amount,\n    ubm.total_fraud_transactions AS user_fraud_transactions,\n    mra.total_fraud_transactions AS merchant_fraud_transactions,\n    mra.avg_anomaly_score AS merchant_avg_anomaly_score,\n    tf.IsFraud\nFROM transactions_fact tf\nJOIN user_behavior_metrics ubm ON tf.UserID = ubm.UserID\nJOIN merchant_risk_assessment mra ON tf.MerchantID = mra.MerchantID\n", "relation_name": "DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_predictive_model_features"}], "elapsed_time": 11.083921194076538, "args": {"macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "vars": {}, "favor_state": false, "empty": false, "partial_parse": true, "require_resource_names_without_spaces": false, "which": "run", "indirect_selection": "eager", "source_freshness_run_project_hooks": false, "exclude": [], "use_colors_file": true, "strict_mode": false, "log_format": "default", "log_level": "info", "populate_cache": true, "invocation_command": "dbt run", "log_path": "C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs", "introspect": true, "quiet": false, "write_json": true, "static_parser": true, "printer_width": 80, "profiles_dir": "C:\\Users\\User\\.dbt", "cache_selected_only": false, "show_resource_report": false, "enable_legacy_logger": false, "select": [], "log_level_file": "debug", "log_format_file": "debug", "print": true, "use_colors": true, "version_check": true, "partial_parse_file_diff": true, "project_dir": "C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline", "send_anonymous_usage_stats": true, "defer": false, "require_explicit_package_overrides_for_builtin_materializations": true}}