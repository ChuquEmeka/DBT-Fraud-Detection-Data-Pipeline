-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS","UNIQUE_MERCHANTS" = DBT_INTERNAL_SOURCE."UNIQUE_MERCHANTS","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE"
    

    when not matched then insert
        ("TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "UNIQUE_USERS", "UNIQUE_MERCHANTS", "AVG_ANOMALY_SCORE", "LAST_TRANSACTION_DATE")
    values
        ("TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "UNIQUE_USERS", "UNIQUE_MERCHANTS", "AVG_ANOMALY_SCORE", "LAST_TRANSACTION_DATE")

;
    commit;