-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","USER_TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_TOTAL_TRANSACTIONS","USER_AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."USER_AVG_TRANSACTION_AMOUNT","USER_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_FRAUD_TRANSACTIONS","MERCHANT_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."MERCHANT_FRAUD_TRANSACTIONS","MERCHANT_AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."MERCHANT_AVG_ANOMALY_SCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")
    values
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")

;
    commit;