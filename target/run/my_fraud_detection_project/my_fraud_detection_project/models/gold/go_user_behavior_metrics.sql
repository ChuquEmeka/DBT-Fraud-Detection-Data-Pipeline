-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_user_behavior_metrics as DBT_INTERNAL_DEST
        using DEV_EMEKA_FRAUD_DETECTION.PUBLIC.go_user_behavior_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."AVG_TRANSACTION_AMOUNT","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","UNIQUE_DEVICES" = DBT_INTERNAL_SOURCE."UNIQUE_DEVICES","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE","FIRST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."FIRST_TRANSACTION_DATE"
    

    when not matched then insert
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")
    values
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")

;
    commit;