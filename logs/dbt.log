[0m16:02:06.568105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC1F4C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC48DA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC48DA0B0>]}


============================== 16:02:06.568105 | 6f6b1fc8-e2da-43cc-bea9-7f91ade80dbb ==============================
[0m16:02:06.568105 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:02:06.568105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init my_fraud_detection_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:06.607757 [debug] [MainThread]: Starter project path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\lib\site-packages\dbt\include\starter_project
[0m16:02:06.687936 [info ] [MainThread]: 
Your new dbt project "my_fraud_detection_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m16:02:06.690272 [info ] [MainThread]: Setting up your profile.
[0m16:12:11.992217 [info ] [MainThread]: Profile my_fraud_detection_project written to C:\Users\User\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m16:12:11.992217 [debug] [MainThread]: Command `dbt init` succeeded at 16:12:11.992217 after 605.53 seconds
[0m16:12:12.002202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC1F4C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC48DA590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAC48DA230>]}
[0m16:12:12.003634 [debug] [MainThread]: Flushing usage events
[0m16:12:36.344948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89C40C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89EDD5F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89EDD6110>]}


============================== 16:12:36.346052 | 47a8ec5a-2b2b-4d4b-a694-554fc064d58b ==============================
[0m16:12:36.346052 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:12:36.346052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:12:36.373600 [info ] [MainThread]: dbt version: 1.8.8
[0m16:12:36.373600 [info ] [MainThread]: python version: 3.10.7
[0m16:12:36.373600 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:12:36.373600 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:12:36.388112 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:12:36.390109 [debug] [MainThread]: Command `dbt debug` failed at 16:12:36.390109 after 0.14 seconds
[0m16:12:36.391468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89C40C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89EC59F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89EC5AD10>]}
[0m16:12:36.392634 [debug] [MainThread]: Flushing usage events
[0m16:19:30.374033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A1CEC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A46B5F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A46B6110>]}


============================== 16:19:30.377922 | 4ce6f7eb-5462-40da-95d6-fa0c7fcc70cc ==============================
[0m16:19:30.377922 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:19:30.380023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:19:30.408458 [info ] [MainThread]: dbt version: 1.8.8
[0m16:19:30.409501 [info ] [MainThread]: python version: 3.10.7
[0m16:19:30.410458 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:19:30.411469 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:19:30.418458 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:19:30.421465 [debug] [MainThread]: Command `dbt debug` failed at 16:19:30.420463 after 0.13 seconds
[0m16:19:30.422464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A1CEC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A449F730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1A44C7FA0>]}
[0m16:19:30.422464 [debug] [MainThread]: Flushing usage events
[0m16:20:29.320024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B09FF4C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2909D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A2909F00>]}


============================== 16:20:29.324436 | 12c6e86b-60d3-4d70-bcf3-e858ebaa924f ==============================
[0m16:20:29.324436 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:20:29.325435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:20:29.351282 [info ] [MainThread]: dbt version: 1.8.8
[0m16:20:29.352438 [info ] [MainThread]: python version: 3.10.7
[0m16:20:29.353464 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:20:29.354471 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:20:29.362218 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:20:29.364217 [debug] [MainThread]: Command `dbt debug` failed at 16:20:29.364217 after 0.12 seconds
[0m16:20:29.364217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B09FF4C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A291E3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A291EA70>]}
[0m16:20:29.365217 [debug] [MainThread]: Flushing usage events
[0m16:21:24.759532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021105C6C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021108635F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211086360E0>]}


============================== 16:21:24.763624 | b81d6917-43c2-407a-bd0e-a35ddd093f30 ==============================
[0m16:21:24.763624 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:21:24.764974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:21:24.787553 [info ] [MainThread]: dbt version: 1.8.8
[0m16:21:24.789576 [info ] [MainThread]: python version: 3.10.7
[0m16:21:24.790179 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:21:24.791190 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:21:24.800665 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:21:24.802665 [debug] [MainThread]: Command `dbt debug` failed at 16:21:24.802665 after 0.11 seconds
[0m16:21:24.802665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021105C6C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110863A3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002110863AA70>]}
[0m16:21:24.803749 [debug] [MainThread]: Flushing usage events
[0m16:21:48.974674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5B88C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5E255F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5E2560E0>]}


============================== 16:21:48.978580 | 106e9fd9-30be-4e98-80be-178c0ee55d4b ==============================
[0m16:21:48.978580 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:21:48.979986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:21:49.005638 [info ] [MainThread]: dbt version: 1.8.8
[0m16:21:49.006637 [info ] [MainThread]: python version: 3.10.7
[0m16:21:49.007637 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:21:49.008638 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:21:49.016641 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:21:49.018577 [debug] [MainThread]: Command `dbt debug` failed at 16:21:49.018577 after 0.13 seconds
[0m16:21:49.019568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5B88C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5B5A19C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E5B5A1150>]}
[0m16:21:49.020569 [debug] [MainThread]: Flushing usage events
[0m16:26:00.038484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124DC06C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124DEA35F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124DEA36110>]}


============================== 16:26:00.042535 | d30a58db-2003-4933-8d89-d8e97967385c ==============================
[0m16:26:00.042535 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:26:00.043460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:26:00.064450 [info ] [MainThread]: dbt version: 1.8.8
[0m16:26:00.066459 [info ] [MainThread]: python version: 3.10.7
[0m16:26:00.067449 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:26:00.068450 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:26:00.076482 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:26:00.078458 [debug] [MainThread]: Command `dbt debug` failed at 16:26:00.078458 after 0.14 seconds
[0m16:26:00.079469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124DC06C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124DBD81990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124DBD81120>]}
[0m16:26:00.080811 [debug] [MainThread]: Flushing usage events
[0m16:26:51.897386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA338C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA5D55F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA5D560E0>]}


============================== 16:26:51.901403 | 3485b097-3436-4ff2-839c-665ca2c31da2 ==============================
[0m16:26:51.901403 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:26:51.902403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:26:51.929029 [info ] [MainThread]: dbt version: 1.8.8
[0m16:26:51.930012 [info ] [MainThread]: python version: 3.10.7
[0m16:26:51.931013 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:26:51.931713 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:26:51.939720 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:26:51.941719 [debug] [MainThread]: Command `dbt debug` failed at 16:26:51.941719 after 0.12 seconds
[0m16:26:51.941719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA338C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA5D5A5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA30A1030>]}
[0m16:26:51.942720 [debug] [MainThread]: Flushing usage events
[0m16:28:14.242441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025363E6C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002536682DDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002536682DF90>]}


============================== 16:28:14.258073 | fc345fef-fba6-41e1-b3a5-5804844229d9 ==============================
[0m16:28:14.258073 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:28:14.258073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:28:14.280762 [info ] [MainThread]: dbt version: 1.8.8
[0m16:28:14.280762 [info ] [MainThread]: python version: 3.10.7
[0m16:28:14.284534 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:28:14.285547 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:28:14.732763 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m16:28:14.732763 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m16:28:14.732763 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt_project.yml
[0m16:28:14.732763 [info ] [MainThread]: adapter type: snowflake
[0m16:28:14.732763 [info ] [MainThread]: adapter version: 1.8.4
[0m16:28:14.732763 [info ] [MainThread]: Configuration:
[0m16:28:14.732763 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:28:14.743304 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m16:28:14.744316 [info ] [MainThread]: Required dependencies:
[0m16:28:14.746322 [debug] [MainThread]: Executing "git --help"
[0m16:28:14.760663 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:28:14.773794 [debug] [MainThread]: STDERR: "b''"
[0m16:28:14.774803 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:28:14.777006 [info ] [MainThread]: Connection:
[0m16:28:14.777993 [info ] [MainThread]:   account: bc81969.eu-north-1.aws
[0m16:28:14.778991 [info ] [MainThread]:   user: ChuquEmeka
[0m16:28:14.779989 [info ] [MainThread]:   database: EMEKA_FRAUD_DETECTION_DATABASE
[0m16:28:14.780991 [info ] [MainThread]:   warehouse: MY_DBT_WAREHOUSE
[0m16:28:14.780991 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:28:14.796019 [info ] [MainThread]:   schema: PUBLIC
[0m16:28:14.811355 [info ] [MainThread]:   authenticator: None
[0m16:28:14.812376 [info ] [MainThread]:   oauth_client_id: None
[0m16:28:14.813385 [info ] [MainThread]:   query_tag: None
[0m16:28:14.814400 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:28:14.815415 [info ] [MainThread]:   host: None
[0m16:28:14.816419 [info ] [MainThread]:   port: None
[0m16:28:14.817930 [info ] [MainThread]:   proxy_host: None
[0m16:28:14.819944 [info ] [MainThread]:   proxy_port: None
[0m16:28:14.821946 [info ] [MainThread]:   protocol: None
[0m16:28:14.823939 [info ] [MainThread]:   connect_retries: 1
[0m16:28:14.824940 [info ] [MainThread]:   connect_timeout: None
[0m16:28:14.826264 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:28:14.827278 [info ] [MainThread]:   retry_all: False
[0m16:28:14.828275 [info ] [MainThread]:   insecure_mode: False
[0m16:28:14.828275 [info ] [MainThread]:   reuse_connections: None
[0m16:28:14.830273 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:28:14.834278 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:28:14.835598 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:28:14.835598 [debug] [MainThread]: On debug: select 1 as id
[0m16:28:14.835598 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:16.259711 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.421 seconds
[0m16:28:16.262250 [debug] [MainThread]: On debug: Close
[0m16:28:16.399091 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:28:16.400157 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:28:16.401160 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt_project.yml> not found

[0m16:28:16.403151 [debug] [MainThread]: Command `dbt debug` failed at 16:28:16.403151 after 2.25 seconds
[0m16:28:16.405059 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:28:16.406062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025363E6C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253671E7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002536661ECB0>]}
[0m16:28:16.407070 [debug] [MainThread]: Flushing usage events
[0m16:33:20.302967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021847C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021AE3E260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021AE3E080>]}


============================== 16:33:20.307986 | 267ef952-a3dc-4603-840c-b2cf1219c544 ==============================
[0m16:33:20.307986 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:33:20.308979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:33:20.330566 [info ] [MainThread]: dbt version: 1.8.8
[0m16:33:20.331585 [info ] [MainThread]: python version: 3.10.7
[0m16:33:20.333109 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:33:20.334163 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:33:20.670546 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m16:33:20.670546 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m16:33:20.670546 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt_project.yml
[0m16:33:20.670546 [info ] [MainThread]: adapter type: snowflake
[0m16:33:20.670546 [info ] [MainThread]: adapter version: 1.8.4
[0m16:33:20.759769 [info ] [MainThread]: Configuration:
[0m16:33:20.760424 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:33:20.761453 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:33:20.762501 [info ] [MainThread]: Required dependencies:
[0m16:33:20.763510 [debug] [MainThread]: Executing "git --help"
[0m16:33:20.775887 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:33:20.775887 [debug] [MainThread]: STDERR: "b''"
[0m16:33:20.775887 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:33:20.775887 [info ] [MainThread]: Connection:
[0m16:33:20.789795 [info ] [MainThread]:   account: bc81969.eu-north-1.aws
[0m16:33:20.790899 [info ] [MainThread]:   user: ChuquEmeka
[0m16:33:20.791817 [info ] [MainThread]:   database: EMEKA_FRAUD_DETECTION_DATABASE
[0m16:33:20.793806 [info ] [MainThread]:   warehouse: MY_DBT_WAREHOUSE
[0m16:33:20.794904 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:33:20.796839 [info ] [MainThread]:   schema: PUBLIC
[0m16:33:20.797533 [info ] [MainThread]:   authenticator: None
[0m16:33:20.798405 [info ] [MainThread]:   oauth_client_id: None
[0m16:33:20.799413 [info ] [MainThread]:   query_tag: None
[0m16:33:20.800820 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:33:20.801725 [info ] [MainThread]:   host: None
[0m16:33:20.802727 [info ] [MainThread]:   port: None
[0m16:33:20.802727 [info ] [MainThread]:   proxy_host: None
[0m16:33:20.803755 [info ] [MainThread]:   proxy_port: None
[0m16:33:20.804727 [info ] [MainThread]:   protocol: None
[0m16:33:20.805642 [info ] [MainThread]:   connect_retries: 1
[0m16:33:20.805642 [info ] [MainThread]:   connect_timeout: None
[0m16:33:20.805642 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:33:20.805642 [info ] [MainThread]:   retry_all: False
[0m16:33:20.805642 [info ] [MainThread]:   insecure_mode: False
[0m16:33:20.805642 [info ] [MainThread]:   reuse_connections: None
[0m16:33:20.805642 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:33:20.805642 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:33:20.805642 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:33:20.812487 [debug] [MainThread]: On debug: select 1 as id
[0m16:33:20.813501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:21.734672 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.922 seconds
[0m16:33:21.734672 [debug] [MainThread]: On debug: Close
[0m16:33:21.867277 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:33:21.882933 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:33:21.882933 [debug] [MainThread]: Command `dbt debug` succeeded at 16:33:21.882933 after 1.66 seconds
[0m16:33:21.882933 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:33:21.882933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021847C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020218CF34F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021B44BB20>]}
[0m16:33:21.882933 [debug] [MainThread]: Flushing usage events
[0m16:34:13.619675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E90252C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E904EC2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E904EC2050>]}


============================== 16:34:13.636140 | 3752c8f2-1dee-4e95-b6fb-af19a153ca81 ==============================
[0m16:34:13.636140 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:34:13.636140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:34:13.658339 [info ] [MainThread]: dbt version: 1.8.8
[0m16:34:13.658339 [info ] [MainThread]: python version: 3.10.7
[0m16:34:13.665251 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:34:13.666135 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:34:13.677091 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:34:13.679317 [debug] [MainThread]: Command `dbt debug` failed at 16:34:13.679317 after 0.14 seconds
[0m16:34:13.679317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E90252C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E904ECE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E904ECE7A0>]}
[0m16:34:13.680329 [debug] [MainThread]: Flushing usage events
[0m16:34:53.608879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002396EE3C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239717FA230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239717FA050>]}


============================== 16:34:53.623912 | b5f31c15-3230-4276-aeb8-02d2ef459baa ==============================
[0m16:34:53.623912 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:34:53.623912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:34:53.656480 [info ] [MainThread]: dbt version: 1.8.8
[0m16:34:53.656480 [info ] [MainThread]: python version: 3.10.7
[0m16:34:53.656480 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:34:53.656480 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:34:54.039893 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m16:34:54.039893 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m16:34:54.039893 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt_project.yml
[0m16:34:54.039893 [info ] [MainThread]: adapter type: snowflake
[0m16:34:54.039893 [info ] [MainThread]: adapter version: 1.8.4
[0m16:34:54.133269 [info ] [MainThread]: Configuration:
[0m16:34:54.134810 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:34:54.136084 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:34:54.137090 [info ] [MainThread]: Required dependencies:
[0m16:34:54.138090 [debug] [MainThread]: Executing "git --help"
[0m16:34:54.157718 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:34:54.157718 [debug] [MainThread]: STDERR: "b''"
[0m16:34:54.157718 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:34:54.157718 [info ] [MainThread]: Connection:
[0m16:34:54.157718 [info ] [MainThread]:   account: bc81969.eu-north-1.aws
[0m16:34:54.157718 [info ] [MainThread]:   user: ChuquEmeka
[0m16:34:54.157718 [info ] [MainThread]:   database: EMEKA_FRAUD_DETECTION_DATABASE
[0m16:34:54.157718 [info ] [MainThread]:   warehouse: MY_DBT_WAREHOUSE
[0m16:34:54.157718 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:34:54.169756 [info ] [MainThread]:   schema: PUBLIC
[0m16:34:54.171815 [info ] [MainThread]:   authenticator: None
[0m16:34:54.172479 [info ] [MainThread]:   oauth_client_id: None
[0m16:34:54.174163 [info ] [MainThread]:   query_tag: None
[0m16:34:54.175625 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:34:54.176650 [info ] [MainThread]:   host: None
[0m16:34:54.176650 [info ] [MainThread]:   port: None
[0m16:34:54.177707 [info ] [MainThread]:   proxy_host: None
[0m16:34:54.178634 [info ] [MainThread]:   proxy_port: None
[0m16:34:54.180037 [info ] [MainThread]:   protocol: None
[0m16:34:54.180037 [info ] [MainThread]:   connect_retries: 1
[0m16:34:54.180037 [info ] [MainThread]:   connect_timeout: None
[0m16:34:54.180037 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:34:54.180037 [info ] [MainThread]:   retry_all: False
[0m16:34:54.180037 [info ] [MainThread]:   insecure_mode: False
[0m16:34:54.180037 [info ] [MainThread]:   reuse_connections: None
[0m16:34:54.180037 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:34:54.186495 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:34:54.187506 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:34:54.188506 [debug] [MainThread]: On debug: select 1 as id
[0m16:34:54.188506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:55.053322 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.870 seconds
[0m16:34:55.053322 [debug] [MainThread]: On debug: Close
[0m16:34:55.181494 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:34:55.183737 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:34:55.186814 [debug] [MainThread]: Command `dbt debug` succeeded at 16:34:55.186814 after 1.64 seconds
[0m16:34:55.187814 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:34:55.188743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002396EE3C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002396F607010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239724DEBF0>]}
[0m16:34:55.189696 [debug] [MainThread]: Flushing usage events
[0m16:37:02.869759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002279F46C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227A1E2A230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227A1E2A050>]}


============================== 16:37:02.883285 | 5ef29bd9-1773-4a85-9265-7145a596c311 ==============================
[0m16:37:02.883285 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:37:02.885796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:02.907309 [info ] [MainThread]: dbt version: 1.8.8
[0m16:37:02.908311 [info ] [MainThread]: python version: 3.10.7
[0m16:37:02.909312 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:37:02.909312 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:37:02.918479 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:37:02.920035 [debug] [MainThread]: Command `dbt debug` failed at 16:37:02.920035 after 0.11 seconds
[0m16:37:02.921952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002279F46C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227A1E3A6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227A1E3A230>]}
[0m16:37:02.921952 [debug] [MainThread]: Flushing usage events
[0m16:38:05.978417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DE04C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E0A0E2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E0A0E0E0>]}


============================== 16:38:05.978417 | 759e5114-242c-4b66-ad0e-a4a2a91e3eff ==============================
[0m16:38:05.978417 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:38:05.978417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:38:05.999537 [info ] [MainThread]: dbt version: 1.8.8
[0m16:38:05.999537 [info ] [MainThread]: python version: 3.10.7
[0m16:38:06.011029 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:38:06.012047 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:38:06.020303 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'SNOWFLAKE_USER'
[0m16:38:06.022885 [debug] [MainThread]: Command `dbt debug` failed at 16:38:06.022885 after 0.11 seconds
[0m16:38:06.022885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DE04C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E0A1A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9E0A1A4D0>]}
[0m16:38:06.022885 [debug] [MainThread]: Flushing usage events
[0m16:40:13.207022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CD754C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CD9F0E2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CD9F0E0E0>]}


============================== 16:40:13.207022 | 7821169f-ca13-4c6c-9cbc-f80a9c0d6570 ==============================
[0m16:40:13.207022 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:40:13.223348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:40:13.250431 [info ] [MainThread]: dbt version: 1.8.8
[0m16:40:13.251554 [info ] [MainThread]: python version: 3.10.7
[0m16:40:13.251554 [info ] [MainThread]: python path: C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\Scripts\python.exe
[0m16:40:13.251554 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m16:40:13.624244 [info ] [MainThread]: Using profiles dir at C:\Users\User\.dbt
[0m16:40:13.639257 [info ] [MainThread]: Using profiles.yml file at C:\Users\User\.dbt\profiles.yml
[0m16:40:13.639257 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt_project.yml
[0m16:40:13.639257 [info ] [MainThread]: adapter type: snowflake
[0m16:40:13.639257 [info ] [MainThread]: adapter version: 1.8.4
[0m16:40:13.727594 [info ] [MainThread]: Configuration:
[0m16:40:13.729040 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:40:13.730300 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:40:13.731311 [info ] [MainThread]: Required dependencies:
[0m16:40:13.732043 [debug] [MainThread]: Executing "git --help"
[0m16:40:13.747858 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:40:13.747858 [debug] [MainThread]: STDERR: "b''"
[0m16:40:13.747858 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:40:13.747858 [info ] [MainThread]: Connection:
[0m16:40:13.747858 [info ] [MainThread]:   account: bc81969.eu-north-1.aws
[0m16:40:13.747858 [info ] [MainThread]:   user: ChuquEmeka
[0m16:40:13.747858 [info ] [MainThread]:   database: EMEKA_FRAUD_DETECTION_DATABASE
[0m16:40:13.763630 [info ] [MainThread]:   warehouse: MY_DBT_WAREHOUSE
[0m16:40:13.764247 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m16:40:13.765513 [info ] [MainThread]:   schema: PUBLIC
[0m16:40:13.766536 [info ] [MainThread]:   authenticator: None
[0m16:40:13.768080 [info ] [MainThread]:   oauth_client_id: None
[0m16:40:13.769116 [info ] [MainThread]:   query_tag: None
[0m16:40:13.770086 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:40:13.771086 [info ] [MainThread]:   host: None
[0m16:40:13.771792 [info ] [MainThread]:   port: None
[0m16:40:13.772800 [info ] [MainThread]:   proxy_host: None
[0m16:40:13.773799 [info ] [MainThread]:   proxy_port: None
[0m16:40:13.774815 [info ] [MainThread]:   protocol: None
[0m16:40:13.775803 [info ] [MainThread]:   connect_retries: 1
[0m16:40:13.775803 [info ] [MainThread]:   connect_timeout: None
[0m16:40:13.777245 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:40:13.778278 [info ] [MainThread]:   retry_all: False
[0m16:40:13.779287 [info ] [MainThread]:   insecure_mode: False
[0m16:40:13.781291 [info ] [MainThread]:   reuse_connections: None
[0m16:40:13.782172 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:40:13.783393 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:40:13.784404 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:40:13.785409 [debug] [MainThread]: On debug: select 1 as id
[0m16:40:13.786492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:14.648708 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.862 seconds
[0m16:40:14.649729 [debug] [MainThread]: On debug: Close
[0m16:40:14.766462 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:40:14.766462 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:40:14.766462 [debug] [MainThread]: Command `dbt debug` succeeded at 16:40:14.766462 after 1.64 seconds
[0m16:40:14.781559 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:40:14.782113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CD754C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CD7D25F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CDABFC550>]}
[0m16:40:14.783452 [debug] [MainThread]: Flushing usage events
[0m17:20:31.837986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7C78C3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7F1563E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7F156200>]}


============================== 17:20:31.853700 | a8d4aa0a-fe0c-49fb-84be-71fa7f8e2c5e ==============================
[0m17:20:31.853700 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:20:31.853700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:20:32.399744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8d4aa0a-fe0c-49fb-84be-71fa7f8e2c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7FDAF9A0>]}
[0m17:20:32.439090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8d4aa0a-fe0c-49fb-84be-71fa7f8e2c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7F119180>]}
[0m17:20:32.454723 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:20:32.476945 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:20:32.477967 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:20:32.479947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8d4aa0a-fe0c-49fb-84be-71fa7f8e2c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7FE2FFD0>]}
[0m17:20:34.271689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_fraud_detection_project.example
[0m17:20:34.271689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8d4aa0a-fe0c-49fb-84be-71fa7f8e2c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7FF1A020>]}
[0m17:20:34.364347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8d4aa0a-fe0c-49fb-84be-71fa7f8e2c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE00146CE0>]}
[0m17:20:34.364347 [info ] [MainThread]: Found 454 macros
[0m17:20:34.364347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8d4aa0a-fe0c-49fb-84be-71fa7f8e2c5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE00146200>]}
[0m17:20:34.379360 [info ] [MainThread]: 
[0m17:20:34.379360 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:20:34.379360 [debug] [MainThread]: Command end result
[0m17:20:34.409489 [debug] [MainThread]: Command `dbt run` succeeded at 17:20:34.409489 after 2.64 seconds
[0m17:20:34.410496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7C78C3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE7FE83220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE00159330>]}
[0m17:20:34.411574 [debug] [MainThread]: Flushing usage events
[0m17:30:48.952173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002098702C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209899F5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209899F5E70>]}


============================== 17:30:48.956521 | fb104a92-dabd-4be2-aa75-0043512b9355 ==============================
[0m17:30:48.956521 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:30:48.958522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:30:49.482466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb104a92-dabd-4be2-aa75-0043512b9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002098A6516F0>]}
[0m17:30:49.530967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb104a92-dabd-4be2-aa75-0043512b9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002098A6771C0>]}
[0m17:30:49.532856 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:30:49.540953 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:30:49.605411 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:30:49.606429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb104a92-dabd-4be2-aa75-0043512b9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020988F79060>]}
[0m17:30:50.773238 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in my_fraud_detection_project/models\src\sources.yml @ sources: {'name': 'EMEKA_FRAUD_DETECTION_DATABASE', 'database': 'EMEKA_FRAUD_DETECTION_DATABASE', 'schema': 'PUBLIC', 'stages': [{'name': 'MY_S3_STAGE', 'description': 'raw data.'}]} - at path []: Additional properties are not allowed ('stages' was unexpected)
[0m17:30:50.776348 [debug] [MainThread]: Command `dbt run` failed at 17:30:50.776348 after 1.91 seconds
[0m17:30:50.777350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002098702C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002098A783040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002098A6B0550>]}
[0m17:30:50.778253 [debug] [MainThread]: Flushing usage events
[0m17:32:33.660633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B952C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BBEFDF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BBEFE110>]}


============================== 17:32:33.664702 | 852f16a4-474c-40d4-b761-511f368b502b ==============================
[0m17:32:33.664702 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:32:33.665724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:32:34.181628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '852f16a4-474c-40d4-b761-511f368b502b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BCB52D40>]}
[0m17:32:34.237565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '852f16a4-474c-40d4-b761-511f368b502b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BCB53E20>]}
[0m17:32:34.240523 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:32:34.248626 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:32:34.293270 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:32:34.295187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '852f16a4-474c-40d4-b761-511f368b502b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BB475060>]}
[0m17:32:35.394386 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical' (my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql) depends on a source named 'fraud_detection.raw_data' which was not found
[0m17:32:35.396397 [debug] [MainThread]: Command `dbt run` failed at 17:32:35.396397 after 1.81 seconds
[0m17:32:35.396397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B952C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BDEF4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BDF24D90>]}
[0m17:32:35.398295 [debug] [MainThread]: Flushing usage events
[0m17:35:05.915708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC0EDDC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC117ADF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC117AE110>]}


============================== 17:35:05.919430 | 75f0af77-f37a-431c-a14c-0cd7dea739ab ==============================
[0m17:35:05.919430 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:35:05.921339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:06.412043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75f0af77-f37a-431c-a14c-0cd7dea739ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC124016F0>]}
[0m17:35:06.459363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75f0af77-f37a-431c-a14c-0cd7dea739ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC124271C0>]}
[0m17:35:06.461277 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:35:06.471369 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:35:06.517290 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:35:06.518511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '75f0af77-f37a-431c-a14c-0cd7dea739ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC10D25060>]}
[0m17:35:07.615209 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical' (my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql) depends on a source named 'EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC' which was not found
[0m17:35:07.617860 [debug] [MainThread]: Command `dbt run` failed at 17:35:07.617860 after 1.78 seconds
[0m17:35:07.617860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC0EDDC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC0F5118A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DC138FD9F0>]}
[0m17:35:07.618869 [debug] [MainThread]: Flushing usage events
[0m17:38:34.275040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404F49C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024051E65C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024051E65E10>]}


============================== 17:38:34.277148 | 089ba2bc-8751-483d-a92a-bdd6daf1567b ==============================
[0m17:38:34.277148 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:38:34.277148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:34.749194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '089ba2bc-8751-483d-a92a-bdd6daf1567b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404F7317B0>]}
[0m17:38:34.799887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '089ba2bc-8751-483d-a92a-bdd6daf1567b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024051E250C0>]}
[0m17:38:34.801791 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:38:34.810433 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:38:34.857679 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:38:34.857679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '089ba2bc-8751-483d-a92a-bdd6daf1567b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240513E5090>]}
[0m17:38:36.033509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '089ba2bc-8751-483d-a92a-bdd6daf1567b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024052BD16C0>]}
[0m17:38:36.136748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '089ba2bc-8751-483d-a92a-bdd6daf1567b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024052DC3280>]}
[0m17:38:36.136748 [info ] [MainThread]: Found 9 models, 1 source, 454 macros
[0m17:38:36.136748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089ba2bc-8751-483d-a92a-bdd6daf1567b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024052DC1510>]}
[0m17:38:36.153918 [info ] [MainThread]: 
[0m17:38:36.153918 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:36.162134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m17:38:36.163156 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m17:38:36.163156 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m17:38:36.163156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:37.220272 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.050 seconds
[0m17:38:37.220272 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m17:38:37.362190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m17:38:37.362190 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m17:38:37.362190 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m17:38:37.377811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:38.129388 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.760 seconds
[0m17:38:38.129388 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m17:38:38.256284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '089ba2bc-8751-483d-a92a-bdd6daf1567b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404F2DB9D0>]}
[0m17:38:38.256284 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:38:38.256284 [info ] [MainThread]: 
[0m17:38:38.271975 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:38:38.271975 [info ] [Thread-1 (]: 1 of 9 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m17:38:38.271975 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m17:38:38.280958 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:38:38.291987 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:38:38.295991 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:38:38.343953 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:38:38.343953 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:38:38.343953 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
         as
        (

WITH raw_data AS (
    SELECT
        r.value:TransactionID::string AS TransactionID,
        r.value:UserID::string AS UserID,
        r.value:TransactionDate::timestamp AS TransactionDate,
        r.value:TransactionAmount::float AS TransactionAmount,
        r.value:TransactionType::string AS TransactionType,
        r.value:MerchantID::string AS MerchantID,
        r.value:Currency::string AS Currency,
        r.value:TransactionStatus::string AS TransactionStatus,
        r.value:DeviceType::string AS DeviceType,
        r.value:IP_Address::string AS IP_Address,
        r.value:PaymentMethod::string AS PaymentMethod,
        r.value:SuspiciousFlag::boolean AS SuspiciousFlag,
        r.value:IsFraud::boolean AS IsFraud,
        r.value:AnomalyScore::float AS AnomalyScore,
        r.value:Age::int AS Age,
        r.value:Gender::string AS Gender,
        r.value:AccountCreationDate::timestamp AS AccountCreationDate,
        r.value:Location::string AS Location,
        r.value:LocationCoordinates::string AS LocationCoordinates,
        r.value:AccountStatus::string AS AccountStatus,
        r.value:DeviceID::string AS DeviceID,
        r.value:UserProfileCompleteness::float AS UserProfileCompleteness,
        r.value:PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging,  -- Correct source reference
    LATERAL FLATTEN(input => $1) AS r
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data
        );
[0m17:38:38.343953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:39.104379 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7e82a-0001-b2aa-0000-98f10004c052
[0m17:38:39.104379 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [VARCHAR(16777216)] for parameter 'input'
[0m17:38:39.104379 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m17:38:39.261001 [debug] [Thread-1 (]: Database Error in model br_fraud_detection_raw_data_historical (my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql)
  001007 (22023): SQL compilation error:
  invalid type [VARCHAR(16777216)] for parameter 'input'
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql
[0m17:38:39.264926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '089ba2bc-8751-483d-a92a-bdd6daf1567b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404F838FD0>]}
[0m17:38:39.264926 [error] [Thread-1 (]: 1 of 9 ERROR creating sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[31mERROR[0m in 0.99s]
[0m17:38:39.264926 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:38:39.264926 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m17:38:39.264926 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m17:38:39.264926 [info ] [Thread-2 (]: 2 of 9 SKIP relation PUBLIC.si_devices_dimension ............................... [[33mSKIP[0m]
[0m17:38:39.264926 [info ] [Thread-1 (]: 3 of 9 SKIP relation PUBLIC.si_transactions_fact ............................... [[33mSKIP[0m]
[0m17:38:39.264926 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m17:38:39.274184 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m17:38:39.275282 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m17:38:39.276192 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:38:39.277191 [info ] [Thread-2 (]: 4 of 9 SKIP relation PUBLIC.si_users_dimension ................................. [[33mSKIP[0m]
[0m17:38:39.278193 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m17:38:39.277191 [info ] [Thread-1 (]: 5 of 9 SKIP relation PUBLIC.go_fraud_detection_dashboard_metrics ............... [[33mSKIP[0m]
[0m17:38:39.279277 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:38:39.279277 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:38:39.279277 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:38:39.279277 [info ] [Thread-2 (]: 6 of 9 SKIP relation PUBLIC.go_merchant_risk_assessment ........................ [[33mSKIP[0m]
[0m17:38:39.283396 [info ] [Thread-1 (]: 7 of 9 SKIP relation PUBLIC.go_real_time_fraud_detection ....................... [[33mSKIP[0m]
[0m17:38:39.284951 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:38:39.285978 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:38:39.288024 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:38:39.289023 [info ] [Thread-2 (]: 8 of 9 SKIP relation PUBLIC.go_user_behavior_metrics ........................... [[33mSKIP[0m]
[0m17:38:39.291030 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:38:39.293384 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:38:39.295443 [info ] [Thread-1 (]: 9 of 9 SKIP relation PUBLIC.go_predictive_model_features ....................... [[33mSKIP[0m]
[0m17:38:39.296404 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:38:39.298395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:39.299397 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m17:38:39.300405 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m17:38:39.301400 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical' was properly closed.
[0m17:38:39.302444 [info ] [MainThread]: 
[0m17:38:39.303991 [info ] [MainThread]: Finished running 9 incremental models in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m17:38:39.306004 [debug] [MainThread]: Command end result
[0m17:38:39.348940 [info ] [MainThread]: 
[0m17:38:39.350653 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:39.350653 [info ] [MainThread]: 
[0m17:38:39.350653 [error] [MainThread]:   Database Error in model br_fraud_detection_raw_data_historical (my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql)
  001007 (22023): SQL compilation error:
  invalid type [VARCHAR(16777216)] for parameter 'input'
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql
[0m17:38:39.356174 [info ] [MainThread]: 
[0m17:38:39.357181 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=8 TOTAL=9
[0m17:38:39.360272 [debug] [MainThread]: Command `dbt run` failed at 17:38:39.360272 after 5.16 seconds
[0m17:38:39.361419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002404F49C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240513D9DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024052B95330>]}
[0m17:38:39.361419 [debug] [MainThread]: Flushing usage events
[0m17:43:45.078688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7B9BC370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7E38DF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7E38E110>]}


============================== 17:43:45.078688 | 70146135-29a4-4a8c-9c99-46211cc6dbde ==============================
[0m17:43:45.078688 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:43:45.078688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:43:45.562379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70146135-29a4-4a8c-9c99-46211cc6dbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7BC517B0>]}
[0m17:43:45.609059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70146135-29a4-4a8c-9c99-46211cc6dbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7E3450C0>]}
[0m17:43:45.609059 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:43:45.624719 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:43:45.813818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:45.814830 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql
[0m17:43:46.079562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70146135-29a4-4a8c-9c99-46211cc6dbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7F0059C0>]}
[0m17:43:46.189294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70146135-29a4-4a8c-9c99-46211cc6dbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7F32B430>]}
[0m17:43:46.189294 [info ] [MainThread]: Found 9 models, 1 source, 454 macros
[0m17:43:46.189294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70146135-29a4-4a8c-9c99-46211cc6dbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7F32AAD0>]}
[0m17:43:46.189294 [info ] [MainThread]: 
[0m17:43:46.189294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:46.189294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m17:43:46.205602 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m17:43:46.205602 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m17:43:46.205602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:47.165360 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.955 seconds
[0m17:43:47.165360 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m17:43:47.318738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m17:43:47.329884 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m17:43:47.329884 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m17:43:47.329884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:48.102156 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.771 seconds
[0m17:43:48.102156 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m17:43:48.260523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70146135-29a4-4a8c-9c99-46211cc6dbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7EFBD1E0>]}
[0m17:43:48.260523 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:43:48.260523 [info ] [MainThread]: 
[0m17:43:48.279752 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:43:48.279752 [info ] [Thread-1 (]: 1 of 9 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m17:43:48.279752 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m17:43:48.279752 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:43:48.292076 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:43:48.293996 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:43:48.332413 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:43:48.348277 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:43:48.348277 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
         as
        (

WITH raw_data AS (
    SELECT
        TransactionID::string AS TransactionID,
        UserID::string AS UserID,
        TransactionDate::timestamp AS TransactionDate,
        TransactionAmount::float AS TransactionAmount,
        TransactionType::string AS TransactionType,
        MerchantID::string AS MerchantID,
        Currency::string AS Currency,
        TransactionStatus::string AS TransactionStatus,
        DeviceType::string AS DeviceType,
        IP_Address::string AS IP_Address,
        PaymentMethod::string AS PaymentMethod,
        LocationCoordinates::string AS LocationCoordinates,
        SuspiciousFlag::boolean AS SuspiciousFlag,
        IsFraud::boolean AS IsFraud,
        ReviewStatus::string AS ReviewStatus,
        AnomalyScore::float AS AnomalyScore,
        TransactionTime::string AS TransactionTime,
        Age::int AS Age,
        Gender::string AS Gender,
        AccountCreationDate::timestamp AS AccountCreationDate,
        Location::string AS Location,
        AccountStatus::string AS AccountStatus,
        DeviceID::string AS DeviceID,
        UserProfileCompleteness::float AS UserProfileCompleteness,
        PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data;
[0m17:43:48.350715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:49.020475 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7e82f-0001-b2aa-0000-98f10004c072
[0m17:43:49.020475 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 31 unexpected ';'.
[0m17:43:49.020475 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m17:43:49.161972 [debug] [Thread-1 (]: Database Error in model br_fraud_detection_raw_data_historical (my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 31 unexpected ';'.
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql
[0m17:43:49.161972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70146135-29a4-4a8c-9c99-46211cc6dbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7F75F5E0>]}
[0m17:43:49.161972 [error] [Thread-1 (]: 1 of 9 ERROR creating sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[31mERROR[0m in 0.88s]
[0m17:43:49.161972 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:43:49.161972 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m17:43:49.161972 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m17:43:49.161972 [info ] [Thread-2 (]: 2 of 9 SKIP relation PUBLIC.si_devices_dimension ............................... [[33mSKIP[0m]
[0m17:43:49.161972 [info ] [Thread-1 (]: 3 of 9 SKIP relation PUBLIC.si_transactions_fact ............................... [[33mSKIP[0m]
[0m17:43:49.177613 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m17:43:49.177613 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m17:43:49.177613 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m17:43:49.177613 [info ] [Thread-2 (]: 4 of 9 SKIP relation PUBLIC.si_users_dimension ................................. [[33mSKIP[0m]
[0m17:43:49.177613 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:43:49.177613 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m17:43:49.177613 [info ] [Thread-1 (]: 5 of 9 SKIP relation PUBLIC.go_fraud_detection_dashboard_metrics ............... [[33mSKIP[0m]
[0m17:43:49.177613 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:43:49.177613 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:43:49.177613 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:43:49.177613 [info ] [Thread-2 (]: 6 of 9 SKIP relation PUBLIC.go_merchant_risk_assessment ........................ [[33mSKIP[0m]
[0m17:43:49.177613 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:43:49.177613 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:43:49.177613 [info ] [Thread-1 (]: 7 of 9 SKIP relation PUBLIC.go_real_time_fraud_detection ....................... [[33mSKIP[0m]
[0m17:43:49.177613 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:43:49.177613 [info ] [Thread-2 (]: 8 of 9 SKIP relation PUBLIC.go_user_behavior_metrics ........................... [[33mSKIP[0m]
[0m17:43:49.177613 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:43:49.177613 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:43:49.177613 [info ] [Thread-1 (]: 9 of 9 SKIP relation PUBLIC.go_predictive_model_features ....................... [[33mSKIP[0m]
[0m17:43:49.193245 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:43:49.196501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:49.197543 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m17:43:49.198540 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m17:43:49.199245 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical' was properly closed.
[0m17:43:49.200278 [info ] [MainThread]: 
[0m17:43:49.201279 [info ] [MainThread]: Finished running 9 incremental models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m17:43:49.204232 [debug] [MainThread]: Command end result
[0m17:43:49.238260 [info ] [MainThread]: 
[0m17:43:49.239326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:43:49.239326 [info ] [MainThread]: 
[0m17:43:49.239326 [error] [MainThread]:   Database Error in model br_fraud_detection_raw_data_historical (my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 31 unexpected ';'.
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql
[0m17:43:49.239326 [info ] [MainThread]: 
[0m17:43:49.246582 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=8 TOTAL=9
[0m17:43:49.248521 [debug] [MainThread]: Command `dbt run` failed at 17:43:49.248521 after 4.24 seconds
[0m17:43:49.248521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7B9BC370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7F328E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE7D905DB0>]}
[0m17:43:49.249439 [debug] [MainThread]: Flushing usage events
[0m17:45:37.634939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190DEF2C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E18F5CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E18F5EA0>]}


============================== 17:45:37.635552 | a89332ec-e5db-4f83-b425-928d5d95b878 ==============================
[0m17:45:37.635552 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:45:37.642783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:38.135992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E2550490>]}
[0m17:45:38.183039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E2553E20>]}
[0m17:45:38.184155 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:45:38.184155 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:45:38.370906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:38.370906 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\bronze\br_fraud_detection_raw_data_historical.sql
[0m17:45:38.625211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E18BB100>]}
[0m17:45:38.735357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E38934C0>]}
[0m17:45:38.735357 [info ] [MainThread]: Found 9 models, 1 source, 454 macros
[0m17:45:38.735357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E38923B0>]}
[0m17:45:38.735357 [info ] [MainThread]: 
[0m17:45:38.735357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:38.735357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m17:45:38.762470 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m17:45:38.762470 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m17:45:38.763525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:39.675362 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.912 seconds
[0m17:45:39.675362 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m17:45:39.825413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m17:45:39.835464 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m17:45:39.835464 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m17:45:39.835464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:40.443441 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.613 seconds
[0m17:45:40.443441 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m17:45:40.581717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190DED6BBB0>]}
[0m17:45:40.581717 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:45:40.598235 [info ] [MainThread]: 
[0m17:45:40.598235 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:45:40.598235 [info ] [Thread-1 (]: 1 of 9 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m17:45:40.598235 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m17:45:40.610175 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:45:40.623695 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:45:40.625602 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:45:40.678953 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:45:40.681905 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:45:40.681905 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
         as
        (

WITH raw_data AS (
    SELECT
        TransactionID::string AS TransactionID,
        UserID::string AS UserID,
        TransactionDate::timestamp AS TransactionDate,
        TransactionAmount::float AS TransactionAmount,
        TransactionType::string AS TransactionType,
        MerchantID::string AS MerchantID,
        Currency::string AS Currency,
        TransactionStatus::string AS TransactionStatus,
        DeviceType::string AS DeviceType,
        IP_Address::string AS IP_Address,
        PaymentMethod::string AS PaymentMethod,
        LocationCoordinates::string AS LocationCoordinates,
        SuspiciousFlag::boolean AS SuspiciousFlag,
        IsFraud::boolean AS IsFraud,
        ReviewStatus::string AS ReviewStatus,
        AnomalyScore::float AS AnomalyScore,
        TransactionTime::string AS TransactionTime,
        Age::int AS Age,
        Gender::string AS Gender,
        AccountCreationDate::timestamp AS AccountCreationDate,
        Location::string AS Location,
        AccountStatus::string AS AccountStatus,
        DeviceID::string AS DeviceID,
        UserProfileCompleteness::float AS UserProfileCompleteness,
        PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data
        );
[0m17:45:40.682996 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:41.985765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.305 seconds
[0m17:45:41.985765 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:45:42.000359 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:45:42.000359 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp cascade
[0m17:45:42.100945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m17:45:42.131692 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m17:45:42.267165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3C9B580>]}
[0m17:45:42.275669 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[32mSUCCESS 1[0m in 1.67s]
[0m17:45:42.278380 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:45:42.278538 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m17:45:42.278538 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m17:45:42.281320 [info ] [Thread-2 (]: 2 of 9 START sql incremental model PUBLIC.si_devices_dimension ................. [RUN]
[0m17:45:42.283329 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.si_devices_dimension'
[0m17:45:42.282327 [info ] [Thread-1 (]: 3 of 9 START sql incremental model PUBLIC.si_transactions_fact ................. [RUN]
[0m17:45:42.284329 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_devices_dimension
[0m17:45:42.285330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.br_fraud_detection_raw_data_historical, now model.my_fraud_detection_project.si_transactions_fact)
[0m17:45:42.292424 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:45:42.293327 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.si_transactions_fact
[0m17:45:42.298330 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:45:42.303337 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_devices_dimension
[0m17:45:42.308336 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:45:42.311326 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.si_transactions_fact
[0m17:45:42.316414 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:45:42.317366 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:45:42.319328 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:45:42.320369 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension
         as
        (

WITH devices_dimension AS (
    SELECT
        DeviceID,
        FIRST_VALUE(DeviceType) AS DeviceType,
        FIRST_VALUE(IP_Address) AS IP_Address
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    GROUP BY DeviceID
    
)

SELECT DISTINCT * FROM devices_dimension
        );
[0m17:45:42.321329 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
         as
        (

WITH transactions_fact AS (
    SELECT *
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
)

SELECT DISTINCT
    TransactionID,
    UserID,
    TransactionDate,
    TransactionAmount,
    TransactionType,
    MerchantID,
    Currency,
    TransactionStatus,
    DeviceType,
    IP_Address,
    PaymentMethod,
    SuspiciousFlag,
    IsFraud,
    AnomalyScore,
    Age,
    Gender,
    AccountCreationDate,
    Location,
    LocationCoordinates,
    AccountStatus,
    DeviceID,
    UserProfileCompleteness,
    PreviousFraudAttempts
FROM transactions_fact
        );
[0m17:45:42.322338 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:45:42.323378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:43.255445 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7e831-0001-b2aa-0000-98f10004c07a
[0m17:45:43.255445 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002064 (42601): SQL compilation error:
Missing window specification for function [FIRST_VALUE(BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL.DEVICETYPE)].
[0m17:45:43.255445 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: Close
[0m17:45:43.392536 [debug] [Thread-2 (]: Database Error in model si_devices_dimension (my_fraud_detection_project/models\silver\si_devices_dimension.sql)
  002064 (42601): SQL compilation error:
  Missing window specification for function [FIRST_VALUE(BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL.DEVICETYPE)].
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\silver\si_devices_dimension.sql
[0m17:45:43.392536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3CF8FA0>]}
[0m17:45:43.392536 [error] [Thread-2 (]: 2 of 9 ERROR creating sql incremental model PUBLIC.si_devices_dimension ........ [[31mERROR[0m in 1.11s]
[0m17:45:43.392536 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m17:45:43.392536 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m17:45:43.392536 [info ] [Thread-2 (]: 4 of 9 START sql incremental model PUBLIC.si_users_dimension ................... [RUN]
[0m17:45:43.392536 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_devices_dimension, now model.my_fraud_detection_project.si_users_dimension)
[0m17:45:43.392536 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_users_dimension
[0m17:45:43.392536 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:45:43.409844 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_users_dimension
[0m17:45:43.416766 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:45:43.419669 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:45:43.420765 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension
         as
        (

WITH users_dimension AS (
    SELECT
        UserID,
        FIRST_VALUE(Age) AS Age,
        FIRST_VALUE(Gender) AS Gender,
        FIRST_VALUE(AccountCreationDate) AS AccountCreationDate,
        FIRST_VALUE(AccountStatus) AS AccountStatus,
        FIRST_VALUE(UserProfileCompleteness) AS UserProfileCompleteness,
        FIRST_VALUE(PreviousFraudAttempts) AS PreviousFraudAttempts,
        FIRST_VALUE(Location) AS UserLocation
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    GROUP BY UserID
    
)

SELECT DISTINCT * FROM users_dimension
        );
[0m17:45:43.420765 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:43.984385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.669 seconds
[0m17:45:44.000126 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:45:44.001343 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:45:44.001343 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp cascade
[0m17:45:44.111350 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7e831-0001-b2aa-0000-98f10004c07e
[0m17:45:44.111350 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002064 (42601): SQL compilation error:
Missing window specification for function [FIRST_VALUE(BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL.AGE)].
[0m17:45:44.111350 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: Close
[0m17:45:44.127075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m17:45:44.127075 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: Close
[0m17:45:44.253535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3E396C0>]}
[0m17:45:44.253535 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model PUBLIC.si_transactions_fact ............ [[32mSUCCESS 1[0m in 1.97s]
[0m17:45:44.253535 [debug] [Thread-2 (]: Database Error in model si_users_dimension (my_fraud_detection_project/models\silver\si_users_dimension.sql)
  002064 (42601): SQL compilation error:
  Missing window specification for function [FIRST_VALUE(BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL.AGE)].
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\silver\si_users_dimension.sql
[0m17:45:44.253535 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m17:45:44.253535 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3E4CF70>]}
[0m17:45:44.253535 [error] [Thread-2 (]: 4 of 9 ERROR creating sql incremental model PUBLIC.si_users_dimension .......... [[31mERROR[0m in 0.86s]
[0m17:45:44.253535 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:45:44.263745 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m17:45:44.265669 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:45:44.265247 [info ] [Thread-1 (]: 5 of 9 START sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics . [RUN]
[0m17:45:44.268297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_transactions_fact, now model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics)
[0m17:45:44.266671 [info ] [Thread-2 (]: 6 of 9 START sql incremental model PUBLIC.go_merchant_risk_assessment .......... [RUN]
[0m17:45:44.268387 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:45:44.268387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_users_dimension, now model.my_fraud_detection_project.go_merchant_risk_assessment)
[0m17:45:44.271995 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:45:44.271995 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:45:44.271995 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:45:44.285656 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:45:44.287656 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:45:44.288503 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:45:44.288503 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:45:44.288503 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:45:44.288503 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics
         as
        (

WITH fraud_detection_dashboard_metrics AS (
    SELECT
        COUNT(TransactionID) AS total_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN 1 ELSE 0 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        COUNT(DISTINCT UserID) AS unique_users,
        COUNT(DISTINCT MerchantID) AS unique_merchants,
        AVG(AnomalyScore) AS avg_anomaly_score,
        MAX(TransactionDate) AS last_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    
)

SELECT DISTINCT * FROM fraud_detection_dashboard_metrics
        );
[0m17:45:44.304768 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:45:44.305705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:44.307714 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
         as
        (

WITH merchant_risk_assessment AS (
    SELECT
        MerchantID,
        COUNT(TransactionID) AS total_transactions,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        AVG(AnomalyScore) AS avg_anomaly_score,
        COUNT(DISTINCT UserID) AS unique_users
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY MerchantID
    
)

SELECT DISTINCT * FROM merchant_risk_assessment
        );
[0m17:45:44.311715 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:46.162260 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.852 seconds
[0m17:45:46.162260 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m17:45:46.162260 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:45:46.162260 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp cascade
[0m17:45:46.233155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.928 seconds
[0m17:45:46.233155 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp
[0m17:45:46.233155 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:45:46.233155 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp cascade
[0m17:45:46.245905 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m17:45:46.245905 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: Close
[0m17:45:46.317310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m17:45:46.325300 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: Close
[0m17:45:46.395002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3F979D0>]}
[0m17:45:46.395002 [info ] [Thread-2 (]: 6 of 9 OK created sql incremental model PUBLIC.go_merchant_risk_assessment ..... [[32mSUCCESS 1[0m in 2.13s]
[0m17:45:46.395002 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:45:46.395002 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:45:46.395002 [info ] [Thread-2 (]: 7 of 9 START sql incremental model PUBLIC.go_real_time_fraud_detection ......... [RUN]
[0m17:45:46.395002 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_merchant_risk_assessment, now model.my_fraud_detection_project.go_real_time_fraud_detection)
[0m17:45:46.395002 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:45:46.413225 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:45:46.415257 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:45:46.416920 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:45:46.416920 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:45:46.416920 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection
         as
        (

WITH real_time_fraud_detection AS (
    SELECT
        TransactionID,
        TransactionDate,
        TransactionAmount,
        TransactionType,
        UserID,
        MerchantID,
        DeviceID,
        IP_Address,
        AnomalyScore,
        IsFraud,
        CASE
            WHEN AnomalyScore > 0.8 THEN 'High Risk'
            WHEN AnomalyScore > 0.5 THEN 'Moderate Risk'
            ELSE 'Low Risk'
        END AS fraud_risk_level
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    WHERE AnomalyScore > 0.5 OR IsFraud = 1
    
)

SELECT DISTINCT * FROM real_time_fraud_detection
        );
[0m17:45:46.416920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:46.457518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E38E7AC0>]}
[0m17:45:46.457518 [info ] [Thread-1 (]: 5 of 9 OK created sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics  [[32mSUCCESS 1[0m in 2.19s]
[0m17:45:46.457518 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:45:46.457518 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:45:46.457518 [info ] [Thread-1 (]: 8 of 9 START sql incremental model PUBLIC.go_user_behavior_metrics ............. [RUN]
[0m17:45:46.457518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics, now model.my_fraud_detection_project.go_user_behavior_metrics)
[0m17:45:46.457518 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:45:46.476447 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:45:46.478636 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:45:46.478636 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:45:46.478636 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:45:46.478636 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
         as
        (

WITH user_behavior_metrics AS (
    SELECT
        UserID,
        COUNT(TransactionID) AS total_transactions,
        AVG(TransactionAmount) AS avg_transaction_amount,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        COUNT(DISTINCT DeviceID) AS unique_devices,
        MAX(TransactionDate) AS last_transaction_date,
        MIN(TransactionDate) AS first_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY UserID
    
)

SELECT DISTINCT * FROM user_behavior_metrics
        );
[0m17:45:46.478636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:47.852197 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.428 seconds
[0m17:45:47.852197 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m17:45:47.852197 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:45:47.852197 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp cascade
[0m17:45:47.915176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.426 seconds
[0m17:45:47.915176 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m17:45:47.915176 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:45:47.915176 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp cascade
[0m17:45:47.931518 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m17:45:47.931518 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: Close
[0m17:45:47.998923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m17:45:47.998923 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: Close
[0m17:45:48.073042 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3C84EE0>]}
[0m17:45:48.073042 [info ] [Thread-2 (]: 7 of 9 OK created sql incremental model PUBLIC.go_real_time_fraud_detection .... [[32mSUCCESS 1[0m in 1.68s]
[0m17:45:48.073042 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:45:48.121694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3E4E320>]}
[0m17:45:48.121694 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model PUBLIC.go_user_behavior_metrics ........ [[32mSUCCESS 1[0m in 1.66s]
[0m17:45:48.121694 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:45:48.121694 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:45:48.121694 [info ] [Thread-2 (]: 9 of 9 START sql incremental model PUBLIC.go_predictive_model_features ......... [RUN]
[0m17:45:48.121694 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_real_time_fraud_detection, now model.my_fraud_detection_project.go_predictive_model_features)
[0m17:45:48.121694 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_predictive_model_features
[0m17:45:48.139096 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:45:48.143235 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_predictive_model_features
[0m17:45:48.143235 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:45:48.143235 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:45:48.143235 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features
         as
        (

WITH transactions_fact AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
),
user_behavior_metrics AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
),
merchant_risk_assessment AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
)

SELECT
    tf.TransactionID,
    tf.TransactionAmount,
    tf.TransactionType,
    tf.AnomalyScore,
    ubm.total_transactions AS user_total_transactions,
    ubm.avg_transaction_amount AS user_avg_transaction_amount,
    ubm.total_fraud_transactions AS user_fraud_transactions,
    mra.total_fraud_transactions AS merchant_fraud_transactions,
    mra.avg_anomaly_score AS merchant_avg_anomaly_score,
    tf.IsFraud
FROM transactions_fact tf
JOIN user_behavior_metrics ubm ON tf.UserID = ubm.UserID
JOIN merchant_risk_assessment mra ON tf.MerchantID = mra.MerchantID

        );
[0m17:45:48.143235 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:45:49.507420 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.355 seconds
[0m17:45:49.512415 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m17:45:49.514415 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:45:49.514415 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp cascade
[0m17:45:49.598823 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m17:45:49.598823 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: Close
[0m17:45:49.710372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a89332ec-e5db-4f83-b425-928d5d95b878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3F63FD0>]}
[0m17:45:49.710372 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model PUBLIC.go_predictive_model_features .... [[32mSUCCESS 1[0m in 1.59s]
[0m17:45:49.710372 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:45:49.710372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:49.710372 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m17:45:49.710372 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m17:45:49.710372 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_user_behavior_metrics' was properly closed.
[0m17:45:49.710372 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_predictive_model_features' was properly closed.
[0m17:45:49.710372 [info ] [MainThread]: 
[0m17:45:49.710372 [info ] [MainThread]: Finished running 9 incremental models in 0 hours 0 minutes and 10.98 seconds (10.98s).
[0m17:45:49.726100 [debug] [MainThread]: Command end result
[0m17:45:49.810865 [info ] [MainThread]: 
[0m17:45:49.811879 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:45:49.812863 [info ] [MainThread]: 
[0m17:45:49.814876 [error] [MainThread]:   Database Error in model si_devices_dimension (my_fraud_detection_project/models\silver\si_devices_dimension.sql)
  002064 (42601): SQL compilation error:
  Missing window specification for function [FIRST_VALUE(BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL.DEVICETYPE)].
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\silver\si_devices_dimension.sql
[0m17:45:49.815864 [info ] [MainThread]: 
[0m17:45:49.816864 [error] [MainThread]:   Database Error in model si_users_dimension (my_fraud_detection_project/models\silver\si_users_dimension.sql)
  002064 (42601): SQL compilation error:
  Missing window specification for function [FIRST_VALUE(BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL.AGE)].
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\silver\si_users_dimension.sql
[0m17:45:49.818918 [info ] [MainThread]: 
[0m17:45:49.819865 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m17:45:49.823882 [debug] [MainThread]: Command `dbt run` failed at 17:45:49.822886 after 12.30 seconds
[0m17:45:49.824879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190DEF2C2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E397B910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E397BA90>]}
[0m17:45:49.824879 [debug] [MainThread]: Flushing usage events
[0m17:48:11.965533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD560CC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD58A91C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD58A91E70>]}


============================== 17:48:11.965533 | ff280384-1733-4c08-a862-f35e12b93b81 ==============================
[0m17:48:11.965533 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:48:11.965533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:48:12.454419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD597016F0>]}
[0m17:48:12.485907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD597271C0>]}
[0m17:48:12.501872 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:48:12.501872 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:48:12.671997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:48:12.671997 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\silver\si_devices_dimension.sql
[0m17:48:12.671997 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\silver\si_users_dimension.sql
[0m17:48:12.935535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AB65720>]}
[0m17:48:13.047204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AB65930>]}
[0m17:48:13.048231 [info ] [MainThread]: Found 9 models, 1 source, 454 macros
[0m17:48:13.049952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AB64F10>]}
[0m17:48:13.049952 [info ] [MainThread]: 
[0m17:48:13.055730 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:48:13.060981 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m17:48:13.077115 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m17:48:13.077115 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m17:48:13.077115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:13.947741 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.873 seconds
[0m17:48:13.947741 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m17:48:14.068697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m17:48:14.088705 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m17:48:14.088705 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m17:48:14.088705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:14.864846 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.777 seconds
[0m17:48:14.864846 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m17:48:15.001922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD563EB280>]}
[0m17:48:15.001922 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:48:15.001922 [info ] [MainThread]: 
[0m17:48:15.008568 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:48:15.008568 [info ] [Thread-1 (]: 1 of 9 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m17:48:15.008568 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m17:48:15.012495 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:48:15.017619 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:15.017619 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:48:15.071970 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:15.071970 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
  
   as (
    

WITH raw_data AS (
    SELECT
        TransactionID::string AS TransactionID,
        UserID::string AS UserID,
        TransactionDate::timestamp AS TransactionDate,
        TransactionAmount::float AS TransactionAmount,
        TransactionType::string AS TransactionType,
        MerchantID::string AS MerchantID,
        Currency::string AS Currency,
        TransactionStatus::string AS TransactionStatus,
        DeviceType::string AS DeviceType,
        IP_Address::string AS IP_Address,
        PaymentMethod::string AS PaymentMethod,
        LocationCoordinates::string AS LocationCoordinates,
        SuspiciousFlag::boolean AS SuspiciousFlag,
        IsFraud::boolean AS IsFraud,
        ReviewStatus::string AS ReviewStatus,
        AnomalyScore::float AS AnomalyScore,
        TransactionTime::string AS TransactionTime,
        Age::int AS Age,
        Gender::string AS Gender,
        AccountCreationDate::timestamp AS AccountCreationDate,
        Location::string AS Location,
        AccountStatus::string AS AccountStatus,
        DeviceID::string AS DeviceID,
        UserProfileCompleteness::float AS UserProfileCompleteness,
        PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging
    
        WHERE TransactionID::string > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical)
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data
  );
[0m17:48:15.071970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:15.778442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m17:48:15.792350 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:15.793366 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:48:15.888771 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.096 seconds
[0m17:48:15.894520 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:15.894520 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
[0m17:48:15.968768 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.071 seconds
[0m17:48:15.974065 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:15.974065 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL"
[0m17:48:16.052941 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.071 seconds
[0m17:48:16.072675 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:16.072675 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:16.072675 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
-- back compat for old kwarg name
  
  begin;
[0m17:48:16.173579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m17:48:16.173579 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:16.173579 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","REVIEWSTATUS" = DBT_INTERNAL_SOURCE."REVIEWSTATUS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","TRANSACTIONTIME" = DBT_INTERNAL_SOURCE."TRANSACTIONTIME","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m17:48:17.070781 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.898 seconds
[0m17:48:17.070781 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:17.070781 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
COMMIT
[0m17:48:17.228875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m17:48:17.244386 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:48:17.259984 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:48:17.259984 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp cascade
[0m17:48:17.367875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m17:48:17.383516 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m17:48:17.506789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AE62110>]}
[0m17:48:17.508797 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[32mSUCCESS 0[0m in 2.50s]
[0m17:48:17.511230 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:48:17.512232 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m17:48:17.513232 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m17:48:17.514318 [info ] [Thread-2 (]: 2 of 9 START sql incremental model PUBLIC.si_devices_dimension ................. [RUN]
[0m17:48:17.516106 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.si_devices_dimension'
[0m17:48:17.515233 [info ] [Thread-1 (]: 3 of 9 START sql incremental model PUBLIC.si_transactions_fact ................. [RUN]
[0m17:48:17.517118 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_devices_dimension
[0m17:48:17.517718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.br_fraud_detection_raw_data_historical, now model.my_fraud_detection_project.si_transactions_fact)
[0m17:48:17.520690 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:48:17.525719 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.si_transactions_fact
[0m17:48:17.531013 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:17.531013 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_devices_dimension
[0m17:48:17.536469 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.si_transactions_fact
[0m17:48:17.536469 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:48:17.552083 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:17.555766 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT *
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact)
    
)

SELECT DISTINCT
    TransactionID,
    UserID,
    TransactionDate,
    TransactionAmount,
    TransactionType,
    MerchantID,
    Currency,
    TransactionStatus,
    DeviceType,
    IP_Address,
    PaymentMethod,
    SuspiciousFlag,
    IsFraud,
    AnomalyScore,
    Age,
    Gender,
    AccountCreationDate,
    Location,
    LocationCoordinates,
    AccountStatus,
    DeviceID,
    UserProfileCompleteness,
    PreviousFraudAttempts
FROM transactions_fact
  );
[0m17:48:17.558442 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:48:17.558442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:17.558442 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension
         as
        (

WITH devices_dimension AS (
    SELECT
        DeviceID,
        FIRST_VALUE(DeviceType) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS DeviceType,
        FIRST_VALUE(IP_Address) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS IP_Address
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
)

SELECT DISTINCT * FROM devices_dimension;
[0m17:48:17.558442 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:48:18.239665 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7e834-0001-b2a9-0000-98f10004b0da
[0m17:48:18.239665 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 40 unexpected ';'.
[0m17:48:18.239665 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: Close
[0m17:48:18.357408 [debug] [Thread-2 (]: Database Error in model si_devices_dimension (my_fraud_detection_project/models\silver\si_devices_dimension.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 40 unexpected ';'.
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\silver\si_devices_dimension.sql
[0m17:48:18.358939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AF823E0>]}
[0m17:48:18.358939 [error] [Thread-2 (]: 2 of 9 ERROR creating sql incremental model PUBLIC.si_devices_dimension ........ [[31mERROR[0m in 0.84s]
[0m17:48:18.358939 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m17:48:18.358939 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m17:48:18.358939 [info ] [Thread-2 (]: 4 of 9 START sql incremental model PUBLIC.si_users_dimension ................... [RUN]
[0m17:48:18.358939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_devices_dimension, now model.my_fraud_detection_project.si_users_dimension)
[0m17:48:18.358939 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_users_dimension
[0m17:48:18.358939 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:48:18.369985 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_users_dimension
[0m17:48:18.369985 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:48:18.377117 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:48:18.378127 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension
         as
        (

WITH users_dimension AS (
    SELECT
        UserID,
        FIRST_VALUE(Age) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Age,
        FIRST_VALUE(Gender) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Gender,
        FIRST_VALUE(AccountCreationDate) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountCreationDate,
        FIRST_VALUE(AccountStatus) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountStatus,
        FIRST_VALUE(UserProfileCompleteness) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserProfileCompleteness,
        FIRST_VALUE(PreviousFraudAttempts) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS PreviousFraudAttempts,
        FIRST_VALUE(Location) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserLocation
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
)

SELECT DISTINCT * FROM users_dimension;
[0m17:48:18.379193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:18.478242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m17:48:18.478242 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:18.478242 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:48:18.568419 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.080 seconds
[0m17:48:18.573939 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:18.573939 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
[0m17:48:18.626786 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.066 seconds
[0m17:48:18.642522 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:18.642522 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_TRANSACTIONS_FACT"
[0m17:48:18.710369 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.066 seconds
[0m17:48:18.710369 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:18.721670 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:18.721670 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
-- back compat for old kwarg name
  
  begin;
[0m17:48:18.824282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m17:48:18.826282 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:18.827278 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m17:48:18.940905 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7e834-0001-b2aa-0000-98f10004c0c2
[0m17:48:18.957592 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 38 unexpected ';'.
[0m17:48:18.957592 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: Close
[0m17:48:19.082175 [debug] [Thread-2 (]: Database Error in model si_users_dimension (my_fraud_detection_project/models\silver\si_users_dimension.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 38 unexpected ';'.
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\silver\si_users_dimension.sql
[0m17:48:19.082175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AF834C0>]}
[0m17:48:19.083515 [error] [Thread-2 (]: 4 of 9 ERROR creating sql incremental model PUBLIC.si_users_dimension .......... [[31mERROR[0m in 0.72s]
[0m17:48:19.084754 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m17:48:19.564937 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.740 seconds
[0m17:48:19.564937 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:19.571957 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
COMMIT
[0m17:48:19.742995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m17:48:19.742995 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:48:19.742995 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:48:19.742995 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp cascade
[0m17:48:19.843260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m17:48:19.843260 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: Close
[0m17:48:19.959345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AFF58D0>]}
[0m17:48:19.959345 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model PUBLIC.si_transactions_fact ............ [[32mSUCCESS 0[0m in 2.44s]
[0m17:48:19.959345 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m17:48:19.963454 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:48:19.963454 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:48:19.963454 [info ] [Thread-2 (]: 5 of 9 START sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics . [RUN]
[0m17:48:19.963454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_users_dimension, now model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics)
[0m17:48:19.963454 [info ] [Thread-1 (]: 6 of 9 START sql incremental model PUBLIC.go_merchant_risk_assessment .......... [RUN]
[0m17:48:19.968103 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:48:19.969152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_transactions_fact, now model.my_fraud_detection_project.go_merchant_risk_assessment)
[0m17:48:19.973252 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:48:19.973252 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:48:19.973252 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:48:19.973252 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:48:19.982118 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:48:19.987130 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:48:19.988318 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:48:19.988318 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
  
   as (
    

WITH merchant_risk_assessment AS (
    SELECT
        MerchantID,
        COUNT(TransactionID) AS total_transactions,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        AVG(AnomalyScore) AS avg_anomaly_score,
        COUNT(DISTINCT UserID) AS unique_users
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY MerchantID
    
        WHERE MerchantID > (SELECT MAX(MerchantID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment)
    
)

SELECT DISTINCT * FROM merchant_risk_assessment
  );
[0m17:48:20.001970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:19.988318 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp
  
   as (
    

WITH fraud_detection_dashboard_metrics AS (
    SELECT
        COUNT(TransactionID) AS total_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN 1 ELSE 0 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        COUNT(DISTINCT UserID) AS unique_users,
        COUNT(DISTINCT MerchantID) AS unique_merchants,
        AVG(AnomalyScore) AS avg_anomaly_score,
        MAX(TransactionDate) AS last_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    
        WHERE TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics)
    
)

SELECT DISTINCT * FROM fraud_detection_dashboard_metrics
  );
[0m17:48:20.006981 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:20.704924 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7e834-0001-b2a9-0000-98f10004b0ea
[0m17:48:20.704924 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 8 unexpected 'WHERE'.
syntax error line 21 at position 0 unexpected 'SELECT'.
[0m17:48:20.704924 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: Close
[0m17:48:20.740927 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7e834-0001-b2aa-0000-98f10004c0ce
[0m17:48:20.740927 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(SI_TRANSACTIONS_FACT.TRANSACTIONID)] can only appear in having or select clause
[0m17:48:20.744194 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: Close
[0m17:48:20.825625 [debug] [Thread-1 (]: Database Error in model go_merchant_risk_assessment (my_fraud_detection_project/models\gold\go_merchant_risk_assessment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 8 unexpected 'WHERE'.
  syntax error line 21 at position 0 unexpected 'SELECT'.
[0m17:48:20.826707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5B023DF0>]}
[0m17:48:20.827731 [error] [Thread-1 (]: 6 of 9 ERROR creating sql incremental model PUBLIC.go_merchant_risk_assessment . [[31mERROR[0m in 0.86s]
[0m17:48:20.828626 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:48:20.829711 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:48:20.830662 [info ] [Thread-1 (]: 7 of 9 START sql incremental model PUBLIC.go_real_time_fraud_detection ......... [RUN]
[0m17:48:20.831626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_merchant_risk_assessment, now model.my_fraud_detection_project.go_real_time_fraud_detection)
[0m17:48:20.831626 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:48:20.835707 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:48:20.836709 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:48:20.841713 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:48:20.842706 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
  
   as (
    

WITH real_time_fraud_detection AS (
    SELECT
        TransactionID,
        TransactionDate,
        TransactionAmount,
        TransactionType,
        UserID,
        MerchantID,
        DeviceID,
        IP_Address,
        AnomalyScore,
        IsFraud,
        CASE
            WHEN AnomalyScore > 0.8 THEN 'High Risk'
            WHEN AnomalyScore > 0.5 THEN 'Moderate Risk'
            ELSE 'Low Risk'
        END AS fraud_risk_level
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    WHERE AnomalyScore > 0.5 OR IsFraud = 1
    
        WHERE TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection)
    
)

SELECT DISTINCT * FROM real_time_fraud_detection
  );
[0m17:48:20.842706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:20.855151 [debug] [Thread-2 (]: Database Error in model go_fraud_detection_dashboard_metrics (my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(SI_TRANSACTIONS_FACT.TRANSACTIONID)] can only appear in having or select clause
[0m17:48:20.855151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5B192410>]}
[0m17:48:20.866854 [error] [Thread-2 (]: 5 of 9 ERROR creating sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics  [[31mERROR[0m in 0.89s]
[0m17:48:20.868842 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:48:20.869848 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:48:20.870934 [info ] [Thread-2 (]: 8 of 9 START sql incremental model PUBLIC.go_user_behavior_metrics ............. [RUN]
[0m17:48:20.870934 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics, now model.my_fraud_detection_project.go_user_behavior_metrics)
[0m17:48:20.874469 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:48:20.874469 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:48:20.874469 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:48:20.884383 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:48:20.885422 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
  
   as (
    

WITH user_behavior_metrics AS (
    SELECT
        UserID,
        COUNT(TransactionID) AS total_transactions,
        AVG(TransactionAmount) AS avg_transaction_amount,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        COUNT(DISTINCT DeviceID) AS unique_devices,
        MAX(TransactionDate) AS last_transaction_date,
        MIN(TransactionDate) AS first_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY UserID
    
        WHERE UserID > (SELECT MAX(UserID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics)
    
)

SELECT DISTINCT * FROM user_behavior_metrics
  );
[0m17:48:20.886505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:21.505243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7e834-0001-b2a9-0000-98f10004b0ee
[0m17:48:21.505243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 8 unexpected 'WHERE'.
syntax error line 30 at position 0 unexpected 'SELECT'.
[0m17:48:21.505243 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: Close
[0m17:48:21.521664 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7e834-0001-b2aa-0000-98f10004c0d2
[0m17:48:21.521664 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 8 unexpected 'WHERE'.
syntax error line 22 at position 0 unexpected 'SELECT'.
[0m17:48:21.521664 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: Close
[0m17:48:21.616523 [debug] [Thread-1 (]: Database Error in model go_real_time_fraud_detection (my_fraud_detection_project/models\gold\go_real_time_fraud_detection.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 8 unexpected 'WHERE'.
  syntax error line 30 at position 0 unexpected 'SELECT'.
[0m17:48:21.616523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5B186FB0>]}
[0m17:48:21.616523 [error] [Thread-1 (]: 7 of 9 ERROR creating sql incremental model PUBLIC.go_real_time_fraud_detection  [[31mERROR[0m in 0.78s]
[0m17:48:21.616523 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:48:21.616523 [debug] [Thread-2 (]: Database Error in model go_user_behavior_metrics (my_fraud_detection_project/models\gold\go_user_behavior_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 8 unexpected 'WHERE'.
  syntax error line 22 at position 0 unexpected 'SELECT'.
[0m17:48:21.616523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff280384-1733-4c08-a862-f35e12b93b81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AE63280>]}
[0m17:48:21.616523 [error] [Thread-2 (]: 8 of 9 ERROR creating sql incremental model PUBLIC.go_user_behavior_metrics .... [[31mERROR[0m in 0.75s]
[0m17:48:21.616523 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:48:21.629576 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:48:21.630690 [info ] [Thread-1 (]: 9 of 9 SKIP relation PUBLIC.go_predictive_model_features ....................... [[33mSKIP[0m]
[0m17:48:21.632584 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:48:21.633584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:21.634667 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m17:48:21.634667 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m17:48:21.634667 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_real_time_fraud_detection' was properly closed.
[0m17:48:21.634667 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_user_behavior_metrics' was properly closed.
[0m17:48:21.634667 [info ] [MainThread]: 
[0m17:48:21.634667 [info ] [MainThread]: Finished running 9 incremental models in 0 hours 0 minutes and 8.58 seconds (8.58s).
[0m17:48:21.639625 [debug] [MainThread]: Command end result
[0m17:48:21.729564 [info ] [MainThread]: 
[0m17:48:21.731486 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m17:48:21.732268 [info ] [MainThread]: 
[0m17:48:21.733278 [error] [MainThread]:   Database Error in model si_devices_dimension (my_fraud_detection_project/models\silver\si_devices_dimension.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 40 unexpected ';'.
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\silver\si_devices_dimension.sql
[0m17:48:21.735387 [info ] [MainThread]: 
[0m17:48:21.736288 [error] [MainThread]:   Database Error in model si_users_dimension (my_fraud_detection_project/models\silver\si_users_dimension.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 38 unexpected ';'.
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\silver\si_users_dimension.sql
[0m17:48:21.738286 [info ] [MainThread]: 
[0m17:48:21.739291 [error] [MainThread]:   Database Error in model go_merchant_risk_assessment (my_fraud_detection_project/models\gold\go_merchant_risk_assessment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 8 unexpected 'WHERE'.
  syntax error line 21 at position 0 unexpected 'SELECT'.
[0m17:48:21.741285 [info ] [MainThread]: 
[0m17:48:21.742294 [error] [MainThread]:   Database Error in model go_fraud_detection_dashboard_metrics (my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(SI_TRANSACTIONS_FACT.TRANSACTIONID)] can only appear in having or select clause
[0m17:48:21.742294 [info ] [MainThread]: 
[0m17:48:21.743604 [error] [MainThread]:   Database Error in model go_real_time_fraud_detection (my_fraud_detection_project/models\gold\go_real_time_fraud_detection.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 8 unexpected 'WHERE'.
  syntax error line 30 at position 0 unexpected 'SELECT'.
[0m17:48:21.744609 [info ] [MainThread]: 
[0m17:48:21.745610 [error] [MainThread]:   Database Error in model go_user_behavior_metrics (my_fraud_detection_project/models\gold\go_user_behavior_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 8 unexpected 'WHERE'.
  syntax error line 22 at position 0 unexpected 'SELECT'.
[0m17:48:21.746384 [info ] [MainThread]: 
[0m17:48:21.747409 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=6 SKIP=1 TOTAL=9
[0m17:48:21.749420 [debug] [MainThread]: Command `dbt run` failed at 17:48:21.748392 after 9.85 seconds
[0m17:48:21.749420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD560CC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5AAD2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD5B1B5CF0>]}
[0m17:48:21.750392 [debug] [MainThread]: Flushing usage events
[0m17:52:42.660826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C06AC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C3075C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C3075E70>]}


============================== 17:52:42.665851 | ab3eb24c-ca23-465d-89f7-7d13bf710634 ==============================
[0m17:52:42.665851 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:52:42.666750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:52:43.147723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C3CD16F0>]}
[0m17:52:43.209076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C3CF71C0>]}
[0m17:52:43.210988 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:52:43.211988 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:52:43.412107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m17:52:43.412107 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\silver\si_users_dimension.sql
[0m17:52:43.412107 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\gold\go_real_time_fraud_detection.sql
[0m17:52:43.412107 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:52:43.412107 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\gold\go_merchant_risk_assessment.sql
[0m17:52:43.412107 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\silver\si_devices_dimension.sql
[0m17:52:43.412107 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\gold\go_user_behavior_metrics.sql
[0m17:52:43.695540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C5129420>]}
[0m17:52:43.806812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C5128A30>]}
[0m17:52:43.806812 [info ] [MainThread]: Found 9 models, 1 source, 454 macros
[0m17:52:43.808814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C0A49BA0>]}
[0m17:52:43.811812 [info ] [MainThread]: 
[0m17:52:43.813640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:52:43.824645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m17:52:43.841095 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m17:52:43.841095 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m17:52:43.841095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:44.790602 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.948 seconds
[0m17:52:44.792613 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m17:52:44.963439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m17:52:44.990597 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m17:52:44.990597 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m17:52:44.990597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:45.591775 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.600 seconds
[0m17:52:45.593382 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m17:52:45.720564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C3CADC90>]}
[0m17:52:45.720564 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:52:45.736300 [info ] [MainThread]: 
[0m17:52:45.737144 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:52:45.737144 [info ] [Thread-1 (]: 1 of 9 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m17:52:45.737144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m17:52:45.746118 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:52:45.759412 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:45.762224 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:52:45.808629 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:45.808629 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
  
   as (
    

WITH raw_data AS (
    SELECT
        TransactionID::string AS TransactionID,
        UserID::string AS UserID,
        TransactionDate::timestamp AS TransactionDate,
        TransactionAmount::float AS TransactionAmount,
        TransactionType::string AS TransactionType,
        MerchantID::string AS MerchantID,
        Currency::string AS Currency,
        TransactionStatus::string AS TransactionStatus,
        DeviceType::string AS DeviceType,
        IP_Address::string AS IP_Address,
        PaymentMethod::string AS PaymentMethod,
        LocationCoordinates::string AS LocationCoordinates,
        SuspiciousFlag::boolean AS SuspiciousFlag,
        IsFraud::boolean AS IsFraud,
        ReviewStatus::string AS ReviewStatus,
        AnomalyScore::float AS AnomalyScore,
        TransactionTime::string AS TransactionTime,
        Age::int AS Age,
        Gender::string AS Gender,
        AccountCreationDate::timestamp AS AccountCreationDate,
        Location::string AS Location,
        AccountStatus::string AS AccountStatus,
        DeviceID::string AS DeviceID,
        UserProfileCompleteness::float AS UserProfileCompleteness,
        PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging
    
        WHERE TransactionID::string > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical)
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data
  );
[0m17:52:45.809618 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:52:46.610087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m17:52:46.624522 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:46.624522 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:52:46.706751 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.087 seconds
[0m17:52:46.718873 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:46.718873 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
[0m17:52:46.802313 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.076 seconds
[0m17:52:46.813314 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:46.813314 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL"
[0m17:52:46.914316 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.100 seconds
[0m17:52:46.942871 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:46.942871 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:46.942871 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
-- back compat for old kwarg name
  
  begin;
[0m17:52:47.048812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m17:52:47.048812 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:47.048812 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","REVIEWSTATUS" = DBT_INTERNAL_SOURCE."REVIEWSTATUS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","TRANSACTIONTIME" = DBT_INTERNAL_SOURCE."TRANSACTIONTIME","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m17:52:48.424521 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.371 seconds
[0m17:52:48.424521 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:48.424521 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
COMMIT
[0m17:52:48.653715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m17:52:48.668734 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:52:48.669499 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:52:48.669499 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp cascade
[0m17:52:48.829913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m17:52:48.847100 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m17:52:49.008211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C5434640>]}
[0m17:52:49.023940 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[32mSUCCESS 0[0m in 3.27s]
[0m17:52:49.026956 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:52:49.028018 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m17:52:49.029049 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m17:52:49.029965 [info ] [Thread-2 (]: 2 of 9 START sql incremental model PUBLIC.si_devices_dimension ................. [RUN]
[0m17:52:49.031898 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.si_devices_dimension'
[0m17:52:49.030982 [info ] [Thread-1 (]: 3 of 9 START sql incremental model PUBLIC.si_transactions_fact ................. [RUN]
[0m17:52:49.033339 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_devices_dimension
[0m17:52:49.034396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.br_fraud_detection_raw_data_historical, now model.my_fraud_detection_project.si_transactions_fact)
[0m17:52:49.036716 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:52:49.036716 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.si_transactions_fact
[0m17:52:49.046752 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:49.048768 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_devices_dimension
[0m17:52:49.070108 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.si_transactions_fact
[0m17:52:49.069764 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:52:49.076588 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:49.078384 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT *
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact)
    
)

SELECT DISTINCT
    TransactionID,
    UserID,
    TransactionDate,
    TransactionAmount,
    TransactionType,
    MerchantID,
    Currency,
    TransactionStatus,
    DeviceType,
    IP_Address,
    PaymentMethod,
    SuspiciousFlag,
    IsFraud,
    AnomalyScore,
    Age,
    Gender,
    AccountCreationDate,
    Location,
    LocationCoordinates,
    AccountStatus,
    DeviceID,
    UserProfileCompleteness,
    PreviousFraudAttempts
FROM transactions_fact
  );
[0m17:52:49.078384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:49.081898 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:52:49.081898 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension
         as
        (

WITH devices_dimension AS (
    SELECT
        DeviceID,
        FIRST_VALUE(DeviceType) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS DeviceType,
        FIRST_VALUE(IP_Address) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS IP_Address
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
)

SELECT DISTINCT * FROM devices_dimension
        );
[0m17:52:49.085450 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:52:50.283035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.203 seconds
[0m17:52:50.289894 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:50.289894 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:52:50.430542 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.147 seconds
[0m17:52:50.445651 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:50.445651 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
[0m17:52:50.494158 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.412 seconds
[0m17:52:50.494158 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m17:52:50.494158 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:52:50.494158 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp cascade
[0m17:52:50.509933 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.073 seconds
[0m17:52:50.525023 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:50.525023 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_TRANSACTIONS_FACT"
[0m17:52:50.572062 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m17:52:50.587630 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: Close
[0m17:52:50.606707 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.077 seconds
[0m17:52:50.613044 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:50.615928 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:50.617019 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
-- back compat for old kwarg name
  
  begin;
[0m17:52:50.706736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C55BE590>]}
[0m17:52:50.706736 [info ] [Thread-2 (]: 2 of 9 OK created sql incremental model PUBLIC.si_devices_dimension ............ [[32mSUCCESS 1[0m in 1.67s]
[0m17:52:50.709814 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m17:52:50.709814 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m17:52:50.709814 [info ] [Thread-2 (]: 4 of 9 START sql incremental model PUBLIC.si_users_dimension ................... [RUN]
[0m17:52:50.709814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_devices_dimension, now model.my_fraud_detection_project.si_users_dimension)
[0m17:52:50.709814 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_users_dimension
[0m17:52:50.709814 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:52:50.709814 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_users_dimension
[0m17:52:50.709814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m17:52:50.709814 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:52:50.709814 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:50.725447 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m17:52:50.729094 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:52:50.730944 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
create or replace transient table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension
         as
        (

WITH users_dimension AS (
    SELECT
        UserID,
        FIRST_VALUE(Age) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Age,
        FIRST_VALUE(Gender) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Gender,
        FIRST_VALUE(AccountCreationDate) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountCreationDate,
        FIRST_VALUE(AccountStatus) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountStatus,
        FIRST_VALUE(UserProfileCompleteness) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserProfileCompleteness,
        FIRST_VALUE(PreviousFraudAttempts) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS PreviousFraudAttempts,
        FIRST_VALUE(Location) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserLocation
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
)

SELECT DISTINCT * FROM users_dimension
        );
[0m17:52:50.732074 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:52:51.617420 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.891 seconds
[0m17:52:51.617420 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:51.617420 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
COMMIT
[0m17:52:51.845119 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.112 seconds
[0m17:52:51.854264 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m17:52:51.854264 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:52:51.854264 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp cascade
[0m17:52:51.854264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m17:52:51.870729 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:52:51.870729 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:52:51.870729 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp cascade
[0m17:52:51.919149 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m17:52:51.934121 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: Close
[0m17:52:51.965970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m17:52:51.981001 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: Close
[0m17:52:52.044851 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C56ABF70>]}
[0m17:52:52.044851 [info ] [Thread-2 (]: 4 of 9 OK created sql incremental model PUBLIC.si_users_dimension .............. [[32mSUCCESS 1[0m in 1.34s]
[0m17:52:52.044851 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m17:52:52.116817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C5482590>]}
[0m17:52:52.116817 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model PUBLIC.si_transactions_fact ............ [[32mSUCCESS 0[0m in 3.08s]
[0m17:52:52.116817 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m17:52:52.116817 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:52:52.116817 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:52:52.116817 [info ] [Thread-2 (]: 5 of 9 START sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics . [RUN]
[0m17:52:52.116817 [info ] [Thread-1 (]: 6 of 9 START sql incremental model PUBLIC.go_merchant_risk_assessment .......... [RUN]
[0m17:52:52.116817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_users_dimension, now model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics)
[0m17:52:52.132769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_transactions_fact, now model.my_fraud_detection_project.go_merchant_risk_assessment)
[0m17:52:52.133811 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:52:52.134989 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:52:52.137996 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:52:52.139742 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:52.139742 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:52:52.139742 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:52:52.139742 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:52:52.157481 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:52.158644 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp
  
   as (
    

WITH fraud_detection_dashboard_metrics AS (
    SELECT
        COUNT(TransactionID) AS total_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN 1 ELSE 0 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        COUNT(DISTINCT UserID) AS unique_users,
        COUNT(DISTINCT MerchantID) AS unique_merchants,
        AVG(AnomalyScore) AS avg_anomaly_score,
        MAX(TransactionDate) AS last_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
)

SELECT DISTINCT * FROM fraud_detection_dashboard_metrics
  );
[0m17:52:52.159376 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
  
   as (
    

WITH merchant_risk_assessment AS (
    SELECT
        MerchantID,
        COUNT(TransactionID) AS total_transactions,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        AVG(AnomalyScore) AS avg_anomaly_score,
        COUNT(DISTINCT UserID) AS unique_users
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY MerchantID
)

SELECT DISTINCT * FROM merchant_risk_assessment
  );
[0m17:52:52.160143 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:52:52.160143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.985856 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m17:52:52.988038 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:52:52.988038 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp
[0m17:52:53.029165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.876 seconds
[0m17:52:53.029165 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:53.044945 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m17:52:53.060893 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.082 seconds
[0m17:52:53.077060 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:52:53.077060 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics
[0m17:52:53.139974 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.104 seconds
[0m17:52:53.154486 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:53.154486 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
[0m17:52:53.171019 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.091 seconds
[0m17:52:53.171019 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:52:53.171019 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_FRAUD_DETECTION_DASHBOARD_METRICS"
[0m17:52:53.235404 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.092 seconds
[0m17:52:53.251694 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:53.257812 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.081 seconds
[0m17:52:53.258902 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_MERCHANT_RISK_ASSESSMENT"
[0m17:52:53.263904 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:52:53.268391 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:52:53.269389 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
-- back compat for old kwarg name
  
  begin;
[0m17:52:53.338844 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.088 seconds
[0m17:52:53.355585 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:53.355585 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:53.355585 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
-- back compat for old kwarg name
  
  begin;
[0m17:52:53.370768 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m17:52:53.370768 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:52:53.370768 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS","UNIQUE_MERCHANTS" = DBT_INTERNAL_SOURCE."UNIQUE_MERCHANTS","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE"
    

    when not matched then insert
        ("TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "UNIQUE_USERS", "UNIQUE_MERCHANTS", "AVG_ANOMALY_SCORE", "LAST_TRANSACTION_DATE")
    values
        ("TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "UNIQUE_USERS", "UNIQUE_MERCHANTS", "AVG_ANOMALY_SCORE", "LAST_TRANSACTION_DATE")

;
[0m17:52:53.451054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m17:52:53.451054 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:53.451054 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.MerchantID = DBT_INTERNAL_DEST.MerchantID
            )

    
    when matched then update set
        "MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS"
    

    when not matched then insert
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")
    values
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")

;
[0m17:52:53.513892 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b7e838-0001-b2a9-0000-98f10004b12e
[0m17:52:53.513892 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 16
invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
[0m17:52:53.513892 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: Close
[0m17:52:53.640475 [debug] [Thread-2 (]: Database Error in model go_fraud_detection_dashboard_metrics (my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:52:53.640475 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C5750DF0>]}
[0m17:52:53.640475 [error] [Thread-2 (]: 5 of 9 ERROR creating sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics  [[31mERROR[0m in 1.52s]
[0m17:52:53.640475 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:52:53.640475 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:52:53.640475 [info ] [Thread-2 (]: 7 of 9 START sql incremental model PUBLIC.go_real_time_fraud_detection ......... [RUN]
[0m17:52:53.640475 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics, now model.my_fraud_detection_project.go_real_time_fraud_detection)
[0m17:52:53.640475 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:52:53.640475 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:53.658246 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:52:53.665913 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:53.666946 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
  
   as (
    

WITH real_time_fraud_detection AS (
    SELECT
        TransactionID,
        TransactionDate,
        TransactionAmount,
        TransactionType,
        UserID,
        MerchantID,
        DeviceID,
        IP_Address,
        AnomalyScore,
        IsFraud,
        CASE
            WHEN AnomalyScore > 0.8 THEN 'High Risk'
            WHEN AnomalyScore > 0.5 THEN 'Moderate Risk'
            ELSE 'Low Risk'
        END AS fraud_risk_level
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    WHERE AnomalyScore > 0.5 OR IsFraud = 1
)

SELECT DISTINCT * FROM real_time_fraud_detection
  );
[0m17:52:53.667905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:52:54.278329 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.824 seconds
[0m17:52:54.278329 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:54.278329 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
COMMIT
[0m17:52:54.404882 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m17:52:54.404882 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:54.404882 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m17:52:54.515798 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.114 seconds
[0m17:52:54.531527 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:54.531527 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection
[0m17:52:54.531527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.248 seconds
[0m17:52:54.531527 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m17:52:54.531527 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:52:54.547157 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp cascade
[0m17:52:54.642243 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.104 seconds
[0m17:52:54.642243 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:54.642243 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_REAL_TIME_FRAUD_DETECTION"
[0m17:52:54.642243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m17:52:54.642243 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: Close
[0m17:52:54.769164 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.121 seconds
[0m17:52:54.769164 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:54.785178 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:54.787076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C564FE20>]}
[0m17:52:54.787076 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
-- back compat for old kwarg name
  
  begin;
[0m17:52:54.787076 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model PUBLIC.go_merchant_risk_assessment ..... [[32mSUCCESS 5[0m in 2.66s]
[0m17:52:54.787076 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:52:54.787076 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:52:54.787076 [info ] [Thread-1 (]: 8 of 9 START sql incremental model PUBLIC.go_user_behavior_metrics ............. [RUN]
[0m17:52:54.795540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_merchant_risk_assessment, now model.my_fraud_detection_project.go_user_behavior_metrics)
[0m17:52:54.795540 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:52:54.800145 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:54.803247 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:52:54.809214 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:54.809214 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
  
   as (
    

WITH user_behavior_metrics AS (
    SELECT
        UserID,
        COUNT(TransactionID) AS total_transactions,
        AVG(TransactionAmount) AS avg_transaction_amount,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        COUNT(DISTINCT DeviceID) AS unique_devices,
        MAX(TransactionDate) AS last_transaction_date,
        MIN(TransactionDate) AS first_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY UserID
)

SELECT DISTINCT * FROM user_behavior_metrics
  );
[0m17:52:54.810214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:54.902439 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m17:52:54.902439 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:54.902439 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","USERID" = DBT_INTERNAL_SOURCE."USERID","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","FRAUD_RISK_LEVEL" = DBT_INTERNAL_SOURCE."FRAUD_RISK_LEVEL"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")
    values
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")

;
[0m17:52:55.546327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m17:52:55.546327 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:55.546327 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m17:52:55.625971 [debug] [Thread-2 (]: SQL status: SUCCESS 732 in 0.723 seconds
[0m17:52:55.625971 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:55.625971 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
COMMIT
[0m17:52:55.656759 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.117 seconds
[0m17:52:55.672449 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:55.672449 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
[0m17:52:55.766987 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.091 seconds
[0m17:52:55.766987 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:55.766987 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_USER_BEHAVIOR_METRICS"
[0m17:52:55.835442 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m17:52:55.842425 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m17:52:55.844638 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:52:55.844638 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp cascade
[0m17:52:55.844638 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.077 seconds
[0m17:52:55.860340 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:55.860340 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:55.860340 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
-- back compat for old kwarg name
  
  begin;
[0m17:52:55.960905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m17:52:55.976312 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:55.976312 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."AVG_TRANSACTION_AMOUNT","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","UNIQUE_DEVICES" = DBT_INTERNAL_SOURCE."UNIQUE_DEVICES","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE","FIRST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."FIRST_TRANSACTION_DATE"
    

    when not matched then insert
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")
    values
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")

;
[0m17:52:55.976312 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m17:52:55.976312 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: Close
[0m17:52:56.104222 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C50435B0>]}
[0m17:52:56.104222 [info ] [Thread-2 (]: 7 of 9 OK created sql incremental model PUBLIC.go_real_time_fraud_detection .... [[32mSUCCESS 732[0m in 2.46s]
[0m17:52:56.104222 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:52:56.624756 [debug] [Thread-1 (]: SQL status: SUCCESS 990 in 0.654 seconds
[0m17:52:56.624756 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:56.624756 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
COMMIT
[0m17:52:56.864294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m17:52:56.879302 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m17:52:56.879302 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:52:56.879302 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp cascade
[0m17:52:56.987271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m17:52:56.987271 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: Close
[0m17:52:57.130596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C50497B0>]}
[0m17:52:57.130596 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model PUBLIC.go_user_behavior_metrics ........ [[32mSUCCESS 990[0m in 2.34s]
[0m17:52:57.130596 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:52:57.130596 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:52:57.130596 [info ] [Thread-2 (]: 9 of 9 START sql incremental model PUBLIC.go_predictive_model_features ......... [RUN]
[0m17:52:57.130596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_real_time_fraud_detection, now model.my_fraud_detection_project.go_predictive_model_features)
[0m17:52:57.130596 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_predictive_model_features
[0m17:52:57.130596 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:57.146252 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_predictive_model_features
[0m17:52:57.153732 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:57.153732 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
),
user_behavior_metrics AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
),
merchant_risk_assessment AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
)

SELECT
    tf.TransactionID,
    tf.TransactionAmount,
    tf.TransactionType,
    tf.AnomalyScore,
    ubm.total_transactions AS user_total_transactions,
    ubm.avg_transaction_amount AS user_avg_transaction_amount,
    ubm.total_fraud_transactions AS user_fraud_transactions,
    mra.total_fraud_transactions AS merchant_fraud_transactions,
    mra.avg_anomaly_score AS merchant_avg_anomaly_score,
    tf.IsFraud
FROM transactions_fact tf
JOIN user_behavior_metrics ubm ON tf.UserID = ubm.UserID
JOIN merchant_risk_assessment mra ON tf.MerchantID = mra.MerchantID

    WHERE tf.TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features)

  );
[0m17:52:57.153732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:52:58.040095 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.885 seconds
[0m17:52:58.047089 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:58.048087 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m17:52:58.160727 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.123 seconds
[0m17:52:58.176197 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:58.176197 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features
[0m17:52:58.255216 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.076 seconds
[0m17:52:58.255216 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:58.255216 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_PREDICTIVE_MODEL_FEATURES"
[0m17:52:58.351776 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.091 seconds
[0m17:52:58.351776 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:58.351776 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:58.351776 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
-- back compat for old kwarg name
  
  begin;
[0m17:52:58.464130 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m17:52:58.464130 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:58.464130 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","USER_TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_TOTAL_TRANSACTIONS","USER_AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."USER_AVG_TRANSACTION_AMOUNT","USER_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_FRAUD_TRANSACTIONS","MERCHANT_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."MERCHANT_FRAUD_TRANSACTIONS","MERCHANT_AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."MERCHANT_AVG_ANOMALY_SCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")
    values
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")

;
[0m17:52:59.291225 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.813 seconds
[0m17:52:59.293519 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:59.293830 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
COMMIT
[0m17:52:59.500264 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m17:52:59.512935 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m17:52:59.512935 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:52:59.512935 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp cascade
[0m17:52:59.625456 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m17:52:59.631079 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: Close
[0m17:52:59.744433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab3eb24c-ca23-465d-89f7-7d13bf710634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C55E9540>]}
[0m17:52:59.760191 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model PUBLIC.go_predictive_model_features .... [[32mSUCCESS 0[0m in 2.61s]
[0m17:52:59.760191 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:52:59.760191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:59.760191 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m17:52:59.760191 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m17:52:59.760191 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_user_behavior_metrics' was properly closed.
[0m17:52:59.760191 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_predictive_model_features' was properly closed.
[0m17:52:59.760191 [info ] [MainThread]: 
[0m17:52:59.760191 [info ] [MainThread]: Finished running 9 incremental models in 0 hours 0 minutes and 15.95 seconds (15.95s).
[0m17:52:59.774304 [debug] [MainThread]: Command end result
[0m17:52:59.805952 [info ] [MainThread]: 
[0m17:52:59.806945 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:52:59.807962 [info ] [MainThread]: 
[0m17:52:59.810946 [error] [MainThread]:   Database Error in model go_fraud_detection_dashboard_metrics (my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:52:59.811982 [info ] [MainThread]: 
[0m17:52:59.813988 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m17:52:59.816042 [debug] [MainThread]: Command `dbt run` failed at 17:52:59.816042 after 17.22 seconds
[0m17:52:59.817000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C06AC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C25F5D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C3E6E050>]}
[0m17:52:59.817993 [debug] [MainThread]: Flushing usage events
[0m17:54:43.691542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1718C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC19B55C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC19B55E40>]}


============================== 17:54:43.691542 | e2a798ab-fabc-4be9-b12e-80eb0f716f96 ==============================
[0m17:54:43.691542 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:54:43.691542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:54:44.157000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1A7B2D40>]}
[0m17:54:44.203452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1A7B3E20>]}
[0m17:54:44.203452 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:54:44.219001 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:54:44.388231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:54:44.388231 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:54:44.639506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1BBDA1A0>]}
[0m17:54:44.750127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1BBD9600>]}
[0m17:54:44.750127 [info ] [MainThread]: Found 9 models, 1 source, 454 macros
[0m17:54:44.750127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1BBD94E0>]}
[0m17:54:44.750127 [info ] [MainThread]: 
[0m17:54:44.750127 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:44.766668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m17:54:44.782482 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m17:54:44.783481 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m17:54:44.784482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:45.766947 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.996 seconds
[0m17:54:45.784232 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m17:54:45.944822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m17:54:45.959845 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m17:54:45.959845 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m17:54:45.959845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:46.766063 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.808 seconds
[0m17:54:46.766063 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m17:54:46.905189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC16FCBA30>]}
[0m17:54:46.905189 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:54:46.920656 [info ] [MainThread]: 
[0m17:54:46.920656 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:54:46.920656 [info ] [Thread-1 (]: 1 of 9 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m17:54:46.920656 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m17:54:46.929193 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:54:46.946715 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:46.949722 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:54:47.005658 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:47.006747 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
  
   as (
    

WITH raw_data AS (
    SELECT
        TransactionID::string AS TransactionID,
        UserID::string AS UserID,
        TransactionDate::timestamp AS TransactionDate,
        TransactionAmount::float AS TransactionAmount,
        TransactionType::string AS TransactionType,
        MerchantID::string AS MerchantID,
        Currency::string AS Currency,
        TransactionStatus::string AS TransactionStatus,
        DeviceType::string AS DeviceType,
        IP_Address::string AS IP_Address,
        PaymentMethod::string AS PaymentMethod,
        LocationCoordinates::string AS LocationCoordinates,
        SuspiciousFlag::boolean AS SuspiciousFlag,
        IsFraud::boolean AS IsFraud,
        ReviewStatus::string AS ReviewStatus,
        AnomalyScore::float AS AnomalyScore,
        TransactionTime::string AS TransactionTime,
        Age::int AS Age,
        Gender::string AS Gender,
        AccountCreationDate::timestamp AS AccountCreationDate,
        Location::string AS Location,
        AccountStatus::string AS AccountStatus,
        DeviceID::string AS DeviceID,
        UserProfileCompleteness::float AS UserProfileCompleteness,
        PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging
    
        WHERE TransactionID::string > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical)
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data
  );
[0m17:54:47.007748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:47.842426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.836 seconds
[0m17:54:47.845024 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:47.845024 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:54:47.942820 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.088 seconds
[0m17:54:47.942820 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:47.942820 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
[0m17:54:48.038559 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.088 seconds
[0m17:54:48.051858 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:48.052854 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL"
[0m17:54:48.117964 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.073 seconds
[0m17:54:48.148991 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:48.148991 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:48.148991 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:48.260935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m17:54:48.260935 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:48.260935 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","REVIEWSTATUS" = DBT_INTERNAL_SOURCE."REVIEWSTATUS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","TRANSACTIONTIME" = DBT_INTERNAL_SOURCE."TRANSACTIONTIME","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m17:54:49.207778 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.945 seconds
[0m17:54:49.207778 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:49.207778 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
COMMIT
[0m17:54:49.429912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m17:54:49.447491 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:54:49.447491 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:54:49.447491 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp cascade
[0m17:54:49.557937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m17:54:49.573574 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m17:54:49.717419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1A78E8F0>]}
[0m17:54:49.718121 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[32mSUCCESS 0[0m in 2.78s]
[0m17:54:49.718121 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:54:49.718121 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m17:54:49.718121 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m17:54:49.718121 [info ] [Thread-2 (]: 2 of 9 START sql incremental model PUBLIC.si_devices_dimension ................. [RUN]
[0m17:54:49.727209 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.si_devices_dimension'
[0m17:54:49.718121 [info ] [Thread-1 (]: 3 of 9 START sql incremental model PUBLIC.si_transactions_fact ................. [RUN]
[0m17:54:49.728219 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_devices_dimension
[0m17:54:49.729220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.br_fraud_detection_raw_data_historical, now model.my_fraud_detection_project.si_transactions_fact)
[0m17:54:49.734396 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:49.736489 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.si_transactions_fact
[0m17:54:49.742557 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:49.743586 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_devices_dimension
[0m17:54:49.748220 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:49.748220 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.si_transactions_fact
[0m17:54:49.748220 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
  
   as (
    

WITH devices_dimension AS (
    SELECT
        DeviceID,
        FIRST_VALUE(DeviceType) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS DeviceType,
        FIRST_VALUE(IP_Address) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS IP_Address
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE DeviceID > (SELECT MAX(DeviceID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension)
    
)

SELECT DISTINCT * FROM devices_dimension
  );
[0m17:54:49.758606 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:49.759717 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:54:49.760664 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT *
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact)
    
)

SELECT DISTINCT
    TransactionID,
    UserID,
    TransactionDate,
    TransactionAmount,
    TransactionType,
    MerchantID,
    Currency,
    TransactionStatus,
    DeviceType,
    IP_Address,
    PaymentMethod,
    SuspiciousFlag,
    IsFraud,
    AnomalyScore,
    Age,
    Gender,
    AccountCreationDate,
    Location,
    LocationCoordinates,
    AccountStatus,
    DeviceID,
    UserProfileCompleteness,
    PreviousFraudAttempts
FROM transactions_fact
  );
[0m17:54:49.761927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:50.606144 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m17:54:50.621882 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:50.621882 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m17:54:50.716760 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.086 seconds
[0m17:54:50.716760 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:50.716760 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension
[0m17:54:50.733193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m17:54:50.750714 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:50.750714 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:54:50.815461 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.092 seconds
[0m17:54:50.821612 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:50.822598 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_DEVICES_DIMENSION"
[0m17:54:50.835938 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.082 seconds
[0m17:54:50.838148 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:50.838148 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
[0m17:54:50.902213 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.080 seconds
[0m17:54:50.902213 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:50.902213 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.067 seconds
[0m17:54:50.917221 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:50.917221 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_TRANSACTIONS_FACT"
[0m17:54:50.917221 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:50.917221 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:50.981418 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.074 seconds
[0m17:54:50.996433 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:50.996433 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:50.996433 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:51.012187 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m17:54:51.012187 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:51.027789 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.DeviceID = DBT_INTERNAL_DEST.DeviceID
            )

    
    when matched then update set
        "DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS"
    

    when not matched then insert
        ("DEVICEID", "DEVICETYPE", "IP_ADDRESS")
    values
        ("DEVICEID", "DEVICETYPE", "IP_ADDRESS")

;
[0m17:54:51.091726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m17:54:51.091726 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:51.091726 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m17:54:51.776044 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.748 seconds
[0m17:54:51.778950 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:51.779995 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
COMMIT
[0m17:54:51.872532 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.780 seconds
[0m17:54:51.872532 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:51.872532 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
COMMIT
[0m17:54:51.983727 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m17:54:51.983727 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m17:54:51.983727 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:54:51.983727 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp cascade
[0m17:54:52.094705 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m17:54:52.110975 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: Close
[0m17:54:52.142383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m17:54:52.157419 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:54:52.157419 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:54:52.157419 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp cascade
[0m17:54:52.237517 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1C07CE80>]}
[0m17:54:52.237517 [info ] [Thread-2 (]: 2 of 9 OK created sql incremental model PUBLIC.si_devices_dimension ............ [[32mSUCCESS 0[0m in 2.52s]
[0m17:54:52.237517 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m17:54:52.237517 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m17:54:52.253358 [info ] [Thread-2 (]: 4 of 9 START sql incremental model PUBLIC.si_users_dimension ................... [RUN]
[0m17:54:52.254367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_devices_dimension, now model.my_fraud_detection_project.si_users_dimension)
[0m17:54:52.255525 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_users_dimension
[0m17:54:52.260884 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:52.260884 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_users_dimension
[0m17:54:52.260884 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:52.260884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m17:54:52.260884 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
  
   as (
    

WITH users_dimension AS (
    SELECT
        UserID,
        FIRST_VALUE(Age) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Age,
        FIRST_VALUE(Gender) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Gender,
        FIRST_VALUE(AccountCreationDate) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountCreationDate,
        FIRST_VALUE(AccountStatus) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountStatus,
        FIRST_VALUE(UserProfileCompleteness) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserProfileCompleteness,
        FIRST_VALUE(PreviousFraudAttempts) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS PreviousFraudAttempts,
        FIRST_VALUE(Location) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserLocation
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE UserID > (SELECT MAX(UserID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension)
    
)

SELECT DISTINCT * FROM users_dimension
  );
[0m17:54:52.260884 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: Close
[0m17:54:52.260884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:54:52.398762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1C07DB10>]}
[0m17:54:52.398762 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model PUBLIC.si_transactions_fact ............ [[32mSUCCESS 0[0m in 2.67s]
[0m17:54:52.398762 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m17:54:52.398762 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:54:52.398762 [info ] [Thread-1 (]: 5 of 9 START sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics . [RUN]
[0m17:54:52.398762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_transactions_fact, now model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics)
[0m17:54:52.398762 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:54:52.416805 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:54:52.417845 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:54:52.420062 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:54:52.420062 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp
  
   as (
    

WITH fraud_detection_dashboard_metrics AS (
    SELECT
        COUNT(TransactionID) AS total_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN 1 ELSE 0 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        COUNT(DISTINCT UserID) AS unique_users,
        COUNT(DISTINCT MerchantID) AS unique_merchants,
        AVG(AnomalyScore) AS avg_anomaly_score,
        MAX(TransactionDate) AS last_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact  -- Correct reference to your transactions fact table
)

SELECT DISTINCT * FROM fraud_detection_dashboard_metrics
  );
[0m17:54:52.420062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:53.144228 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.872 seconds
[0m17:54:53.144228 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:53.156261 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m17:54:53.194179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.771 seconds
[0m17:54:53.194179 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:54:53.194179 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp
[0m17:54:53.241019 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.091 seconds
[0m17:54:53.241019 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:53.241019 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension
[0m17:54:53.332474 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.126 seconds
[0m17:54:53.343490 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:54:53.344527 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics
[0m17:54:53.348447 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.095 seconds
[0m17:54:53.354445 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:53.356002 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_USERS_DIMENSION"
[0m17:54:53.427599 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.081 seconds
[0m17:54:53.427599 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.096 seconds
[0m17:54:53.443802 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:53.443802 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:54:53.443802 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_FRAUD_DETECTION_DASHBOARD_METRICS"
[0m17:54:53.458388 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:53.459586 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:53.538406 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.084 seconds
[0m17:54:53.538406 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:54:53.538406 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:54:53.538406 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:53.556513 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m17:54:53.556513 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:53.556513 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS","USERLOCATION" = DBT_INTERNAL_SOURCE."USERLOCATION"
    

    when not matched then insert
        ("USERID", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "ACCOUNTSTATUS", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS", "USERLOCATION")
    values
        ("USERID", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "ACCOUNTSTATUS", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS", "USERLOCATION")

;
[0m17:54:53.648534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m17:54:53.648534 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:54:53.648534 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS","UNIQUE_MERCHANTS" = DBT_INTERNAL_SOURCE."UNIQUE_MERCHANTS","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE"
    

    when not matched then insert
        ("TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "UNIQUE_USERS", "UNIQUE_MERCHANTS", "AVG_ANOMALY_SCORE", "LAST_TRANSACTION_DATE")
    values
        ("TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "UNIQUE_USERS", "UNIQUE_MERCHANTS", "AVG_ANOMALY_SCORE", "LAST_TRANSACTION_DATE")

;
[0m17:54:53.786166 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7e83a-0001-b2aa-0000-98f10004c17e
[0m17:54:53.787171 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 16
invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
[0m17:54:53.787171 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: Close
[0m17:54:53.916169 [debug] [Thread-1 (]: Database Error in model go_fraud_detection_dashboard_metrics (my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:54:53.916169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1C0FC370>]}
[0m17:54:53.916169 [error] [Thread-1 (]: 5 of 9 ERROR creating sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics  [[31mERROR[0m in 1.52s]
[0m17:54:53.916169 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:54:53.916169 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:54:53.916169 [info ] [Thread-1 (]: 6 of 9 START sql incremental model PUBLIC.go_merchant_risk_assessment .......... [RUN]
[0m17:54:53.916169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics, now model.my_fraud_detection_project.go_merchant_risk_assessment)
[0m17:54:53.916169 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:54:53.932838 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:53.934993 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:54:53.939566 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:53.939566 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
  
   as (
    

WITH merchant_risk_assessment AS (
    SELECT
        MerchantID,
        COUNT(TransactionID) AS total_transactions,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        AVG(AnomalyScore) AS avg_anomaly_score,
        COUNT(DISTINCT UserID) AS unique_users
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY MerchantID
)

SELECT DISTINCT * FROM merchant_risk_assessment
  );
[0m17:54:53.944480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:54.489791 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.940 seconds
[0m17:54:54.506700 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:54.506700 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
COMMIT
[0m17:54:54.632854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m17:54:54.632854 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:54.632854 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m17:54:54.712498 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m17:54:54.759275 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.120 seconds
[0m17:54:54.759275 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m17:54:54.759275 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:54.759275 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:54:54.759275 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
[0m17:54:54.775518 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp cascade
[0m17:54:54.844799 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.078 seconds
[0m17:54:54.859409 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:54.859409 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_MERCHANT_RISK_ASSESSMENT"
[0m17:54:54.929104 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m17:54:54.934098 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: Close
[0m17:54:54.947270 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.092 seconds
[0m17:54:54.947270 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:54.959778 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:54.960743 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:55.060013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m17:54:55.060013 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:55.060013 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.MerchantID = DBT_INTERNAL_DEST.MerchantID
            )

    
    when matched then update set
        "MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS"
    

    when not matched then insert
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")
    values
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")

;
[0m17:54:55.060013 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1C0693C0>]}
[0m17:54:55.060013 [info ] [Thread-2 (]: 4 of 9 OK created sql incremental model PUBLIC.si_users_dimension .............. [[32mSUCCESS 0[0m in 2.81s]
[0m17:54:55.060013 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m17:54:55.060013 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:54:55.060013 [info ] [Thread-2 (]: 7 of 9 START sql incremental model PUBLIC.go_real_time_fraud_detection ......... [RUN]
[0m17:54:55.073527 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_users_dimension, now model.my_fraud_detection_project.go_real_time_fraud_detection)
[0m17:54:55.074425 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:54:55.077638 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:55.078989 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:54:55.080513 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:55.087586 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
  
   as (
    

WITH real_time_fraud_detection AS (
    SELECT
        TransactionID,
        TransactionDate,
        TransactionAmount,
        TransactionType,
        UserID,
        MerchantID,
        DeviceID,
        IP_Address,
        AnomalyScore,
        IsFraud,
        CASE
            WHEN AnomalyScore > 0.8 THEN 'High Risk'
            WHEN AnomalyScore > 0.5 THEN 'Moderate Risk'
            ELSE 'Low Risk'
        END AS fraud_risk_level
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    WHERE AnomalyScore > 0.5 OR IsFraud = 1
)

SELECT DISTINCT * FROM real_time_fraud_detection
  );
[0m17:54:55.088595 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:54:55.664995 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.601 seconds
[0m17:54:55.664995 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:55.664995 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
COMMIT
[0m17:54:55.831204 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m17:54:55.831204 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:55.831204 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m17:54:55.877783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m17:54:55.894355 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m17:54:55.894355 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:54:55.894355 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp cascade
[0m17:54:55.926161 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.091 seconds
[0m17:54:55.942097 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:55.942097 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection
[0m17:54:56.010406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m17:54:56.010406 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: Close
[0m17:54:56.010406 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.078 seconds
[0m17:54:56.026026 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:56.026026 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_REAL_TIME_FRAUD_DETECTION"
[0m17:54:56.090270 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.072 seconds
[0m17:54:56.104872 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:56.104872 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:56.104872 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:56.152095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1C0FF9A0>]}
[0m17:54:56.152095 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model PUBLIC.go_merchant_risk_assessment ..... [[32mSUCCESS 5[0m in 2.24s]
[0m17:54:56.152095 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:54:56.152095 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:54:56.152095 [info ] [Thread-1 (]: 8 of 9 START sql incremental model PUBLIC.go_user_behavior_metrics ............. [RUN]
[0m17:54:56.162607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_merchant_risk_assessment, now model.my_fraud_detection_project.go_user_behavior_metrics)
[0m17:54:56.163917 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:54:56.169294 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:56.171162 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:54:56.177775 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:56.178684 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
  
   as (
    

WITH user_behavior_metrics AS (
    SELECT
        UserID,
        COUNT(TransactionID) AS total_transactions,
        AVG(TransactionAmount) AS avg_transaction_amount,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        COUNT(DISTINCT DeviceID) AS unique_devices,
        MAX(TransactionDate) AS last_transaction_date,
        MIN(TransactionDate) AS first_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY UserID
)

SELECT DISTINCT * FROM user_behavior_metrics
  );
[0m17:54:56.178684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:56.193478 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m17:54:56.193478 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:56.193478 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","USERID" = DBT_INTERNAL_SOURCE."USERID","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","FRAUD_RISK_LEVEL" = DBT_INTERNAL_SOURCE."FRAUD_RISK_LEVEL"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")
    values
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")

;
[0m17:54:56.947840 [debug] [Thread-2 (]: SQL status: SUCCESS 732 in 0.739 seconds
[0m17:54:56.947840 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:56.947840 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
COMMIT
[0m17:54:57.167090 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m17:54:57.167090 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m17:54:57.167090 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:54:57.167090 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp cascade
[0m17:54:57.183555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.012 seconds
[0m17:54:57.183555 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:57.183555 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m17:54:57.279212 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m17:54:57.296971 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: Close
[0m17:54:57.306392 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.111 seconds
[0m17:54:57.310390 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:57.311390 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
[0m17:54:57.384571 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.077 seconds
[0m17:54:57.384571 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:57.384571 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_USER_BEHAVIOR_METRICS"
[0m17:54:57.398221 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1BB2D660>]}
[0m17:54:57.398221 [info ] [Thread-2 (]: 7 of 9 OK created sql incremental model PUBLIC.go_real_time_fraud_detection .... [[32mSUCCESS 732[0m in 2.34s]
[0m17:54:57.398221 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:54:57.465373 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.075 seconds
[0m17:54:57.474484 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:57.475086 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:57.475086 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
-- back compat for old kwarg name
  
  begin;
[0m17:54:57.579953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m17:54:57.580953 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:57.581952 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."AVG_TRANSACTION_AMOUNT","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","UNIQUE_DEVICES" = DBT_INTERNAL_SOURCE."UNIQUE_DEVICES","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE","FIRST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."FIRST_TRANSACTION_DATE"
    

    when not matched then insert
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")
    values
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")

;
[0m17:54:58.246979 [debug] [Thread-1 (]: SQL status: SUCCESS 990 in 0.671 seconds
[0m17:54:58.246979 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:58.246979 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
COMMIT
[0m17:54:58.512328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m17:54:58.512328 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m17:54:58.512328 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:54:58.512328 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp cascade
[0m17:54:58.656798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m17:54:58.669314 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: Close
[0m17:54:58.799643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1C07C430>]}
[0m17:54:58.800645 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model PUBLIC.go_user_behavior_metrics ........ [[32mSUCCESS 990[0m in 2.64s]
[0m17:54:58.802554 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:54:58.803551 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:54:58.804611 [info ] [Thread-2 (]: 9 of 9 START sql incremental model PUBLIC.go_predictive_model_features ......... [RUN]
[0m17:54:58.805595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_real_time_fraud_detection, now model.my_fraud_detection_project.go_predictive_model_features)
[0m17:54:58.806561 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_predictive_model_features
[0m17:54:58.810643 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:54:58.811556 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_predictive_model_features
[0m17:54:58.818720 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:54:58.819733 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
),
user_behavior_metrics AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
),
merchant_risk_assessment AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
)

SELECT
    tf.TransactionID,
    tf.TransactionAmount,
    tf.TransactionType,
    tf.AnomalyScore,
    ubm.total_transactions AS user_total_transactions,
    ubm.avg_transaction_amount AS user_avg_transaction_amount,
    ubm.total_fraud_transactions AS user_fraud_transactions,
    mra.total_fraud_transactions AS merchant_fraud_transactions,
    mra.avg_anomaly_score AS merchant_avg_anomaly_score,
    tf.IsFraud
FROM transactions_fact tf
JOIN user_behavior_metrics ubm ON tf.UserID = ubm.UserID
JOIN merchant_risk_assessment mra ON tf.MerchantID = mra.MerchantID

    WHERE tf.TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features)

  );
[0m17:54:58.820730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:54:59.772468 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.953 seconds
[0m17:54:59.772468 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:54:59.772468 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m17:54:59.872608 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.105 seconds
[0m17:54:59.888335 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:54:59.888335 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features
[0m17:54:59.951476 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.073 seconds
[0m17:54:59.972952 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:54:59.972952 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_PREDICTIVE_MODEL_FEATURES"
[0m17:55:00.046944 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.073 seconds
[0m17:55:00.046944 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:55:00.046944 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:55:00.046944 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
-- back compat for old kwarg name
  
  begin;
[0m17:55:00.157256 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m17:55:00.157256 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:55:00.157256 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","USER_TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_TOTAL_TRANSACTIONS","USER_AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."USER_AVG_TRANSACTION_AMOUNT","USER_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_FRAUD_TRANSACTIONS","MERCHANT_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."MERCHANT_FRAUD_TRANSACTIONS","MERCHANT_AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."MERCHANT_AVG_ANOMALY_SCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")
    values
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")

;
[0m17:55:01.076358 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.918 seconds
[0m17:55:01.076358 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:55:01.076358 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
COMMIT
[0m17:55:01.291953 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m17:55:01.295946 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m17:55:01.297947 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:55:01.297947 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp cascade
[0m17:55:01.451683 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m17:55:01.451683 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: Close
[0m17:55:01.578385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2a798ab-fabc-4be9-b12e-80eb0f716f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1C0EBA60>]}
[0m17:55:01.578385 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model PUBLIC.go_predictive_model_features .... [[32mSUCCESS 0[0m in 2.77s]
[0m17:55:01.578385 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:55:01.578385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:01.578385 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m17:55:01.578385 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m17:55:01.578385 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_user_behavior_metrics' was properly closed.
[0m17:55:01.578385 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_predictive_model_features' was properly closed.
[0m17:55:01.578385 [info ] [MainThread]: 
[0m17:55:01.578385 [info ] [MainThread]: Finished running 9 incremental models in 0 hours 0 minutes and 16.83 seconds (16.83s).
[0m17:55:01.595311 [debug] [MainThread]: Command end result
[0m17:55:01.627215 [info ] [MainThread]: 
[0m17:55:01.627215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:01.627215 [info ] [MainThread]: 
[0m17:55:01.627215 [error] [MainThread]:   Database Error in model go_fraud_detection_dashboard_metrics (my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:55:01.627215 [info ] [MainThread]: 
[0m17:55:01.627215 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m17:55:01.637762 [debug] [MainThread]: Command `dbt run` failed at 17:55:01.637762 after 18.02 seconds
[0m17:55:01.638835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1718C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC190D5D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1BB218A0>]}
[0m17:55:01.638835 [debug] [MainThread]: Flushing usage events
[0m17:56:32.005411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC45CC340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC6F9DF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC6F9E110>]}


============================== 17:56:32.020917 | dd41f1bc-519e-4713-b991-2a050407b197 ==============================
[0m17:56:32.020917 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:56:32.020917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:56:32.513468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC7BF2D40>]}
[0m17:56:32.560827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC7BF3E20>]}
[0m17:56:32.560827 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:56:32.579927 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:56:32.745686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:32.745686 [debug] [MainThread]: Partial parsing: updated file: my_fraud_detection_project://my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:56:33.006095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC901A1A0>]}
[0m17:56:33.101532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC9019600>]}
[0m17:56:33.101532 [info ] [MainThread]: Found 9 models, 1 source, 454 macros
[0m17:56:33.116546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC90194E0>]}
[0m17:56:33.117338 [info ] [MainThread]: 
[0m17:56:33.117338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:56:33.117338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m17:56:33.139029 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m17:56:33.140331 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m17:56:33.141857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:34.097968 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.970 seconds
[0m17:56:34.114490 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m17:56:34.256764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m17:56:34.272509 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m17:56:34.272509 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m17:56:34.272509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:34.905929 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.635 seconds
[0m17:56:34.905929 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m17:56:35.062066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC440BA30>]}
[0m17:56:35.063075 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:56:35.064111 [info ] [MainThread]: 
[0m17:56:35.070340 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:56:35.071326 [info ] [Thread-1 (]: 1 of 9 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m17:56:35.072375 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m17:56:35.074274 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:56:35.088428 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:35.088428 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:56:35.139200 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:35.140196 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
  
   as (
    

WITH raw_data AS (
    SELECT
        TransactionID::string AS TransactionID,
        UserID::string AS UserID,
        TransactionDate::timestamp AS TransactionDate,
        TransactionAmount::float AS TransactionAmount,
        TransactionType::string AS TransactionType,
        MerchantID::string AS MerchantID,
        Currency::string AS Currency,
        TransactionStatus::string AS TransactionStatus,
        DeviceType::string AS DeviceType,
        IP_Address::string AS IP_Address,
        PaymentMethod::string AS PaymentMethod,
        LocationCoordinates::string AS LocationCoordinates,
        SuspiciousFlag::boolean AS SuspiciousFlag,
        IsFraud::boolean AS IsFraud,
        ReviewStatus::string AS ReviewStatus,
        AnomalyScore::float AS AnomalyScore,
        TransactionTime::string AS TransactionTime,
        Age::int AS Age,
        Gender::string AS Gender,
        AccountCreationDate::timestamp AS AccountCreationDate,
        Location::string AS Location,
        AccountStatus::string AS AccountStatus,
        DeviceID::string AS DeviceID,
        UserProfileCompleteness::float AS UserProfileCompleteness,
        PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging
    
        WHERE TransactionID::string > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical)
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data
  );
[0m17:56:35.141193 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:56:36.053051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m17:56:36.067585 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:36.067585 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:56:36.188363 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.120 seconds
[0m17:56:36.204664 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:36.204664 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
[0m17:56:36.288551 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.085 seconds
[0m17:56:36.305167 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:36.305167 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL"
[0m17:56:36.362075 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.069 seconds
[0m17:56:36.393318 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:36.393318 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:36.393318 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:36.504294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m17:56:36.504294 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:36.504294 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","REVIEWSTATUS" = DBT_INTERNAL_SOURCE."REVIEWSTATUS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","TRANSACTIONTIME" = DBT_INTERNAL_SOURCE."TRANSACTIONTIME","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m17:56:37.363747 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.857 seconds
[0m17:56:37.363747 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:37.363747 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
COMMIT
[0m17:56:37.570833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m17:56:37.570833 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m17:56:37.586641 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m17:56:37.586641 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp cascade
[0m17:56:37.696906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m17:56:37.718025 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m17:56:37.858066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC7BCE8F0>]}
[0m17:56:37.858066 [info ] [Thread-1 (]: 1 of 9 OK created sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[32mSUCCESS 0[0m in 2.79s]
[0m17:56:37.858066 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m17:56:37.858066 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m17:56:37.858066 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m17:56:37.858066 [info ] [Thread-2 (]: 2 of 9 START sql incremental model PUBLIC.si_devices_dimension ................. [RUN]
[0m17:56:37.858066 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.si_devices_dimension'
[0m17:56:37.858066 [info ] [Thread-1 (]: 3 of 9 START sql incremental model PUBLIC.si_transactions_fact ................. [RUN]
[0m17:56:37.858066 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_devices_dimension
[0m17:56:37.869764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.br_fraud_detection_raw_data_historical, now model.my_fraud_detection_project.si_transactions_fact)
[0m17:56:37.874779 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:37.875868 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.si_transactions_fact
[0m17:56:37.879879 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:37.881774 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_devices_dimension
[0m17:56:37.885775 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:37.886776 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
  
   as (
    

WITH devices_dimension AS (
    SELECT
        DeviceID,
        FIRST_VALUE(DeviceType) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS DeviceType,
        FIRST_VALUE(IP_Address) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS IP_Address
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE DeviceID > (SELECT MAX(DeviceID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension)
    
)

SELECT DISTINCT * FROM devices_dimension
  );
[0m17:56:37.887776 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:56:37.887776 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.si_transactions_fact
[0m17:56:37.895824 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:37.897745 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT *
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact)
    
)

SELECT DISTINCT
    TransactionID,
    UserID,
    TransactionDate,
    TransactionAmount,
    TransactionType,
    MerchantID,
    Currency,
    TransactionStatus,
    DeviceType,
    IP_Address,
    PaymentMethod,
    SuspiciousFlag,
    IsFraud,
    AnomalyScore,
    Age,
    Gender,
    AccountCreationDate,
    Location,
    LocationCoordinates,
    AccountStatus,
    DeviceID,
    UserProfileCompleteness,
    PreviousFraudAttempts
FROM transactions_fact
  );
[0m17:56:37.897745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:38.811872 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.925 seconds
[0m17:56:38.816964 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:38.817966 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m17:56:38.852023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.960 seconds
[0m17:56:38.861062 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:38.861062 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:56:38.899693 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.084 seconds
[0m17:56:38.899693 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:38.899693 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension
[0m17:56:38.948524 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.090 seconds
[0m17:56:38.963872 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:38.963872 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
[0m17:56:38.963872 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.070 seconds
[0m17:56:38.979610 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:38.979610 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_DEVICES_DIMENSION"
[0m17:56:39.043212 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.083 seconds
[0m17:56:39.043212 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.069 seconds
[0m17:56:39.061424 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:39.061424 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:39.061424 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_TRANSACTIONS_FACT"
[0m17:56:39.061424 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:39.061424 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:39.138702 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.078 seconds
[0m17:56:39.138702 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:39.154348 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:39.154348 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:39.170233 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m17:56:39.170233 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:39.170233 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.DeviceID = DBT_INTERNAL_DEST.DeviceID
            )

    
    when matched then update set
        "DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS"
    

    when not matched then insert
        ("DEVICEID", "DEVICETYPE", "IP_ADDRESS")
    values
        ("DEVICEID", "DEVICETYPE", "IP_ADDRESS")

;
[0m17:56:39.234379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m17:56:39.234379 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:39.234379 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m17:56:39.886572 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.709 seconds
[0m17:56:39.886572 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:39.886572 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
COMMIT
[0m17:56:39.998397 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.748 seconds
[0m17:56:39.999359 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:39.999359 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
COMMIT
[0m17:56:40.124813 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m17:56:40.124813 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m17:56:40.140291 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m17:56:40.140291 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp cascade
[0m17:56:40.203746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m17:56:40.203746 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m17:56:40.220315 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m17:56:40.220315 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp cascade
[0m17:56:40.301699 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m17:56:40.304698 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: Close
[0m17:56:40.336058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m17:56:40.336058 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: Close
[0m17:56:40.422680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC94B0130>]}
[0m17:56:40.422680 [info ] [Thread-2 (]: 2 of 9 OK created sql incremental model PUBLIC.si_devices_dimension ............ [[32mSUCCESS 0[0m in 2.56s]
[0m17:56:40.422680 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m17:56:40.422680 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m17:56:40.422680 [info ] [Thread-2 (]: 4 of 9 START sql incremental model PUBLIC.si_users_dimension ................... [RUN]
[0m17:56:40.422680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_devices_dimension, now model.my_fraud_detection_project.si_users_dimension)
[0m17:56:40.422680 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_users_dimension
[0m17:56:40.441217 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:40.442247 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_users_dimension
[0m17:56:40.449526 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:40.450540 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
  
   as (
    

WITH users_dimension AS (
    SELECT
        UserID,
        FIRST_VALUE(Age) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Age,
        FIRST_VALUE(Gender) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Gender,
        FIRST_VALUE(AccountCreationDate) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountCreationDate,
        FIRST_VALUE(AccountStatus) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountStatus,
        FIRST_VALUE(UserProfileCompleteness) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserProfileCompleteness,
        FIRST_VALUE(PreviousFraudAttempts) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS PreviousFraudAttempts,
        FIRST_VALUE(Location) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserLocation
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE UserID > (SELECT MAX(UserID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension)
    
)

SELECT DISTINCT * FROM users_dimension
  );
[0m17:56:40.451633 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:56:40.465334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC94B33D0>]}
[0m17:56:40.465334 [info ] [Thread-1 (]: 3 of 9 OK created sql incremental model PUBLIC.si_transactions_fact ............ [[32mSUCCESS 0[0m in 2.59s]
[0m17:56:40.465334 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m17:56:40.465334 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:56:40.465334 [info ] [Thread-1 (]: 5 of 9 START sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics . [RUN]
[0m17:56:40.465334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_transactions_fact, now model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics)
[0m17:56:40.465334 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:56:40.480378 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:56:40.481280 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:56:40.483461 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:56:40.483461 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp
  
   as (
    

WITH fraud_detection_dashboard_metrics AS (
    SELECT
        COUNT(TransactionID) AS total_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN 1 ELSE 0 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        COUNT(DISTINCT UserID) AS unique_users,
        COUNT(DISTINCT MerchantID) AS unique_merchants,
        AVG(AnomalyScore) AS avg_anomaly_score,
        MAX(TransactionDate) AS last_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact  -- Correctly referencing the transactions fact model
)

SELECT DISTINCT * FROM fraud_detection_dashboard_metrics
  );
[0m17:56:40.483461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:41.311786 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m17:56:41.314783 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:41.315708 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m17:56:41.334789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.846 seconds
[0m17:56:41.338792 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:56:41.338792 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp
[0m17:56:41.404522 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.094 seconds
[0m17:56:41.404522 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:41.404522 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension
[0m17:56:41.434126 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.095 seconds
[0m17:56:41.438304 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:56:41.438304 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics
[0m17:56:41.486604 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.082 seconds
[0m17:56:41.501610 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:41.501610 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_USERS_DIMENSION"
[0m17:56:41.518159 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.083 seconds
[0m17:56:41.518159 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:56:41.518159 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_FRAUD_DETECTION_DASHBOARD_METRICS"
[0m17:56:41.582282 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.082 seconds
[0m17:56:41.582282 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:41.582282 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:41.582282 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:41.598327 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.074 seconds
[0m17:56:41.598327 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:56:41.598327 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:56:41.598327 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:41.694724 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m17:56:41.694724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m17:56:41.694724 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:41.694724 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"
[0m17:56:41.709250 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS","USERLOCATION" = DBT_INTERNAL_SOURCE."USERLOCATION"
    

    when not matched then insert
        ("USERID", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "ACCOUNTSTATUS", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS", "USERLOCATION")
    values
        ("USERID", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "ACCOUNTSTATUS", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS", "USERLOCATION")

;
[0m17:56:41.709250 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_fraud_detection_dashboard_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS","UNIQUE_MERCHANTS" = DBT_INTERNAL_SOURCE."UNIQUE_MERCHANTS","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE"
    

    when not matched then insert
        ("TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "UNIQUE_USERS", "UNIQUE_MERCHANTS", "AVG_ANOMALY_SCORE", "LAST_TRANSACTION_DATE")
    values
        ("TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "UNIQUE_USERS", "UNIQUE_MERCHANTS", "AVG_ANOMALY_SCORE", "LAST_TRANSACTION_DATE")

;
[0m17:56:41.871680 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7e83c-0001-b2aa-0000-98f10004c1f2
[0m17:56:41.871680 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 16
invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
[0m17:56:41.871680 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics: Close
[0m17:56:41.991388 [debug] [Thread-1 (]: Database Error in model go_fraud_detection_dashboard_metrics (my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:56:41.991388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC950B7C0>]}
[0m17:56:41.991388 [error] [Thread-1 (]: 5 of 9 ERROR creating sql incremental model PUBLIC.go_fraud_detection_dashboard_metrics  [[31mERROR[0m in 1.53s]
[0m17:56:41.991388 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics
[0m17:56:41.991388 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:56:41.991388 [info ] [Thread-1 (]: 6 of 9 START sql incremental model PUBLIC.go_merchant_risk_assessment .......... [RUN]
[0m17:56:41.991388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_fraud_detection_dashboard_metrics, now model.my_fraud_detection_project.go_merchant_risk_assessment)
[0m17:56:41.991388 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:56:42.009162 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:42.010836 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:56:42.013397 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:42.013397 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
  
   as (
    

WITH merchant_risk_assessment AS (
    SELECT
        MerchantID,
        COUNT(TransactionID) AS total_transactions,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        AVG(AnomalyScore) AS avg_anomaly_score,
        COUNT(DISTINCT UserID) AS unique_users
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY MerchantID
)

SELECT DISTINCT * FROM merchant_risk_assessment
  );
[0m17:56:42.013397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:42.480837 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.767 seconds
[0m17:56:42.480837 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:42.481946 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
COMMIT
[0m17:56:42.722204 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m17:56:42.722204 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m17:56:42.722204 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m17:56:42.722204 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp cascade
[0m17:56:42.754620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m17:56:42.805731 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:42.806731 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m17:56:42.843191 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m17:56:42.843191 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: Close
[0m17:56:42.907792 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.108 seconds
[0m17:56:42.922896 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:42.922896 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
[0m17:56:43.005694 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.080 seconds
[0m17:56:43.012696 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:43.013705 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC95A7D90>]}
[0m17:56:43.014605 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_MERCHANT_RISK_ASSESSMENT"
[0m17:56:43.015603 [info ] [Thread-2 (]: 4 of 9 OK created sql incremental model PUBLIC.si_users_dimension .............. [[32mSUCCESS 0[0m in 2.59s]
[0m17:56:43.017616 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m17:56:43.019619 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:56:43.020604 [info ] [Thread-2 (]: 7 of 9 START sql incremental model PUBLIC.go_real_time_fraud_detection ......... [RUN]
[0m17:56:43.022047 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_users_dimension, now model.my_fraud_detection_project.go_real_time_fraud_detection)
[0m17:56:43.022545 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:56:43.025647 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:43.027628 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:56:43.027628 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:43.027628 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
  
   as (
    

WITH real_time_fraud_detection AS (
    SELECT
        TransactionID,
        TransactionDate,
        TransactionAmount,
        TransactionType,
        UserID,
        MerchantID,
        DeviceID,
        IP_Address,
        AnomalyScore,
        IsFraud,
        CASE
            WHEN AnomalyScore > 0.8 THEN 'High Risk'
            WHEN AnomalyScore > 0.5 THEN 'Moderate Risk'
            ELSE 'Low Risk'
        END AS fraud_risk_level
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    WHERE AnomalyScore > 0.5 OR IsFraud = 1
)

SELECT DISTINCT * FROM real_time_fraud_detection
  );
[0m17:56:43.027628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:56:43.088964 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.082 seconds
[0m17:56:43.088964 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:43.104625 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:43.104625 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:43.210261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m17:56:43.210924 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:43.210924 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.MerchantID = DBT_INTERNAL_DEST.MerchantID
            )

    
    when matched then update set
        "MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS"
    

    when not matched then insert
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")
    values
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")

;
[0m17:56:43.809333 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m17:56:43.815300 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:43.816222 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m17:56:43.831429 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.619 seconds
[0m17:56:43.831429 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:43.832338 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
COMMIT
[0m17:56:43.940794 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.137 seconds
[0m17:56:43.958121 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:43.958121 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection
[0m17:56:44.021109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m17:56:44.021109 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m17:56:44.035725 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m17:56:44.036541 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp cascade
[0m17:56:44.036541 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.078 seconds
[0m17:56:44.036541 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:44.036541 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_REAL_TIME_FRAUD_DETECTION"
[0m17:56:44.117817 [debug] [Thread-2 (]: SQL status: SUCCESS 11 in 0.072 seconds
[0m17:56:44.117817 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:44.117817 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:44.117817 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:44.164343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m17:56:44.176955 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: Close
[0m17:56:44.229227 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m17:56:44.229227 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:44.229227 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","USERID" = DBT_INTERNAL_SOURCE."USERID","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","FRAUD_RISK_LEVEL" = DBT_INTERNAL_SOURCE."FRAUD_RISK_LEVEL"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")
    values
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")

;
[0m17:56:44.312565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC8F62B90>]}
[0m17:56:44.314569 [info ] [Thread-1 (]: 6 of 9 OK created sql incremental model PUBLIC.go_merchant_risk_assessment ..... [[32mSUCCESS 5[0m in 2.32s]
[0m17:56:44.316601 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m17:56:44.317593 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:56:44.318599 [info ] [Thread-1 (]: 8 of 9 START sql incremental model PUBLIC.go_user_behavior_metrics ............. [RUN]
[0m17:56:44.320561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_merchant_risk_assessment, now model.my_fraud_detection_project.go_user_behavior_metrics)
[0m17:56:44.320561 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:56:44.324642 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:44.325643 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:56:44.326660 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:44.326660 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
  
   as (
    

WITH user_behavior_metrics AS (
    SELECT
        UserID,
        COUNT(TransactionID) AS total_transactions,
        AVG(TransactionAmount) AS avg_transaction_amount,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        COUNT(DISTINCT DeviceID) AS unique_devices,
        MAX(TransactionDate) AS last_transaction_date,
        MIN(TransactionDate) AS first_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY UserID
)

SELECT DISTINCT * FROM user_behavior_metrics
  );
[0m17:56:44.326660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:44.875766 [debug] [Thread-2 (]: SQL status: SUCCESS 732 in 0.642 seconds
[0m17:56:44.878869 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:44.878869 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
COMMIT
[0m17:56:45.082471 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m17:56:45.082471 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m17:56:45.082471 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m17:56:45.082471 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp cascade
[0m17:56:45.212330 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m17:56:45.226943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.896 seconds
[0m17:56:45.228450 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: Close
[0m17:56:45.228450 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:45.228450 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m17:56:45.361703 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.122 seconds
[0m17:56:45.361703 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:45.361703 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
[0m17:56:45.361703 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC952CB80>]}
[0m17:56:45.361703 [info ] [Thread-2 (]: 7 of 9 OK created sql incremental model PUBLIC.go_real_time_fraud_detection .... [[32mSUCCESS 732[0m in 2.34s]
[0m17:56:45.376711 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m17:56:45.434223 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.071 seconds
[0m17:56:45.448378 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:45.449389 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_USER_BEHAVIOR_METRICS"
[0m17:56:45.525504 [debug] [Thread-1 (]: SQL status: SUCCESS 7 in 0.077 seconds
[0m17:56:45.525504 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:45.525504 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:45.525504 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:45.636705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m17:56:45.637188 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:45.637188 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."AVG_TRANSACTION_AMOUNT","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","UNIQUE_DEVICES" = DBT_INTERNAL_SOURCE."UNIQUE_DEVICES","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE","FIRST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."FIRST_TRANSACTION_DATE"
    

    when not matched then insert
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")
    values
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")

;
[0m17:56:46.362625 [debug] [Thread-1 (]: SQL status: SUCCESS 990 in 0.724 seconds
[0m17:56:46.363668 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:46.363668 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
COMMIT
[0m17:56:46.600002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.248 seconds
[0m17:56:46.616361 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m17:56:46.616361 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m17:56:46.616361 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp cascade
[0m17:56:46.763491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m17:56:46.763491 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: Close
[0m17:56:46.896568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC970BCA0>]}
[0m17:56:46.896568 [info ] [Thread-1 (]: 8 of 9 OK created sql incremental model PUBLIC.go_user_behavior_metrics ........ [[32mSUCCESS 990[0m in 2.58s]
[0m17:56:46.896568 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m17:56:46.896568 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:56:46.896568 [info ] [Thread-2 (]: 9 of 9 START sql incremental model PUBLIC.go_predictive_model_features ......... [RUN]
[0m17:56:46.896568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_real_time_fraud_detection, now model.my_fraud_detection_project.go_predictive_model_features)
[0m17:56:46.908808 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_predictive_model_features
[0m17:56:46.913351 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:46.913351 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_predictive_model_features
[0m17:56:46.913351 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:46.913351 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
),
user_behavior_metrics AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
),
merchant_risk_assessment AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
)

SELECT
    tf.TransactionID,
    tf.TransactionAmount,
    tf.TransactionType,
    tf.AnomalyScore,
    ubm.total_transactions AS user_total_transactions,
    ubm.avg_transaction_amount AS user_avg_transaction_amount,
    ubm.total_fraud_transactions AS user_fraud_transactions,
    mra.total_fraud_transactions AS merchant_fraud_transactions,
    mra.avg_anomaly_score AS merchant_avg_anomaly_score,
    tf.IsFraud
FROM transactions_fact tf
JOIN user_behavior_metrics ubm ON tf.UserID = ubm.UserID
JOIN merchant_risk_assessment mra ON tf.MerchantID = mra.MerchantID

    WHERE tf.TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features)

  );
[0m17:56:46.913351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:56:47.730241 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m17:56:47.746939 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:47.746939 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m17:56:47.853176 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.115 seconds
[0m17:56:47.866972 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:47.866972 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features
[0m17:56:47.947018 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.077 seconds
[0m17:56:47.947018 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:47.947018 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_PREDICTIVE_MODEL_FEATURES"
[0m17:56:48.026213 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.074 seconds
[0m17:56:48.026213 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:48.026213 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:48.026213 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
-- back compat for old kwarg name
  
  begin;
[0m17:56:48.137447 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m17:56:48.137447 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:48.137447 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","USER_TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_TOTAL_TRANSACTIONS","USER_AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."USER_AVG_TRANSACTION_AMOUNT","USER_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_FRAUD_TRANSACTIONS","MERCHANT_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."MERCHANT_FRAUD_TRANSACTIONS","MERCHANT_AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."MERCHANT_AVG_ANOMALY_SCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")
    values
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")

;
[0m17:56:48.989077 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.843 seconds
[0m17:56:48.989077 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:48.989077 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
COMMIT
[0m17:56:49.206602 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m17:56:49.222074 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m17:56:49.222074 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m17:56:49.222074 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp cascade
[0m17:56:49.339540 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m17:56:49.339540 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: Close
[0m17:56:49.474115 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd41f1bc-519e-4713-b991-2a050407b197', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC95F1E10>]}
[0m17:56:49.474115 [info ] [Thread-2 (]: 9 of 9 OK created sql incremental model PUBLIC.go_predictive_model_features .... [[32mSUCCESS 0[0m in 2.58s]
[0m17:56:49.474115 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m17:56:49.474115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:49.474115 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m17:56:49.474115 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m17:56:49.474115 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_user_behavior_metrics' was properly closed.
[0m17:56:49.474115 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_predictive_model_features' was properly closed.
[0m17:56:49.474115 [info ] [MainThread]: 
[0m17:56:49.474115 [info ] [MainThread]: Finished running 9 incremental models in 0 hours 0 minutes and 16.36 seconds (16.36s).
[0m17:56:49.491461 [debug] [MainThread]: Command end result
[0m17:56:49.521213 [info ] [MainThread]: 
[0m17:56:49.521213 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:56:49.521213 [info ] [MainThread]: 
[0m17:56:49.521213 [error] [MainThread]:   Database Error in model go_fraud_detection_dashboard_metrics (my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.TRANSACTIONID'
  compiled code at target\run\my_fraud_detection_project\my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m17:56:49.521213 [info ] [MainThread]: 
[0m17:56:49.521213 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m17:56:49.532882 [debug] [MainThread]: Command `dbt run` failed at 17:56:49.532882 after 17.59 seconds
[0m17:56:49.532882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC45CC340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC97122C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CC9713760>]}
[0m17:56:49.533908 [debug] [MainThread]: Flushing usage events
[0m18:01:16.897600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D195FC370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1BFC5C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1BFC5E10>]}


============================== 18:01:16.913235 | ac996e1b-94ff-4b87-ab32-b0b46cafcf7e ==============================
[0m18:01:16.913235 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:01:16.913235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:19.646173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D198917B0>]}
[0m18:01:19.693721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1BF890C0>]}
[0m18:01:19.693721 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:01:19.716090 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:01:20.709621 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m18:01:20.709621 [debug] [MainThread]: Partial parsing: deleted file: my_fraud_detection_project://my_fraud_detection_project/models\gold\go_fraud_detection_dashboard_metrics.sql
[0m18:01:20.769514 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_fraud_detection_project.gold.go_fraud_detection_dashboard_metrics
[0m18:01:20.798086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1DFC4130>]}
[0m18:01:20.965219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1CC251B0>]}
[0m18:01:20.965219 [info ] [MainThread]: Found 8 models, 1 source, 454 macros
[0m18:01:20.965219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1BB45420>]}
[0m18:01:20.965219 [info ] [MainThread]: 
[0m18:01:20.965219 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:20.965219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m18:01:20.995772 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m18:01:20.995772 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m18:01:20.995772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:21.824595 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.826 seconds
[0m18:01:21.826599 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m18:01:21.934003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m18:01:21.953159 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m18:01:21.953159 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m18:01:21.953159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:22.736061 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.783 seconds
[0m18:01:22.736061 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m18:01:22.866328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1943B9D0>]}
[0m18:01:22.866328 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:01:22.866328 [info ] [MainThread]: 
[0m18:01:22.882443 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:01:22.882443 [info ] [Thread-1 (]: 1 of 8 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m18:01:22.886736 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m18:01:22.887283 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:01:22.903287 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:22.904489 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:01:22.936753 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:22.953218 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
  
   as (
    

WITH raw_data AS (
    SELECT
        TransactionID::string AS TransactionID,
        UserID::string AS UserID,
        TransactionDate::timestamp AS TransactionDate,
        TransactionAmount::float AS TransactionAmount,
        TransactionType::string AS TransactionType,
        MerchantID::string AS MerchantID,
        Currency::string AS Currency,
        TransactionStatus::string AS TransactionStatus,
        DeviceType::string AS DeviceType,
        IP_Address::string AS IP_Address,
        PaymentMethod::string AS PaymentMethod,
        LocationCoordinates::string AS LocationCoordinates,
        SuspiciousFlag::boolean AS SuspiciousFlag,
        IsFraud::boolean AS IsFraud,
        ReviewStatus::string AS ReviewStatus,
        AnomalyScore::float AS AnomalyScore,
        TransactionTime::string AS TransactionTime,
        Age::int AS Age,
        Gender::string AS Gender,
        AccountCreationDate::timestamp AS AccountCreationDate,
        Location::string AS Location,
        AccountStatus::string AS AccountStatus,
        DeviceID::string AS DeviceID,
        UserProfileCompleteness::float AS UserProfileCompleteness,
        PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging
    
        WHERE TransactionID::string > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical)
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data
  );
[0m18:01:22.953218 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:23.699082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m18:01:23.706197 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:23.706197 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m18:01:23.805019 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.096 seconds
[0m18:01:23.811641 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:23.812640 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
[0m18:01:23.878054 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.067 seconds
[0m18:01:23.878054 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:23.878054 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL"
[0m18:01:23.957551 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.070 seconds
[0m18:01:23.977601 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:23.993935 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:23.993935 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
-- back compat for old kwarg name
  
  begin;
[0m18:01:24.095578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m18:01:24.098501 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:24.098501 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","REVIEWSTATUS" = DBT_INTERNAL_SOURCE."REVIEWSTATUS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","TRANSACTIONTIME" = DBT_INTERNAL_SOURCE."TRANSACTIONTIME","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m18:01:25.008929 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.912 seconds
[0m18:01:25.008929 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:25.008929 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
COMMIT
[0m18:01:25.182609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m18:01:25.182609 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m18:01:25.198337 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:01:25.198337 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp cascade
[0m18:01:25.280183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m18:01:25.319030 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m18:01:25.424921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1CBFE920>]}
[0m18:01:25.435959 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[32mSUCCESS 0[0m in 2.54s]
[0m18:01:25.435959 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:01:25.435959 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m18:01:25.435959 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m18:01:25.435959 [info ] [Thread-2 (]: 2 of 8 START sql incremental model PUBLIC.si_devices_dimension ................. [RUN]
[0m18:01:25.435959 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.si_devices_dimension'
[0m18:01:25.435959 [info ] [Thread-1 (]: 3 of 8 START sql incremental model PUBLIC.si_transactions_fact ................. [RUN]
[0m18:01:25.443436 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_devices_dimension
[0m18:01:25.443856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.br_fraud_detection_raw_data_historical, now model.my_fraud_detection_project.si_transactions_fact)
[0m18:01:25.449173 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:25.449173 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.si_transactions_fact
[0m18:01:25.449173 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:25.449173 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_devices_dimension
[0m18:01:25.463099 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.si_transactions_fact
[0m18:01:25.465696 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:25.469743 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:25.469743 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
  
   as (
    

WITH devices_dimension AS (
    SELECT
        DeviceID,
        FIRST_VALUE(DeviceType) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS DeviceType,
        FIRST_VALUE(IP_Address) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS IP_Address
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE DeviceID > (SELECT MAX(DeviceID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension)
    
)

SELECT DISTINCT * FROM devices_dimension
  );
[0m18:01:25.469743 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT *
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact)
    
)

SELECT DISTINCT
    TransactionID,
    UserID,
    TransactionDate,
    TransactionAmount,
    TransactionType,
    MerchantID,
    Currency,
    TransactionStatus,
    DeviceType,
    IP_Address,
    PaymentMethod,
    SuspiciousFlag,
    IsFraud,
    AnomalyScore,
    Age,
    Gender,
    AccountCreationDate,
    Location,
    LocationCoordinates,
    AccountStatus,
    DeviceID,
    UserProfileCompleteness,
    PreviousFraudAttempts
FROM transactions_fact
  );
[0m18:01:25.469743 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:01:25.469743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:26.283409 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m18:01:26.283409 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:26.283409 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m18:01:26.363976 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.080 seconds
[0m18:01:26.363976 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:26.363976 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension
[0m18:01:26.424704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.964 seconds
[0m18:01:26.440358 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:26.443841 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.072 seconds
[0m18:01:26.443841 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m18:01:26.443841 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:26.443841 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_DEVICES_DIMENSION"
[0m18:01:26.523664 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.071 seconds
[0m18:01:26.525513 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:26.525513 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:26.525513 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
-- back compat for old kwarg name
  
  begin;
[0m18:01:26.544623 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.097 seconds
[0m18:01:26.544623 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:26.544623 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
[0m18:01:26.620339 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m18:01:26.625100 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:26.625100 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.DeviceID = DBT_INTERNAL_DEST.DeviceID
            )

    
    when matched then update set
        "DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS"
    

    when not matched then insert
        ("DEVICEID", "DEVICETYPE", "IP_ADDRESS")
    values
        ("DEVICEID", "DEVICETYPE", "IP_ADDRESS")

;
[0m18:01:26.625100 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.083 seconds
[0m18:01:26.641049 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:26.641049 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_TRANSACTIONS_FACT"
[0m18:01:26.720158 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.077 seconds
[0m18:01:26.725418 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:26.725418 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:26.725418 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
-- back compat for old kwarg name
  
  begin;
[0m18:01:26.828258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m18:01:26.830271 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:26.831264 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m18:01:27.441144 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.817 seconds
[0m18:01:27.441144 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:27.441144 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
COMMIT
[0m18:01:27.569288 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.737 seconds
[0m18:01:27.571172 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:27.571172 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
COMMIT
[0m18:01:27.606831 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m18:01:27.614939 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m18:01:27.614939 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:01:27.614939 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp cascade
[0m18:01:27.715347 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m18:01:27.718969 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: Close
[0m18:01:27.735478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.166 seconds
[0m18:01:27.735478 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m18:01:27.750490 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:01:27.751326 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp cascade
[0m18:01:27.827399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1E4215A0>]}
[0m18:01:27.827399 [info ] [Thread-2 (]: 2 of 8 OK created sql incremental model PUBLIC.si_devices_dimension ............ [[32mSUCCESS 0[0m in 2.39s]
[0m18:01:27.827399 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m18:01:27.827399 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m18:01:27.827399 [info ] [Thread-2 (]: 4 of 8 START sql incremental model PUBLIC.si_users_dimension ................... [RUN]
[0m18:01:27.842448 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_devices_dimension, now model.my_fraud_detection_project.si_users_dimension)
[0m18:01:27.843501 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_users_dimension
[0m18:01:27.847819 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:27.848386 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_users_dimension
[0m18:01:27.848386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m18:01:27.848386 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:27.848386 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: Close
[0m18:01:27.848386 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
  
   as (
    

WITH users_dimension AS (
    SELECT
        UserID,
        FIRST_VALUE(Age) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Age,
        FIRST_VALUE(Gender) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Gender,
        FIRST_VALUE(AccountCreationDate) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountCreationDate,
        FIRST_VALUE(AccountStatus) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountStatus,
        FIRST_VALUE(UserProfileCompleteness) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserProfileCompleteness,
        FIRST_VALUE(PreviousFraudAttempts) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS PreviousFraudAttempts,
        FIRST_VALUE(Location) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserLocation
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE UserID > (SELECT MAX(UserID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension)
    
)

SELECT DISTINCT * FROM users_dimension
  );
[0m18:01:27.848386 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:27.985260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1E260D00>]}
[0m18:01:27.987248 [info ] [Thread-1 (]: 3 of 8 OK created sql incremental model PUBLIC.si_transactions_fact ............ [[32mSUCCESS 0[0m in 2.54s]
[0m18:01:27.988289 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m18:01:27.989250 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:01:27.990251 [info ] [Thread-1 (]: 5 of 8 START sql incremental model PUBLIC.go_merchant_risk_assessment .......... [RUN]
[0m18:01:27.991249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_transactions_fact, now model.my_fraud_detection_project.go_merchant_risk_assessment)
[0m18:01:27.992269 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:01:27.997337 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:27.999249 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:01:28.004849 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:28.004849 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
  
   as (
    

WITH merchant_risk_assessment AS (
    SELECT
        MerchantID,
        COUNT(TransactionID) AS total_transactions,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        AVG(AnomalyScore) AS avg_anomaly_score,
        COUNT(DISTINCT UserID) AS unique_users
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY MerchantID
)

SELECT DISTINCT * FROM merchant_risk_assessment
  );
[0m18:01:28.008558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:28.549241 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.687 seconds
[0m18:01:28.549241 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:28.549241 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m18:01:28.632938 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.083 seconds
[0m18:01:28.650359 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:28.650359 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension
[0m18:01:28.710727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m18:01:28.717330 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.067 seconds
[0m18:01:28.717330 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:28.729769 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:28.729769 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m18:01:28.729769 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_USERS_DIMENSION"
[0m18:01:28.835813 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.103 seconds
[0m18:01:28.839812 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:28.840833 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
[0m18:01:28.850784 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.120 seconds
[0m18:01:28.850784 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:28.850784 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:28.850784 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
-- back compat for old kwarg name
  
  begin;
[0m18:01:28.917860 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.085 seconds
[0m18:01:28.930441 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:28.930441 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_MERCHANT_RISK_ASSESSMENT"
[0m18:01:28.930441 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m18:01:28.930441 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:28.930441 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS","USERLOCATION" = DBT_INTERNAL_SOURCE."USERLOCATION"
    

    when not matched then insert
        ("USERID", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "ACCOUNTSTATUS", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS", "USERLOCATION")
    values
        ("USERID", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "ACCOUNTSTATUS", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS", "USERLOCATION")

;
[0m18:01:29.011034 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.080 seconds
[0m18:01:29.011034 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:29.018042 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:29.018042 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
-- back compat for old kwarg name
  
  begin;
[0m18:01:29.118466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m18:01:29.118466 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:29.118466 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.MerchantID = DBT_INTERNAL_DEST.MerchantID
            )

    
    when matched then update set
        "MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS"
    

    when not matched then insert
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")
    values
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")

;
[0m18:01:29.656260 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.531 seconds
[0m18:01:29.656260 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:29.656260 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
COMMIT
[0m18:01:29.728395 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.792 seconds
[0m18:01:29.728395 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:29.728395 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
COMMIT
[0m18:01:29.896197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m18:01:29.896197 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m18:01:29.896197 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:01:29.896197 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp cascade
[0m18:01:29.959210 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.234 seconds
[0m18:01:29.974854 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m18:01:29.974854 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:01:29.974854 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp cascade
[0m18:01:29.991703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m18:01:30.006807 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: Close
[0m18:01:30.085634 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m18:01:30.085634 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: Close
[0m18:01:30.132816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1E459DE0>]}
[0m18:01:30.132816 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model PUBLIC.go_merchant_risk_assessment ..... [[32mSUCCESS 5[0m in 2.14s]
[0m18:01:30.132816 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:01:30.132816 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:01:30.132816 [info ] [Thread-1 (]: 6 of 8 START sql incremental model PUBLIC.go_real_time_fraud_detection ......... [RUN]
[0m18:01:30.132816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_merchant_risk_assessment, now model.my_fraud_detection_project.go_real_time_fraud_detection)
[0m18:01:30.132816 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:01:30.132816 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:30.148539 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:01:30.153994 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:30.154440 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
  
   as (
    

WITH real_time_fraud_detection AS (
    SELECT
        TransactionID,
        TransactionDate,
        TransactionAmount,
        TransactionType,
        UserID,
        MerchantID,
        DeviceID,
        IP_Address,
        AnomalyScore,
        IsFraud,
        CASE
            WHEN AnomalyScore > 0.8 THEN 'High Risk'
            WHEN AnomalyScore > 0.5 THEN 'Moderate Risk'
            ELSE 'Low Risk'
        END AS fraud_risk_level
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    WHERE AnomalyScore > 0.5 OR IsFraud = 1
)

SELECT DISTINCT * FROM real_time_fraud_detection
  );
[0m18:01:30.154440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:30.228961 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1E3A5DE0>]}
[0m18:01:30.228961 [info ] [Thread-2 (]: 4 of 8 OK created sql incremental model PUBLIC.si_users_dimension .............. [[32mSUCCESS 0[0m in 2.39s]
[0m18:01:30.228961 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m18:01:30.236584 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:01:30.236584 [info ] [Thread-2 (]: 7 of 8 START sql incremental model PUBLIC.go_user_behavior_metrics ............. [RUN]
[0m18:01:30.239307 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_users_dimension, now model.my_fraud_detection_project.go_user_behavior_metrics)
[0m18:01:30.240860 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:01:30.244964 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:30.246156 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:01:30.246156 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:30.246156 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
  
   as (
    

WITH user_behavior_metrics AS (
    SELECT
        UserID,
        COUNT(TransactionID) AS total_transactions,
        AVG(TransactionAmount) AS avg_transaction_amount,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        COUNT(DISTINCT DeviceID) AS unique_devices,
        MAX(TransactionDate) AS last_transaction_date,
        MIN(TransactionDate) AS first_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY UserID
)

SELECT DISTINCT * FROM user_behavior_metrics
  );
[0m18:01:30.246156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:30.977760 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m18:01:30.977760 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:30.977760 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m18:01:31.016303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m18:01:31.022911 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:31.022911 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m18:01:31.072920 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.087 seconds
[0m18:01:31.076093 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:31.076093 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
[0m18:01:31.123094 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.098 seconds
[0m18:01:31.123094 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:31.123094 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection
[0m18:01:31.155617 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.088 seconds
[0m18:01:31.172170 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:31.172170 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_USER_BEHAVIOR_METRICS"
[0m18:01:31.216466 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.086 seconds
[0m18:01:31.223072 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:31.223072 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_REAL_TIME_FRAUD_DETECTION"
[0m18:01:31.237332 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.064 seconds
[0m18:01:31.237332 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:31.237332 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:31.237332 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
-- back compat for old kwarg name
  
  begin;
[0m18:01:31.327780 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.103 seconds
[0m18:01:31.333779 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:31.336804 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:31.336804 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
-- back compat for old kwarg name
  
  begin;
[0m18:01:31.374556 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m18:01:31.377121 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:31.379260 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."AVG_TRANSACTION_AMOUNT","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","UNIQUE_DEVICES" = DBT_INTERNAL_SOURCE."UNIQUE_DEVICES","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE","FIRST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."FIRST_TRANSACTION_DATE"
    

    when not matched then insert
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")
    values
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")

;
[0m18:01:31.431876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m18:01:31.431876 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:31.436082 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","USERID" = DBT_INTERNAL_SOURCE."USERID","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","FRAUD_RISK_LEVEL" = DBT_INTERNAL_SOURCE."FRAUD_RISK_LEVEL"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")
    values
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")

;
[0m18:01:32.059630 [debug] [Thread-2 (]: SQL status: SUCCESS 990 in 0.685 seconds
[0m18:01:32.059630 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:32.059630 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
COMMIT
[0m18:01:32.075263 [debug] [Thread-1 (]: SQL status: SUCCESS 732 in 0.653 seconds
[0m18:01:32.091461 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:32.091461 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
COMMIT
[0m18:01:32.265278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m18:01:32.265278 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m18:01:32.265278 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:01:32.265278 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp cascade
[0m18:01:32.298602 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m18:01:32.302719 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m18:01:32.303620 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:01:32.304667 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp cascade
[0m18:01:32.373315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m18:01:32.388951 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: Close
[0m18:01:32.388951 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m18:01:32.388951 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: Close
[0m18:01:32.503309 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1E4BE320>]}
[0m18:01:32.512575 [info ] [Thread-2 (]: 7 of 8 OK created sql incremental model PUBLIC.go_user_behavior_metrics ........ [[32mSUCCESS 990[0m in 2.26s]
[0m18:01:32.512575 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:01:32.515584 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m18:01:32.515584 [info ] [Thread-2 (]: 8 of 8 START sql incremental model PUBLIC.go_predictive_model_features ......... [RUN]
[0m18:01:32.515584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_user_behavior_metrics, now model.my_fraud_detection_project.go_predictive_model_features)
[0m18:01:32.515584 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_predictive_model_features
[0m18:01:32.515584 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:32.515584 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_predictive_model_features
[0m18:01:32.526122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1E3A64A0>]}
[0m18:01:32.531726 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:32.533460 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model PUBLIC.go_real_time_fraud_detection .... [[32mSUCCESS 732[0m in 2.39s]
[0m18:01:32.534479 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
),
user_behavior_metrics AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
),
merchant_risk_assessment AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
)

SELECT
    tf.TransactionID,
    tf.TransactionAmount,
    tf.TransactionType,
    tf.AnomalyScore,
    ubm.total_transactions AS user_total_transactions,
    ubm.avg_transaction_amount AS user_avg_transaction_amount,
    ubm.total_fraud_transactions AS user_fraud_transactions,
    mra.total_fraud_transactions AS merchant_fraud_transactions,
    mra.avg_anomaly_score AS merchant_avg_anomaly_score,
    tf.IsFraud
FROM transactions_fact tf
JOIN user_behavior_metrics ubm ON tf.UserID = ubm.UserID
JOIN merchant_risk_assessment mra ON tf.MerchantID = mra.MerchantID

    WHERE tf.TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features)

  );
[0m18:01:32.535478 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:01:32.535478 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:33.563090 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.038 seconds
[0m18:01:33.563090 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:33.578845 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m18:01:33.662768 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.094 seconds
[0m18:01:33.677866 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:33.681950 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features
[0m18:01:33.743181 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.069 seconds
[0m18:01:33.758288 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:33.758288 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_PREDICTIVE_MODEL_FEATURES"
[0m18:01:33.824374 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.066 seconds
[0m18:01:33.829386 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:33.829386 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:33.829386 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
-- back compat for old kwarg name
  
  begin;
[0m18:01:33.935960 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m18:01:33.937956 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:33.939952 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","USER_TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_TOTAL_TRANSACTIONS","USER_AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."USER_AVG_TRANSACTION_AMOUNT","USER_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_FRAUD_TRANSACTIONS","MERCHANT_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."MERCHANT_FRAUD_TRANSACTIONS","MERCHANT_AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."MERCHANT_AVG_ANOMALY_SCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")
    values
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")

;
[0m18:01:34.688729 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.755 seconds
[0m18:01:34.688729 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:34.688729 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
COMMIT
[0m18:01:34.911141 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m18:01:34.911141 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m18:01:34.911141 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:01:34.911141 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp cascade
[0m18:01:35.031792 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m18:01:35.042169 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: Close
[0m18:01:35.153894 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac996e1b-94ff-4b87-ab32-b0b46cafcf7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1E1B79D0>]}
[0m18:01:35.153894 [info ] [Thread-2 (]: 8 of 8 OK created sql incremental model PUBLIC.go_predictive_model_features .... [[32mSUCCESS 0[0m in 2.64s]
[0m18:01:35.168403 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m18:01:35.169447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:35.169447 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m18:01:35.169447 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m18:01:35.169447 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_real_time_fraud_detection' was properly closed.
[0m18:01:35.169447 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_predictive_model_features' was properly closed.
[0m18:01:35.169447 [info ] [MainThread]: 
[0m18:01:35.169447 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 14.20 seconds (14.20s).
[0m18:01:35.176570 [debug] [MainThread]: Command end result
[0m18:01:35.209332 [info ] [MainThread]: 
[0m18:01:35.209332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:35.209332 [info ] [MainThread]: 
[0m18:01:35.209332 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:01:35.209332 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:35.209332 after 18.39 seconds
[0m18:01:35.209332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D195FC370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1B539960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1E3B3A90>]}
[0m18:01:35.209332 [debug] [MainThread]: Flushing usage events
[0m18:01:40.611426 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:02:13.016539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330C45C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330EE21C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330EE21E70>]}


============================== 18:02:13.029235 | b4420af1-9a11-4c59-bb49-27ffb3eee9ea ==============================
[0m18:02:13.029235 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:02:13.029235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:02:13.643894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330C6F5780>]}
[0m18:02:13.699477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330FAB71C0>]}
[0m18:02:13.699477 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:02:13.703986 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:02:13.831802 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:02:13.832816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330E3A5060>]}
[0m18:02:15.047763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330FAB5A80>]}
[0m18:02:15.149462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023310FBF940>]}
[0m18:02:15.149462 [info ] [MainThread]: Found 8 models, 1 source, 454 macros
[0m18:02:15.149462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023310FBFA60>]}
[0m18:02:15.149462 [info ] [MainThread]: 
[0m18:02:15.163001 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:02:15.169324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE'
[0m18:02:15.174546 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE"
[0m18:02:15.174546 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE"} */
show terse schemas in database EMEKA_FRAUD_DETECTION_DATABASE
    limit 10000
[0m18:02:15.174546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:16.026720 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.846 seconds
[0m18:02:16.029552 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE: Close
[0m18:02:16.170337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m18:02:16.230612 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m18:02:16.230612 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m18:02:16.230612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:17.072281 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.846 seconds
[0m18:02:17.072281 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m18:02:17.194966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002331106EE30>]}
[0m18:02:17.194966 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:02:17.211233 [info ] [MainThread]: 
[0m18:02:17.211233 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:02:17.211233 [info ] [Thread-1 (]: 1 of 8 START sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [RUN]
[0m18:02:17.211233 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m18:02:17.218991 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:02:17.229742 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:17.229742 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:02:17.273026 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:17.273026 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
  
   as (
    

WITH raw_data AS (
    SELECT
        TransactionID::string AS TransactionID,
        UserID::string AS UserID,
        TransactionDate::timestamp AS TransactionDate,
        TransactionAmount::float AS TransactionAmount,
        TransactionType::string AS TransactionType,
        MerchantID::string AS MerchantID,
        Currency::string AS Currency,
        TransactionStatus::string AS TransactionStatus,
        DeviceType::string AS DeviceType,
        IP_Address::string AS IP_Address,
        PaymentMethod::string AS PaymentMethod,
        LocationCoordinates::string AS LocationCoordinates,
        SuspiciousFlag::boolean AS SuspiciousFlag,
        IsFraud::boolean AS IsFraud,
        ReviewStatus::string AS ReviewStatus,
        AnomalyScore::float AS AnomalyScore,
        TransactionTime::string AS TransactionTime,
        Age::int AS Age,
        Gender::string AS Gender,
        AccountCreationDate::timestamp AS AccountCreationDate,
        Location::string AS Location,
        AccountStatus::string AS AccountStatus,
        DeviceID::string AS DeviceID,
        UserProfileCompleteness::float AS UserProfileCompleteness,
        PreviousFraudAttempts::int AS PreviousFraudAttempts
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.transactions_staging
    
        WHERE TransactionID::string > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical)
    
)

-- Deduplicate by TransactionID
SELECT DISTINCT * FROM raw_data
  );
[0m18:02:17.273026 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:02:18.136438 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.868 seconds
[0m18:02:18.155635 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:18.155635 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m18:02:18.256377 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.098 seconds
[0m18:02:18.256377 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:18.256377 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
[0m18:02:18.336920 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.077 seconds
[0m18:02:18.356334 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:18.356334 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."BR_FRAUD_DETECTION_RAW_DATA_HISTORICAL"
[0m18:02:18.435995 [debug] [Thread-1 (]: SQL status: SUCCESS 25 in 0.077 seconds
[0m18:02:18.456858 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:18.456858 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:18.456858 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
-- back compat for old kwarg name
  
  begin;
[0m18:02:18.577943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m18:02:18.580018 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:18.582019 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","REVIEWSTATUS" = DBT_INTERNAL_SOURCE."REVIEWSTATUS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","TRANSACTIONTIME" = DBT_INTERNAL_SOURCE."TRANSACTIONTIME","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "LOCATIONCOORDINATES", "SUSPICIOUSFLAG", "ISFRAUD", "REVIEWSTATUS", "ANOMALYSCORE", "TRANSACTIONTIME", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m18:02:19.560305 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.983 seconds
[0m18:02:19.560305 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:19.560305 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
COMMIT
[0m18:02:19.916717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m18:02:19.921002 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp
[0m18:02:19.930107 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:02:19.936114 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical__dbt_tmp cascade
[0m18:02:20.182450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m18:02:20.201755 [debug] [Thread-1 (]: On model.my_fraud_detection_project.br_fraud_detection_raw_data_historical: Close
[0m18:02:20.393185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330E399900>]}
[0m18:02:20.394185 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model PUBLIC.br_fraud_detection_raw_data_historical  [[32mSUCCESS 0[0m in 3.18s]
[0m18:02:20.395100 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:02:20.396171 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m18:02:20.397182 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m18:02:20.397182 [info ] [Thread-2 (]: 2 of 8 START sql incremental model PUBLIC.si_devices_dimension ................. [RUN]
[0m18:02:20.399272 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.si_devices_dimension'
[0m18:02:20.398180 [info ] [Thread-1 (]: 3 of 8 START sql incremental model PUBLIC.si_transactions_fact ................. [RUN]
[0m18:02:20.400183 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_devices_dimension
[0m18:02:20.401597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.br_fraud_detection_raw_data_historical, now model.my_fraud_detection_project.si_transactions_fact)
[0m18:02:20.405895 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:20.405895 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.si_transactions_fact
[0m18:02:20.405895 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:20.405895 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_devices_dimension
[0m18:02:20.405895 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.si_transactions_fact
[0m18:02:20.423325 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:20.428367 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:20.428530 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
  
   as (
    

WITH devices_dimension AS (
    SELECT
        DeviceID,
        FIRST_VALUE(DeviceType) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS DeviceType,
        FIRST_VALUE(IP_Address) OVER (PARTITION BY DeviceID ORDER BY TransactionDate) AS IP_Address
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE DeviceID > (SELECT MAX(DeviceID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension)
    
)

SELECT DISTINCT * FROM devices_dimension
  );
[0m18:02:20.428530 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT *
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact)
    
)

SELECT DISTINCT
    TransactionID,
    UserID,
    TransactionDate,
    TransactionAmount,
    TransactionType,
    MerchantID,
    Currency,
    TransactionStatus,
    DeviceType,
    IP_Address,
    PaymentMethod,
    SuspiciousFlag,
    IsFraud,
    AnomalyScore,
    Age,
    Gender,
    AccountCreationDate,
    Location,
    LocationCoordinates,
    AccountStatus,
    DeviceID,
    UserProfileCompleteness,
    PreviousFraudAttempts
FROM transactions_fact
  );
[0m18:02:20.428530 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:02:20.431592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:21.501543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.070 seconds
[0m18:02:21.505242 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:21.506245 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m18:02:21.580380 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.150 seconds
[0m18:02:21.585802 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:21.586875 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m18:02:21.597508 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.091 seconds
[0m18:02:21.602492 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:21.603401 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
[0m18:02:21.722153 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.119 seconds
[0m18:02:21.728890 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:21.729893 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_TRANSACTIONS_FACT"
[0m18:02:21.766979 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.179 seconds
[0m18:02:21.770983 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:21.772065 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension
[0m18:02:21.818818 [debug] [Thread-1 (]: SQL status: SUCCESS 23 in 0.088 seconds
[0m18:02:21.823845 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:21.828178 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:21.829166 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
-- back compat for old kwarg name
  
  begin;
[0m18:02:21.852063 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.079 seconds
[0m18:02:21.856061 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:21.857061 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_DEVICES_DIMENSION"
[0m18:02:21.930720 [debug] [Thread-2 (]: SQL status: SUCCESS 3 in 0.073 seconds
[0m18:02:21.933807 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:21.936337 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:21.936643 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
-- back compat for old kwarg name
  
  begin;
[0m18:02:21.982470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m18:02:21.983688 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:21.984746 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","USERID" = DBT_INTERNAL_SOURCE."USERID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","TRANSACTIONSTATUS" = DBT_INTERNAL_SOURCE."TRANSACTIONSTATUS","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","PAYMENTMETHOD" = DBT_INTERNAL_SOURCE."PAYMENTMETHOD","SUSPICIOUSFLAG" = DBT_INTERNAL_SOURCE."SUSPICIOUSFLAG","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","LOCATION" = DBT_INTERNAL_SOURCE."LOCATION","LOCATIONCOORDINATES" = DBT_INTERNAL_SOURCE."LOCATIONCOORDINATES","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS"
    

    when not matched then insert
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")
    values
        ("TRANSACTIONID", "USERID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "MERCHANTID", "CURRENCY", "TRANSACTIONSTATUS", "DEVICETYPE", "IP_ADDRESS", "PAYMENTMETHOD", "SUSPICIOUSFLAG", "ISFRAUD", "ANOMALYSCORE", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "LOCATION", "LOCATIONCOORDINATES", "ACCOUNTSTATUS", "DEVICEID", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS")

;
[0m18:02:22.053000 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m18:02:22.054003 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:22.055142 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.DeviceID = DBT_INTERNAL_DEST.DeviceID
            )

    
    when matched then update set
        "DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","DEVICETYPE" = DBT_INTERNAL_SOURCE."DEVICETYPE","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS"
    

    when not matched then insert
        ("DEVICEID", "DEVICETYPE", "IP_ADDRESS")
    values
        ("DEVICEID", "DEVICETYPE", "IP_ADDRESS")

;
[0m18:02:22.829251 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.773 seconds
[0m18:02:22.830250 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:22.830250 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
COMMIT
[0m18:02:22.987649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.014 seconds
[0m18:02:22.987649 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:22.987649 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
COMMIT
[0m18:02:23.067184 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.249 seconds
[0m18:02:23.082919 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp
[0m18:02:23.082919 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_devices_dimension"
[0m18:02:23.082919 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_devices_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_devices_dimension__dbt_tmp cascade
[0m18:02:23.209094 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m18:02:23.225582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m18:02:23.225582 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_devices_dimension: Close
[0m18:02:23.225582 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp
[0m18:02:23.225582 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.si_transactions_fact"
[0m18:02:23.225582 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_transactions_fact"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact__dbt_tmp cascade
[0m18:02:23.349410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m18:02:23.349410 [debug] [Thread-1 (]: On model.my_fraud_detection_project.si_transactions_fact: Close
[0m18:02:23.365924 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023310F254B0>]}
[0m18:02:23.366918 [info ] [Thread-2 (]: 2 of 8 OK created sql incremental model PUBLIC.si_devices_dimension ............ [[32mSUCCESS 0[0m in 2.97s]
[0m18:02:23.369516 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m18:02:23.369516 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m18:02:23.370562 [info ] [Thread-2 (]: 4 of 8 START sql incremental model PUBLIC.si_users_dimension ................... [RUN]
[0m18:02:23.371581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_devices_dimension, now model.my_fraud_detection_project.si_users_dimension)
[0m18:02:23.372516 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_users_dimension
[0m18:02:23.376517 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:23.377522 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_users_dimension
[0m18:02:23.383678 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:23.385089 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
  
   as (
    

WITH users_dimension AS (
    SELECT
        UserID,
        FIRST_VALUE(Age) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Age,
        FIRST_VALUE(Gender) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS Gender,
        FIRST_VALUE(AccountCreationDate) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountCreationDate,
        FIRST_VALUE(AccountStatus) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS AccountStatus,
        FIRST_VALUE(UserProfileCompleteness) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserProfileCompleteness,
        FIRST_VALUE(PreviousFraudAttempts) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS PreviousFraudAttempts,
        FIRST_VALUE(Location) OVER (PARTITION BY UserID ORDER BY TransactionDate) AS UserLocation
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.br_fraud_detection_raw_data_historical
    
        WHERE UserID > (SELECT MAX(UserID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension)
    
)

SELECT DISTINCT * FROM users_dimension
  );
[0m18:02:23.385089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:23.490203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023310F25FF0>]}
[0m18:02:23.490203 [info ] [Thread-1 (]: 3 of 8 OK created sql incremental model PUBLIC.si_transactions_fact ............ [[32mSUCCESS 0[0m in 3.09s]
[0m18:02:23.490203 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m18:02:23.490203 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:02:23.490203 [info ] [Thread-1 (]: 5 of 8 START sql incremental model PUBLIC.go_merchant_risk_assessment .......... [RUN]
[0m18:02:23.490203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_transactions_fact, now model.my_fraud_detection_project.go_merchant_risk_assessment)
[0m18:02:23.490203 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:02:23.505832 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:23.506901 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:02:23.512660 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:23.513037 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
  
   as (
    

WITH merchant_risk_assessment AS (
    SELECT
        MerchantID,
        COUNT(TransactionID) AS total_transactions,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        SUM(CASE WHEN IsFraud = 1 THEN TransactionAmount ELSE 0 END) AS total_fraudulent_amount,
        AVG(AnomalyScore) AS avg_anomaly_score,
        COUNT(DISTINCT UserID) AS unique_users
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY MerchantID
)

SELECT DISTINCT * FROM merchant_risk_assessment
  );
[0m18:02:23.513037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:24.246531 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.865 seconds
[0m18:02:24.246531 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:24.246531 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m18:02:24.280741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m18:02:24.280741 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:24.280741 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m18:02:24.348040 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.097 seconds
[0m18:02:24.348040 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:24.348040 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension
[0m18:02:24.379546 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.098 seconds
[0m18:02:24.389901 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:24.390594 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
[0m18:02:24.438403 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.079 seconds
[0m18:02:24.443221 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:24.443221 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."SI_USERS_DIMENSION"
[0m18:02:24.459104 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.073 seconds
[0m18:02:24.459104 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:24.459104 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_MERCHANT_RISK_ASSESSMENT"
[0m18:02:24.524882 [debug] [Thread-2 (]: SQL status: SUCCESS 8 in 0.082 seconds
[0m18:02:24.538454 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:24.541469 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:24.541469 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
-- back compat for old kwarg name
  
  begin;
[0m18:02:24.544460 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.077 seconds
[0m18:02:24.548559 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:24.550474 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:24.551348 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
-- back compat for old kwarg name
  
  begin;
[0m18:02:24.644025 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m18:02:24.644025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m18:02:24.658561 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:24.658561 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:24.658561 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","AGE" = DBT_INTERNAL_SOURCE."AGE","GENDER" = DBT_INTERNAL_SOURCE."GENDER","ACCOUNTCREATIONDATE" = DBT_INTERNAL_SOURCE."ACCOUNTCREATIONDATE","ACCOUNTSTATUS" = DBT_INTERNAL_SOURCE."ACCOUNTSTATUS","USERPROFILECOMPLETENESS" = DBT_INTERNAL_SOURCE."USERPROFILECOMPLETENESS","PREVIOUSFRAUDATTEMPTS" = DBT_INTERNAL_SOURCE."PREVIOUSFRAUDATTEMPTS","USERLOCATION" = DBT_INTERNAL_SOURCE."USERLOCATION"
    

    when not matched then insert
        ("USERID", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "ACCOUNTSTATUS", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS", "USERLOCATION")
    values
        ("USERID", "AGE", "GENDER", "ACCOUNTCREATIONDATE", "ACCOUNTSTATUS", "USERPROFILECOMPLETENESS", "PREVIOUSFRAUDATTEMPTS", "USERLOCATION")

;
[0m18:02:24.658561 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.MerchantID = DBT_INTERNAL_DEST.MerchantID
            )

    
    when matched then update set
        "MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","TOTAL_FRAUDULENT_AMOUNT" = DBT_INTERNAL_SOURCE."TOTAL_FRAUDULENT_AMOUNT","AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."AVG_ANOMALY_SCORE","UNIQUE_USERS" = DBT_INTERNAL_SOURCE."UNIQUE_USERS"
    

    when not matched then insert
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")
    values
        ("MERCHANTID", "TOTAL_TRANSACTIONS", "TOTAL_FRAUD_TRANSACTIONS", "TOTAL_FRAUDULENT_AMOUNT", "AVG_ANOMALY_SCORE", "UNIQUE_USERS")

;
[0m18:02:25.350972 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.683 seconds
[0m18:02:25.351976 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:25.353618 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
COMMIT
[0m18:02:25.445418 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.780 seconds
[0m18:02:25.445418 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:25.445418 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
COMMIT
[0m18:02:25.581028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m18:02:25.584128 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp
[0m18:02:25.585131 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:02:25.586136 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_merchant_risk_assessment"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment__dbt_tmp cascade
[0m18:02:25.675287 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m18:02:25.680062 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp
[0m18:02:25.681066 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.si_users_dimension"
[0m18:02:25.682163 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.si_users_dimension"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_users_dimension__dbt_tmp cascade
[0m18:02:25.698614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m18:02:25.700615 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_merchant_risk_assessment: Close
[0m18:02:25.804107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m18:02:25.808108 [debug] [Thread-2 (]: On model.my_fraud_detection_project.si_users_dimension: Close
[0m18:02:25.832354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330FCA5F00>]}
[0m18:02:25.834339 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model PUBLIC.go_merchant_risk_assessment ..... [[32mSUCCESS 5[0m in 2.34s]
[0m18:02:25.835591 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:02:25.836597 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:02:25.837593 [info ] [Thread-1 (]: 6 of 8 START sql incremental model PUBLIC.go_real_time_fraud_detection ......... [RUN]
[0m18:02:25.838058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_merchant_risk_assessment, now model.my_fraud_detection_project.go_real_time_fraud_detection)
[0m18:02:25.839155 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:02:25.843512 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:25.846519 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:02:25.848276 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:25.848276 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
  
   as (
    

WITH real_time_fraud_detection AS (
    SELECT
        TransactionID,
        TransactionDate,
        TransactionAmount,
        TransactionType,
        UserID,
        MerchantID,
        DeviceID,
        IP_Address,
        AnomalyScore,
        IsFraud,
        CASE
            WHEN AnomalyScore > 0.8 THEN 'High Risk'
            WHEN AnomalyScore > 0.5 THEN 'Moderate Risk'
            ELSE 'Low Risk'
        END AS fraud_risk_level
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    WHERE AnomalyScore > 0.5 OR IsFraud = 1
)

SELECT DISTINCT * FROM real_time_fraud_detection
  );
[0m18:02:25.854491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:25.922725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330EDAFA30>]}
[0m18:02:25.923742 [info ] [Thread-2 (]: 4 of 8 OK created sql incremental model PUBLIC.si_users_dimension .............. [[32mSUCCESS 0[0m in 2.55s]
[0m18:02:25.925631 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m18:02:25.926646 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:02:25.927652 [info ] [Thread-2 (]: 7 of 8 START sql incremental model PUBLIC.go_user_behavior_metrics ............. [RUN]
[0m18:02:25.928652 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_users_dimension, now model.my_fraud_detection_project.go_user_behavior_metrics)
[0m18:02:25.929722 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:02:25.933697 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:25.934706 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:02:25.940652 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:25.941652 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
  
   as (
    

WITH user_behavior_metrics AS (
    SELECT
        UserID,
        COUNT(TransactionID) AS total_transactions,
        AVG(TransactionAmount) AS avg_transaction_amount,
        COUNT(CASE WHEN IsFraud = 1 THEN 1 END) AS total_fraud_transactions,
        COUNT(DISTINCT DeviceID) AS unique_devices,
        MAX(TransactionDate) AS last_transaction_date,
        MIN(TransactionDate) AS first_transaction_date
    FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
    GROUP BY UserID
)

SELECT DISTINCT * FROM user_behavior_metrics
  );
[0m18:02:25.941652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:26.742718 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.807 seconds
[0m18:02:26.742718 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:26.742718 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m18:02:26.831465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.977 seconds
[0m18:02:26.836463 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:26.836463 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m18:02:26.851655 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.099 seconds
[0m18:02:26.855652 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:26.856655 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
[0m18:02:26.926818 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.096 seconds
[0m18:02:26.926818 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:26.926818 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection
[0m18:02:26.942917 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.087 seconds
[0m18:02:26.942917 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:26.942917 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_USER_BEHAVIOR_METRICS"
[0m18:02:27.006856 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.071 seconds
[0m18:02:27.006856 [debug] [Thread-2 (]: SQL status: SUCCESS 7 in 0.064 seconds
[0m18:02:27.006856 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:27.006856 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:27.021878 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_REAL_TIME_FRAUD_DETECTION"
[0m18:02:27.021878 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:27.021878 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
-- back compat for old kwarg name
  
  begin;
[0m18:02:27.100578 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.080 seconds
[0m18:02:27.100578 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:27.100578 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:27.100578 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
-- back compat for old kwarg name
  
  begin;
[0m18:02:27.116137 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m18:02:27.116137 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:27.131677 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.UserID = DBT_INTERNAL_DEST.UserID
            )

    
    when matched then update set
        "USERID" = DBT_INTERNAL_SOURCE."USERID","TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_TRANSACTIONS","AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."AVG_TRANSACTION_AMOUNT","TOTAL_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."TOTAL_FRAUD_TRANSACTIONS","UNIQUE_DEVICES" = DBT_INTERNAL_SOURCE."UNIQUE_DEVICES","LAST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."LAST_TRANSACTION_DATE","FIRST_TRANSACTION_DATE" = DBT_INTERNAL_SOURCE."FIRST_TRANSACTION_DATE"
    

    when not matched then insert
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")
    values
        ("USERID", "TOTAL_TRANSACTIONS", "AVG_TRANSACTION_AMOUNT", "TOTAL_FRAUD_TRANSACTIONS", "UNIQUE_DEVICES", "LAST_TRANSACTION_DATE", "FIRST_TRANSACTION_DATE")

;
[0m18:02:27.214951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m18:02:27.216951 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:27.218477 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONDATE" = DBT_INTERNAL_SOURCE."TRANSACTIONDATE","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","USERID" = DBT_INTERNAL_SOURCE."USERID","MERCHANTID" = DBT_INTERNAL_SOURCE."MERCHANTID","DEVICEID" = DBT_INTERNAL_SOURCE."DEVICEID","IP_ADDRESS" = DBT_INTERNAL_SOURCE."IP_ADDRESS","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD","FRAUD_RISK_LEVEL" = DBT_INTERNAL_SOURCE."FRAUD_RISK_LEVEL"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")
    values
        ("TRANSACTIONID", "TRANSACTIONDATE", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "USERID", "MERCHANTID", "DEVICEID", "IP_ADDRESS", "ANOMALYSCORE", "ISFRAUD", "FRAUD_RISK_LEVEL")

;
[0m18:02:27.766203 [debug] [Thread-2 (]: SQL status: SUCCESS 990 in 0.634 seconds
[0m18:02:27.767223 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:27.768224 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
COMMIT
[0m18:02:27.796955 [debug] [Thread-1 (]: SQL status: SUCCESS 732 in 0.577 seconds
[0m18:02:27.797964 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:27.798963 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
COMMIT
[0m18:02:27.988319 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m18:02:27.995312 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp
[0m18:02:27.996311 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:02:27.997311 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_user_behavior_metrics"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics__dbt_tmp cascade
[0m18:02:28.053362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m18:02:28.063686 [debug] [Thread-1 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp
[0m18:02:28.063686 [debug] [Thread-1 (]: Using snowflake connection "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:02:28.063686 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_real_time_fraud_detection"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_real_time_fraud_detection__dbt_tmp cascade
[0m18:02:28.126692 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m18:02:28.135059 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_user_behavior_metrics: Close
[0m18:02:28.213140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m18:02:28.217138 [debug] [Thread-1 (]: On model.my_fraud_detection_project.go_real_time_fraud_detection: Close
[0m18:02:28.260838 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330ECAB0D0>]}
[0m18:02:28.260838 [info ] [Thread-2 (]: 7 of 8 OK created sql incremental model PUBLIC.go_user_behavior_metrics ........ [[32mSUCCESS 990[0m in 2.33s]
[0m18:02:28.260838 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:02:28.260838 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m18:02:28.260838 [info ] [Thread-2 (]: 8 of 8 START sql incremental model PUBLIC.go_predictive_model_features ......... [RUN]
[0m18:02:28.260838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_user_behavior_metrics, now model.my_fraud_detection_project.go_predictive_model_features)
[0m18:02:28.269791 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_predictive_model_features
[0m18:02:28.274958 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:28.280803 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_predictive_model_features
[0m18:02:28.284234 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:28.284234 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
create or replace  temporary view EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
  
   as (
    

WITH transactions_fact AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.si_transactions_fact
),
user_behavior_metrics AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_user_behavior_metrics
),
merchant_risk_assessment AS (
    SELECT * FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_merchant_risk_assessment
)

SELECT
    tf.TransactionID,
    tf.TransactionAmount,
    tf.TransactionType,
    tf.AnomalyScore,
    ubm.total_transactions AS user_total_transactions,
    ubm.avg_transaction_amount AS user_avg_transaction_amount,
    ubm.total_fraud_transactions AS user_fraud_transactions,
    mra.total_fraud_transactions AS merchant_fraud_transactions,
    mra.avg_anomaly_score AS merchant_avg_anomaly_score,
    tf.IsFraud
FROM transactions_fact tf
JOIN user_behavior_metrics ubm ON tf.UserID = ubm.UserID
JOIN merchant_risk_assessment mra ON tf.MerchantID = mra.MerchantID

    WHERE tf.TransactionID > (SELECT MAX(TransactionID) FROM EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features)

  );
[0m18:02:28.284234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:02:28.346560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002331143FF10>]}
[0m18:02:28.347554 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model PUBLIC.go_real_time_fraud_detection .... [[32mSUCCESS 732[0m in 2.51s]
[0m18:02:28.348553 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:02:29.068900 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m18:02:29.073913 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:29.074896 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m18:02:29.178951 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.104 seconds
[0m18:02:29.183189 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:29.184281 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features
[0m18:02:29.259864 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.075 seconds
[0m18:02:29.263387 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:29.263387 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
describe table "EMEKA_FRAUD_DETECTION_DATABASE"."PUBLIC"."GO_PREDICTIVE_MODEL_FEATURES"
[0m18:02:29.333267 [debug] [Thread-2 (]: SQL status: SUCCESS 10 in 0.067 seconds
[0m18:02:29.338270 [debug] [Thread-2 (]: Writing runtime sql for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:29.340266 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:29.341266 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
-- back compat for old kwarg name
  
  begin;
[0m18:02:29.450987 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m18:02:29.452748 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:29.453876 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
merge into EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features as DBT_INTERNAL_DEST
        using EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TransactionID = DBT_INTERNAL_DEST.TransactionID
            )

    
    when matched then update set
        "TRANSACTIONID" = DBT_INTERNAL_SOURCE."TRANSACTIONID","TRANSACTIONAMOUNT" = DBT_INTERNAL_SOURCE."TRANSACTIONAMOUNT","TRANSACTIONTYPE" = DBT_INTERNAL_SOURCE."TRANSACTIONTYPE","ANOMALYSCORE" = DBT_INTERNAL_SOURCE."ANOMALYSCORE","USER_TOTAL_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_TOTAL_TRANSACTIONS","USER_AVG_TRANSACTION_AMOUNT" = DBT_INTERNAL_SOURCE."USER_AVG_TRANSACTION_AMOUNT","USER_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."USER_FRAUD_TRANSACTIONS","MERCHANT_FRAUD_TRANSACTIONS" = DBT_INTERNAL_SOURCE."MERCHANT_FRAUD_TRANSACTIONS","MERCHANT_AVG_ANOMALY_SCORE" = DBT_INTERNAL_SOURCE."MERCHANT_AVG_ANOMALY_SCORE","ISFRAUD" = DBT_INTERNAL_SOURCE."ISFRAUD"
    

    when not matched then insert
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")
    values
        ("TRANSACTIONID", "TRANSACTIONAMOUNT", "TRANSACTIONTYPE", "ANOMALYSCORE", "USER_TOTAL_TRANSACTIONS", "USER_AVG_TRANSACTION_AMOUNT", "USER_FRAUD_TRANSACTIONS", "MERCHANT_FRAUD_TRANSACTIONS", "MERCHANT_AVG_ANOMALY_SCORE", "ISFRAUD")

;
[0m18:02:30.386786 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.941 seconds
[0m18:02:30.386786 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:30.386786 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
COMMIT
[0m18:02:30.640064 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m18:02:30.640064 [debug] [Thread-2 (]: Applying DROP to: EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp
[0m18:02:30.640064 [debug] [Thread-2 (]: Using snowflake connection "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:02:30.650690 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "node_id": "model.my_fraud_detection_project.go_predictive_model_features"} */
drop view if exists EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC.go_predictive_model_features__dbt_tmp cascade
[0m18:02:30.774808 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m18:02:30.779802 [debug] [Thread-2 (]: On model.my_fraud_detection_project.go_predictive_model_features: Close
[0m18:02:30.920153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4420af1-9a11-4c59-bb49-27ffb3eee9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330FD60730>]}
[0m18:02:30.924149 [info ] [Thread-2 (]: 8 of 8 OK created sql incremental model PUBLIC.go_predictive_model_features .... [[32mSUCCESS 0[0m in 2.66s]
[0m18:02:30.927281 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m18:02:30.927978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:30.927978 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE' was properly closed.
[0m18:02:30.927978 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m18:02:30.927978 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_real_time_fraud_detection' was properly closed.
[0m18:02:30.927978 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_predictive_model_features' was properly closed.
[0m18:02:30.927978 [info ] [MainThread]: 
[0m18:02:30.927978 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 15.78 seconds (15.78s).
[0m18:02:30.935105 [debug] [MainThread]: Command end result
[0m18:02:30.955433 [info ] [MainThread]: 
[0m18:02:30.955433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:30.967429 [info ] [MainThread]: 
[0m18:02:30.968436 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:02:30.970439 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:30.970439 after 18.03 seconds
[0m18:02:30.970439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330C45C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330FCDBD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002330E3A5D80>]}
[0m18:02:30.971440 [debug] [MainThread]: Flushing usage events
[0m18:02:36.361541 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:08:36.982302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B046BAC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B049581F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B049582110>]}


============================== 18:08:36.991813 | 53e7f864-d7e7-43c0-8455-12dea05b99ed ==============================
[0m18:08:36.991813 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:08:36.991813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m18:08:37.468090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53e7f864-d7e7-43c0-8455-12dea05b99ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04938AF50>]}
[0m18:08:37.516424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53e7f864-d7e7-43c0-8455-12dea05b99ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B049538F70>]}
[0m18:08:37.516424 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:08:37.534542 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m18:08:37.693349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:37.693349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:37.720263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53e7f864-d7e7-43c0-8455-12dea05b99ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04B550130>]}
[0m18:08:37.750933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e7f864-d7e7-43c0-8455-12dea05b99ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04A51D060>]}
[0m18:08:37.750933 [info ] [MainThread]: Found 8 models, 1 source, 454 macros
[0m18:08:37.750933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e7f864-d7e7-43c0-8455-12dea05b99ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B049581B70>]}
[0m18:08:37.750933 [info ] [MainThread]: 
[0m18:08:37.750933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:08:37.772721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC'
[0m18:08:37.839288 [debug] [ThreadPool]: Using snowflake connection "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"
[0m18:08:37.840284 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC"} */
show objects in EMEKA_FRAUD_DETECTION_DATABASE.PUBLIC limit 10000
[0m18:08:37.841195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:38.731591 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.900 seconds
[0m18:08:38.731591 [debug] [ThreadPool]: On list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC: Close
[0m18:08:38.860866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e7f864-d7e7-43c0-8455-12dea05b99ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04A51FD00>]}
[0m18:08:38.860866 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:08:38.860866 [info ] [MainThread]: 
[0m18:08:38.877098 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:08:38.879276 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.br_fraud_detection_raw_data_historical'
[0m18:08:38.879276 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:08:38.887307 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.br_fraud_detection_raw_data_historical"
[0m18:08:38.895928 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:08:38.895928 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.br_fraud_detection_raw_data_historical
[0m18:08:38.895928 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_devices_dimension
[0m18:08:38.895928 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.si_transactions_fact
[0m18:08:38.895928 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.my_fraud_detection_project.si_devices_dimension'
[0m18:08:38.895928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.br_fraud_detection_raw_data_historical, now model.my_fraud_detection_project.si_transactions_fact)
[0m18:08:38.895928 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_devices_dimension
[0m18:08:38.903086 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.si_transactions_fact
[0m18:08:38.908548 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_devices_dimension"
[0m18:08:38.910269 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_transactions_fact"
[0m18:08:38.910269 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_devices_dimension
[0m18:08:38.910269 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_devices_dimension
[0m18:08:38.910269 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.si_transactions_fact
[0m18:08:38.910269 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.si_users_dimension
[0m18:08:38.910269 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.si_transactions_fact
[0m18:08:38.910269 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_devices_dimension, now model.my_fraud_detection_project.si_users_dimension)
[0m18:08:38.910269 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:08:38.923923 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.si_users_dimension
[0m18:08:38.925885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_transactions_fact, now model.my_fraud_detection_project.go_merchant_risk_assessment)
[0m18:08:38.925885 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.si_users_dimension"
[0m18:08:38.925885 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:08:38.925885 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_merchant_risk_assessment"
[0m18:08:38.925885 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.si_users_dimension
[0m18:08:38.925885 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.si_users_dimension
[0m18:08:38.925885 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:08:38.925885 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:08:38.940929 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_merchant_risk_assessment
[0m18:08:38.940929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.si_users_dimension, now model.my_fraud_detection_project.go_real_time_fraud_detection)
[0m18:08:38.940929 [debug] [Thread-1 (]: Began running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:08:38.944970 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:08:38.944970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_merchant_risk_assessment, now model.my_fraud_detection_project.go_user_behavior_metrics)
[0m18:08:38.948961 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_real_time_fraud_detection"
[0m18:08:38.950012 [debug] [Thread-1 (]: Began compiling node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:08:38.953979 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_user_behavior_metrics"
[0m18:08:38.954965 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:08:38.957079 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_real_time_fraud_detection
[0m18:08:38.957964 [debug] [Thread-1 (]: Began executing node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:08:38.958970 [debug] [Thread-1 (]: Finished running node model.my_fraud_detection_project.go_user_behavior_metrics
[0m18:08:38.959978 [debug] [Thread-2 (]: Began running node model.my_fraud_detection_project.go_predictive_model_features
[0m18:08:38.960978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.my_fraud_detection_project.go_real_time_fraud_detection, now model.my_fraud_detection_project.go_predictive_model_features)
[0m18:08:38.961975 [debug] [Thread-2 (]: Began compiling node model.my_fraud_detection_project.go_predictive_model_features
[0m18:08:38.966525 [debug] [Thread-2 (]: Writing injected SQL for node "model.my_fraud_detection_project.go_predictive_model_features"
[0m18:08:38.968410 [debug] [Thread-2 (]: Began executing node model.my_fraud_detection_project.go_predictive_model_features
[0m18:08:38.969407 [debug] [Thread-2 (]: Finished running node model.my_fraud_detection_project.go_predictive_model_features
[0m18:08:38.971411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:38.971411 [debug] [MainThread]: Connection 'list_EMEKA_FRAUD_DETECTION_DATABASE_PUBLIC' was properly closed.
[0m18:08:38.972408 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_user_behavior_metrics' was properly closed.
[0m18:08:38.972408 [debug] [MainThread]: Connection 'model.my_fraud_detection_project.go_predictive_model_features' was properly closed.
[0m18:08:38.975693 [debug] [MainThread]: Command end result
[0m18:08:39.497146 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m18:08:39.497146 [info ] [MainThread]: Building catalog
[0m18:08:39.504983 [debug] [ThreadPool]: Acquiring new snowflake connection 'EMEKA_FRAUD_DETECTION_DATABASE.information_schema'
[0m18:08:39.527229 [debug] [ThreadPool]: Using snowflake connection "EMEKA_FRAUD_DETECTION_DATABASE.information_schema"
[0m18:08:39.527229 [debug] [ThreadPool]: On EMEKA_FRAUD_DETECTION_DATABASE.information_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "my_fraud_detection_project", "target_name": "dev", "connection_name": "EMEKA_FRAUD_DETECTION_DATABASE.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from EMEKA_FRAUD_DETECTION_DATABASE.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'si_users_dimension' and upper("table_name") = upper('si_users_dimension')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'br_fraud_detection_raw_data_historical' and upper("table_name") = upper('br_fraud_detection_raw_data_historical')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'go_user_behavior_metrics' and upper("table_name") = upper('go_user_behavior_metrics')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'si_transactions_fact' and upper("table_name") = upper('si_transactions_fact')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'go_real_time_fraud_detection' and upper("table_name") = upper('go_real_time_fraud_detection')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'transactions_staging' and upper("table_name") = upper('transactions_staging')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'si_devices_dimension' and upper("table_name") = upper('si_devices_dimension')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'go_predictive_model_features' and upper("table_name") = upper('go_predictive_model_features')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'go_merchant_risk_assessment' and upper("table_name") = upper('go_merchant_risk_assessment')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from EMEKA_FRAUD_DETECTION_DATABASE.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'si_users_dimension' and upper("table_name") = upper('si_users_dimension')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'br_fraud_detection_raw_data_historical' and upper("table_name") = upper('br_fraud_detection_raw_data_historical')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'go_user_behavior_metrics' and upper("table_name") = upper('go_user_behavior_metrics')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'si_transactions_fact' and upper("table_name") = upper('si_transactions_fact')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'go_real_time_fraud_detection' and upper("table_name") = upper('go_real_time_fraud_detection')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'transactions_staging' and upper("table_name") = upper('transactions_staging')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'si_devices_dimension' and upper("table_name") = upper('si_devices_dimension')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'go_predictive_model_features' and upper("table_name") = upper('go_predictive_model_features')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'go_merchant_risk_assessment' and upper("table_name") = upper('go_merchant_risk_assessment')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m18:08:39.527229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:44.565351 [debug] [ThreadPool]: SQL status: SUCCESS 118 in 5.044 seconds
[0m18:08:44.596457 [debug] [ThreadPool]: On EMEKA_FRAUD_DETECTION_DATABASE.information_schema: Close
[0m18:08:44.813563 [info ] [MainThread]: Catalog written to C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\target\catalog.json
[0m18:08:44.815888 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:08:44.815888 after 7.90 seconds
[0m18:08:44.815888 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:08:44.816823 [debug] [MainThread]: Connection 'EMEKA_FRAUD_DETECTION_DATABASE.information_schema' was properly closed.
[0m18:08:44.816823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B046BAC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04B754370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04A4FE020>]}
[0m18:08:44.817822 [debug] [MainThread]: Flushing usage events
[0m18:09:10.392816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B33BDC3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B365A9BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B365A9DB0>]}


============================== 18:09:10.392816 | 621b2215-694f-459c-be23-c388906bea03 ==============================
[0m18:09:10.392816 [info ] [MainThread]: Running with dbt=1.8.8
[0m18:09:10.392816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\User\\Desktop\\Projects\\DBT-Fraud-Detection-Data-Pipeline\\logs', 'profiles_dir': 'C:\\Users\\User\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:09:10.893251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '621b2215-694f-459c-be23-c388906bea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B37212D40>]}
[0m18:09:10.940732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '621b2215-694f-459c-be23-c388906bea03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B36559120>]}
[0m18:14:04.461153 [error] [MainThread]: Encountered an error:

[0m18:14:04.541899 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
  File "C:\Users\User\Desktop\Projects\DBT-Fraud-Detection-Data-Pipeline\dbt-env\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\User\AppData\Local\Programs\Python\Python310\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\User\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\User\AppData\Local\Programs\Python\Python310\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m18:14:04.547050 [debug] [MainThread]: Command `dbt docs serve` failed at 18:14:04.547050 after 294.21 seconds
[0m18:14:04.548057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B33BDC3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B37408640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B37408910>]}
[0m18:14:04.548057 [debug] [MainThread]: Flushing usage events
